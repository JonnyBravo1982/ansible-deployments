<span class="co1">#Requires -Version 3.0</span>
<span class="co1">#This File is in Unicode format.  Do not edit in an ASCII editor.</span>
&nbsp;
<span class="co1">#region help text</span>
&nbsp;
<span class="coMULTI">&lt;#
.SYNOPSIS
	Demonstrates script functionality using Microsoft Word, PDF, formatted text or HTML.
.DESCRIPTION
	Creates a sample report of various Word functionality using Microsoft Word, PDF, formatted text, HTML and PowerShell.
	Creates a document named Script_Template.docx (or .PDF or .TXT or .HTML).
	Word and PDF documents include a Cover Page, Table of Contents and Footer.
	Includes support for the following language versions of Microsoft Word:
		Catalan
		Danish
		Dutch
		English
		Finnish
		French
		German
		Norwegian
		Portuguese
		Spanish
		Swedish
&nbsp;
	Look for the sections starting with ### to find the lines to either be replaced with your 
	script code or that need changing for your script needs
.PARAMETER CompanyName
	Company Name to use for the Cover Page.  
	Default value is contained in HKCU:\Software\Microsoft\Office\Common\UserInfo\CompanyName or
	HKCU:\Software\Microsoft\Office\Common\UserInfo\Company, whichever is populated on the 
	computer running the script.
	This parameter has an alias of CN.
	If either registry key does not exist and this parameter is not specified, the report will
	not contain a Company Name on the cover page.
.PARAMETER CoverPage
	What Microsoft Word Cover Page to use.
	Only Word 2010 and 2013 are supported.
	(default cover pages in Word en-US)
	Valid input is:
		Alphabet (Word 2010. Works)
		Annual (Word 2010. Doesn't work well for this report)
		Austere (Word 2010. Works)
		Austin (Word 2010/2013. Doesn't work in 2013, mostly works in 2010 but Subtitle/Subject &amp; Author fields need to be moved after title box is moved up)
		Banded (Word 2013. Works)
		Conservative (Word 2010. Works)
		Contrast (Word 2010. Works)
		Cubicles (Word 2010. Works)
		Exposure (Word 2010. Works if you like looking sideways)
		Facet (Word 2013. Works)
		Filigree (Word 2013. Works)
		Grid (Word 2010/2013.Works in 2010)
		Integral (Word 2013. Works)
		Ion (Dark) (Word 2013. Top date doesn't fit, box needs to be manually resized or font changed to 8 point)
		Ion (Light) (Word 2013. Top date doesn't fit, box needs to be manually resized or font changed to 8 point)
		Mod (Word 2010. Works)
		Motion (Word 2010/2013. Works if top date is manually changed to 36 point)
		Newsprint (Word 2010. Works but date is not populated)
		Perspective (Word 2010. Works)
		Pinstripes (Word 2010. Works)
		Puzzle (Word 2010. Top date doesn't fit, box needs to be manually resized or font changed to 14 point)
		Retrospect (Word 2013. Works)
		Semaphore (Word 2013. Works)
		Sideline (Word 2010/2013. Doesn't work in 2013, works in 2010)
		Slice (Dark) (Word 2013. Doesn't work)
		Slice (Light) (Word 2013. Doesn't work)
		Stacks (Word 2010. Works)
		Tiles (Word 2010. Date doesn't fit unless changed to 26 point)
		Transcend (Word 2010. Works)
		ViewMaster (Word 2013. Works)
		Whisp (Word 2013. Works)
	Default value is Sideline.
	This parameter has an alias of CP.
.PARAMETER UserName
	User name to use for the Cover Page and Footer.
	Default value is contained in $env:username
	This parameter has an alias of UN.
.PARAMETER PDF
	SaveAs PDF file instead of DOCX file.
	This parameter is disabled by default.
	The PDF file is roughly 5X to 10X larger than the DOCX file.
.PARAMETER MSWord
	SaveAs DOCX file
	This parameter is set True if no other output format is selected.
.PARAMETER AddDateTime
	Adds a date time stamp to the end of the file name.
	Time stamp is in the format of yyyy-MM-dd_HHmm.
	June 1, 2014 at 6PM is 2014-06-01_1800.
	Output filename will be ReportName_2014-06-01_1800.docx (or .pdf).
	This parameter is disabled by default.
.PARAMETER Hardware
	Use WMI to gather hardware information on: Computer System, Disks, Processor and Network Interface Cards
	This parameter may require the script be run from an elevated PowerShell session 
	using an account with permission to retrieve hardware information (i.e. Domain Admin or Local Administrator).
	Selecting this parameter will add to both the time it takes to run the script and size of the report.
	This parameter is disabled by default.
.PARAMETER ComputerName
	Specifies a computer to use to run the script against.
	ComputerName can be entered as the NetBIOS name, FQDN, localhost or IP Address.
	If entered as localhost, the actual computer name is determined and used.
	If entered as an IP address, an attempt is made to determine and use the actual computer name.
	Default is localhost.
.PARAMETER Software
    Specifies whether the script should run an inventory of Applications, Packages and OSD related objects.
.PARAMETER ListAllInformation
    Specifies whether the script should only output an overview of what is configured (like count of collections) or 
    a full output with verbose information.
.PARAMETER SMSProvider
    Some information rely on WMI queries that need to be executed against the SMS Provider directly. 
    Please specify as FQDN.
    If not specified, it assumes localhost.
.EXAMPLE
	PS C:\PSScript &gt; .\ScriptTemplate.ps1 -PDF
&nbsp;
	Will use all default values and save the document as a PDF file.
	HKEY_CURRENT_USER\Software\Microsoft\Office\Common\UserInfo\CompanyName=&quot;Carl Webster&quot; or
	HKEY_CURRENT_USER\Software\Microsoft\Office\Common\UserInfo\Company=&quot;Carl Webster&quot;
	$env:username = Administrator
&nbsp;
	Carl Webster for the Company Name.
	Sideline for the Cover Page format.
	Administrator for the User Name.
&nbsp;
.EXAMPLE
	PS C:\PSScript .\ScriptTemplate.ps1 -CompanyName &quot;Carl Webster Consulting&quot; -CoverPage &quot;Mod&quot; -UserName &quot;Carl Webster&quot;
&nbsp;
	Will use:
		Carl Webster Consulting for the Company Name.
		Mod for the Cover Page format.
		Carl Webster for the User Name.
.EXAMPLE
	PS C:\PSScript .\ScriptTemplate.ps1 -CN &quot;Carl Webster Consulting&quot; -CP &quot;Mod&quot; -UN &quot;Carl Webster&quot;
&nbsp;
	Will use:
		Carl Webster Consulting for the Company Name (alias CN).
		Mod for the Cover Page format (alias CP).
		Carl Webster for the User Name (alias UN).
.EXAMPLE
	PS C:\PSScript &gt; .\ScriptTemplate.ps1 -AddDateTime
&nbsp;
	Will use all default values.
	HKEY_CURRENT_USER\Software\Microsoft\Office\Common\UserInfo\CompanyName=&quot;Carl Webster&quot; or
	HKEY_CURRENT_USER\Software\Microsoft\Office\Common\UserInfo\Company=&quot;Carl Webster&quot;
	$env:username = Administrator
&nbsp;
	Carl Webster for the Company Name.
	Sideline for the Cover Page format.
	Administrator for the User Name.
&nbsp;
	Adds a date time stamp to the end of the file name.
	Time stamp is in the format of yyyy-MM-dd_HHmm.
	June 1, 2014 at 6PM is 2014-06-01_1800.
	Output filename will be Script_Template_2014-06-01_1800.docx
.EXAMPLE
	PS C:\PSScript &gt; .\ScriptTemplate.ps1 -PDF -AddDateTime
&nbsp;
	Will use all default values and save the document as a PDF file.
	HKEY_CURRENT_USER\Software\Microsoft\Office\Common\UserInfo\CompanyName=&quot;Carl Webster&quot; or
	HKEY_CURRENT_USER\Software\Microsoft\Office\Common\UserInfo\Company=&quot;Carl Webster&quot;
	$env:username = Administrator
&nbsp;
	Carl Webster for the Company Name.
	Sideline for the Cover Page format.
	Administrator for the User Name.
&nbsp;
	Adds a date time stamp to the end of the file name.
	Time stamp is in the format of yyyy-MM-dd_HHmm.
	June 1, 2014 at 6PM is 2014-06-01_1800.
	Output filename will be Script_Template_2014-06-01_1800.PDF
.EXAMPLE
	PS C:\PSScript &gt; .\ScriptTemplate.ps1 -Hardware
&nbsp;
	Will use all default values.
	HKEY_CURRENT_USER\Software\Microsoft\Office\Common\UserInfo\CompanyName=&quot;Carl Webster&quot; or
	HKEY_CURRENT_USER\Software\Microsoft\Office\Common\UserInfo\Company=&quot;Carl Webster&quot;
	$env:username = Administrator
&nbsp;
	Carl Webster for the Company Name.
	Sideline for the Cover Page format.
	Administrator for the User Name.
	localhost for running hardware inventory.
	localhost will be replaced by the actual computer name.
.EXAMPLE
	PS C:\PSScript &gt; .\ScriptTemplate.ps1 -Hardware -ComputerName 192.168.1.51
&nbsp;
	Will use all default values.
	HKEY_CURRENT_USER\Software\Microsoft\Office\Common\UserInfo\CompanyName=&quot;Carl Webster&quot; or
	HKEY_CURRENT_USER\Software\Microsoft\Office\Common\UserInfo\Company=&quot;Carl Webster&quot;
	$env:username = Administrator
&nbsp;
	Carl Webster for the Company Name.
	Sideline for the Cover Page format.
	Administrator for the User Name.
	192.168.1.51 for running hardware inventory.
	192.168.1.51 will be replaced by the actual computer name, if possible.
.INPUTS
	None.  You cannot pipe objects to this script.
.OUTPUTS
	No objects are output from this script.  
	This script creates a Word, PDF, Formatted Text or HTML document.
.NOTES
	NAME: DocumentCM12R2v2.ps1
	VERSION: 1.00
	AUTHOR: Carl Webster, Michael B. Smith, Iain Brighton, Jeff Wouters, Barry Schiffer, David O'Brien
	LASTEDIT: April 06, 2015
#&gt;</span>
&nbsp;
<span class="co1">#endregion</span>
&nbsp;
<span class="co1">#region script parameters</span>
<span class="co1">#thanks to @jeffwouters and Michael B. Smith for helping me with these parameters</span>
<span class="br0">&#91;</span>CmdletBinding<span class="br0">&#40;</span>SupportsShouldProcess <span class="sy0">=</span> <span class="re0">$False</span><span class="sy0">,</span> ConfirmImpact <span class="sy0">=</span> <span class="st0">&quot;None&quot;</span><span class="sy0">,</span> DefaultParameterSetName <span class="sy0">=</span> <span class="st0">&quot;Word&quot;</span><span class="br0">&#41;</span> <span class="br0">&#93;</span>
&nbsp;
<span class="kw3">Param</span><span class="br0">&#40;</span>
	<span class="br0">&#91;</span>parameter<span class="br0">&#40;</span>ParameterSetName<span class="sy0">=</span><span class="st0">&quot;Word&quot;</span><span class="sy0">,</span>Mandatory<span class="sy0">=</span><span class="re0">$False</span><span class="br0">&#41;</span><span class="br0">&#93;</span> 
	<span class="br0">&#91;</span><span class="kw3">Switch</span><span class="br0">&#93;</span><span class="re0">$MSWord</span><span class="sy0">=</span><span class="re0">$False</span><span class="sy0">,</span>
&nbsp;
	<span class="br0">&#91;</span>parameter<span class="br0">&#40;</span>ParameterSetName<span class="sy0">=</span><span class="st0">&quot;PDF&quot;</span><span class="sy0">,</span>Mandatory<span class="sy0">=</span><span class="re0">$False</span><span class="br0">&#41;</span><span class="br0">&#93;</span> 
	<span class="br0">&#91;</span><span class="kw3">Switch</span><span class="br0">&#93;</span><span class="re0">$PDF</span><span class="sy0">=</span><span class="re0">$False</span><span class="sy0">,</span>
&nbsp;
	<span class="br0">&#91;</span>parameter<span class="br0">&#40;</span>Mandatory<span class="sy0">=</span><span class="re0">$False</span><span class="br0">&#41;</span><span class="br0">&#93;</span> 
	<span class="br0">&#91;</span><span class="kw3">Switch</span><span class="br0">&#93;</span><span class="re0">$AddDateTime</span><span class="sy0">=</span><span class="re0">$False</span><span class="sy0">,</span>
&nbsp;
	<span class="br0">&#91;</span>parameter<span class="br0">&#40;</span>ParameterSetName<span class="sy0">=</span><span class="st0">&quot;Word&quot;</span><span class="sy0">,</span>Mandatory<span class="sy0">=</span><span class="re0">$False</span><span class="br0">&#41;</span><span class="br0">&#93;</span> 
	<span class="br0">&#91;</span>parameter<span class="br0">&#40;</span>ParameterSetName<span class="sy0">=</span><span class="st0">&quot;PDF&quot;</span><span class="sy0">,</span>Mandatory<span class="sy0">=</span><span class="re0">$False</span><span class="br0">&#41;</span><span class="br0">&#93;</span> 
	<span class="br0">&#91;</span>Alias<span class="br0">&#40;</span><span class="st0">&quot;CN&quot;</span><span class="br0">&#41;</span><span class="br0">&#93;</span>
	<span class="br0">&#91;</span>ValidateNotNullOrEmpty<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#93;</span>
	<span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span><span class="re0">$CompanyName</span><span class="sy0">=</span><span class="st0">&quot;&quot;</span><span class="sy0">,</span>
&nbsp;
	<span class="br0">&#91;</span>parameter<span class="br0">&#40;</span>ParameterSetName<span class="sy0">=</span><span class="st0">&quot;Word&quot;</span><span class="sy0">,</span>Mandatory<span class="sy0">=</span><span class="re0">$False</span><span class="br0">&#41;</span><span class="br0">&#93;</span> 
	<span class="br0">&#91;</span>parameter<span class="br0">&#40;</span>ParameterSetName<span class="sy0">=</span><span class="st0">&quot;PDF&quot;</span><span class="sy0">,</span>Mandatory<span class="sy0">=</span><span class="re0">$False</span><span class="br0">&#41;</span><span class="br0">&#93;</span> 
	<span class="br0">&#91;</span>Alias<span class="br0">&#40;</span><span class="st0">&quot;CP&quot;</span><span class="br0">&#41;</span><span class="br0">&#93;</span>
	<span class="br0">&#91;</span>ValidateNotNullOrEmpty<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#93;</span>
	<span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span><span class="re0">$CoverPage</span><span class="sy0">=</span><span class="st0">&quot;Sideline&quot;</span><span class="sy0">,</span> 
&nbsp;
	<span class="br0">&#91;</span>parameter<span class="br0">&#40;</span>ParameterSetName<span class="sy0">=</span><span class="st0">&quot;Word&quot;</span><span class="sy0">,</span>Mandatory<span class="sy0">=</span><span class="re0">$False</span><span class="br0">&#41;</span><span class="br0">&#93;</span> 
	<span class="br0">&#91;</span>parameter<span class="br0">&#40;</span>ParameterSetName<span class="sy0">=</span><span class="st0">&quot;PDF&quot;</span><span class="sy0">,</span>Mandatory<span class="sy0">=</span><span class="re0">$False</span><span class="br0">&#41;</span><span class="br0">&#93;</span> 
	<span class="br0">&#91;</span>Alias<span class="br0">&#40;</span><span class="st0">&quot;UN&quot;</span><span class="br0">&#41;</span><span class="br0">&#93;</span>
	<span class="br0">&#91;</span>ValidateNotNullOrEmpty<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#93;</span>
	<span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span><span class="re0">$UserName</span><span class="sy0">=</span><span class="re0">$env</span>:username<span class="sy0">,</span>
&nbsp;
	<span class="br0">&#91;</span>parameter<span class="br0">&#40;</span>Mandatory<span class="sy0">=</span><span class="re0">$False</span><span class="br0">&#41;</span><span class="br0">&#93;</span> 
	<span class="br0">&#91;</span><span class="kw3">Switch</span><span class="br0">&#93;</span><span class="re0">$Software</span><span class="sy0">,</span>
&nbsp;
	<span class="br0">&#91;</span>parameter<span class="br0">&#40;</span>Mandatory<span class="sy0">=</span><span class="re0">$False</span><span class="br0">&#41;</span><span class="br0">&#93;</span> 
	<span class="br0">&#91;</span><span class="kw3">Switch</span><span class="br0">&#93;</span><span class="re0">$ListAllInformation</span><span class="sy0">,</span>
&nbsp;
	<span class="br0">&#91;</span>parameter<span class="br0">&#40;</span>Mandatory<span class="sy0">=</span><span class="re0">$False</span><span class="br0">&#41;</span><span class="br0">&#93;</span> 
	<span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span><span class="re0">$SMSProvider</span><span class="sy0">=</span><span class="st0">'localhost'</span>
&nbsp;
	<span class="br0">&#41;</span>
<span class="co1">#endregion</span>
&nbsp;
<span class="co1">#region script change log	</span>
<span class="co1">#webster@carlwebster.com</span>
<span class="co1">#@carlwebster on Twitter</span>
<span class="co1">#http://www.CarlWebster.com</span>
<span class="co1">#Created on June 1, 2014</span>
&nbsp;
<span class="co1">#HTML functions and sample text contributed by Ken Avram October 2014</span>
<span class="co1">#Organized functions into logical units 16-Oct-2014</span>
<span class="co1">#Added regions 16-Oct-2014</span>
<span class="co1">#endregion</span>
&nbsp;
<span class="co1">#region initial variable testing and setup</span>
Set<span class="sy0">-</span>StrictMode <span class="sy0">-</span>Version <span class="nu0">2</span>
&nbsp;
<span class="co1">#force  on</span>
<span class="re0">$PSDefaultParameterValues</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#123;</span><span class="st0">&quot;*:Verbose&quot;</span><span class="sy0">=</span><span class="re0">$True</span><span class="br0">&#125;</span>
<span class="re0">$SaveEAPreference</span> <span class="sy0">=</span> <a href="about:blank"><span class="kw6">$ErrorActionPreference</span></a>
<a href="about:blank"><span class="kw6">$ErrorActionPreference</span></a> <span class="sy0">=</span> <span class="st0">'SilentlyContinue'</span>
&nbsp;
<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$PDF</span> <span class="kw4">-eq</span> <span class="re0">$Null</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
	<span class="re0">$PDF</span> <span class="sy0">=</span> <span class="re0">$False</span>
<span class="br0">&#125;</span>
<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$Text</span> <span class="kw4">-eq</span> <span class="re0">$Null</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
	<span class="re0">$Text</span> <span class="sy0">=</span> <span class="re0">$False</span>
<span class="br0">&#125;</span>
<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$MSWord</span> <span class="kw4">-eq</span> <span class="re0">$Null</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
	<span class="re0">$MSWord</span> <span class="sy0">=</span> <span class="re0">$False</span>
<span class="br0">&#125;</span>
<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$HTML</span> <span class="kw4">-eq</span> <span class="re0">$Null</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
	<span class="re0">$HTML</span> <span class="sy0">=</span> <span class="re0">$False</span>
<span class="br0">&#125;</span>
<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$AddDateTime</span> <span class="kw4">-eq</span> <span class="re0">$Null</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
	<span class="re0">$AddDateTime</span> <span class="sy0">=</span> <span class="re0">$False</span>
<span class="br0">&#125;</span>
<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$Hardware</span> <span class="kw4">-eq</span> <span class="re0">$Null</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
	<span class="re0">$Hardware</span> <span class="sy0">=</span> <span class="re0">$False</span>
<span class="br0">&#125;</span>
<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$ComputerName</span> <span class="kw4">-eq</span> <span class="re0">$Null</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
	<span class="re0">$ComputerName</span> <span class="sy0">=</span> <span class="st0">&quot;LocalHost&quot;</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw3">If</span><span class="br0">&#40;</span><span class="sy0">!</span><span class="br0">&#40;</span><span class="kw1">Test-Path</span> Variable:PDF<span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
	<span class="re0">$PDF</span> <span class="sy0">=</span> <span class="re0">$False</span>
<span class="br0">&#125;</span>
<span class="kw3">If</span><span class="br0">&#40;</span><span class="sy0">!</span><span class="br0">&#40;</span><span class="kw1">Test-Path</span> Variable:Text<span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
	<span class="re0">$Text</span> <span class="sy0">=</span> <span class="re0">$False</span>
<span class="br0">&#125;</span>
<span class="kw3">If</span><span class="br0">&#40;</span><span class="sy0">!</span><span class="br0">&#40;</span><span class="kw1">Test-Path</span> Variable:MSWord<span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
	<span class="re0">$MSWord</span> <span class="sy0">=</span> <span class="re0">$False</span>
<span class="br0">&#125;</span>
<span class="kw3">If</span><span class="br0">&#40;</span><span class="sy0">!</span><span class="br0">&#40;</span><span class="kw1">Test-Path</span> Variable:HTML<span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
	<span class="re0">$HTML</span> <span class="sy0">=</span> <span class="re0">$False</span>
<span class="br0">&#125;</span>
<span class="kw3">If</span><span class="br0">&#40;</span><span class="sy0">!</span><span class="br0">&#40;</span><span class="kw1">Test-Path</span> Variable:AddDateTime<span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
	<span class="re0">$AddDateTime</span> <span class="sy0">=</span> <span class="re0">$False</span>
<span class="br0">&#125;</span>
<span class="kw3">If</span><span class="br0">&#40;</span><span class="sy0">!</span><span class="br0">&#40;</span><span class="kw1">Test-Path</span> Variable:Hardware<span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
	<span class="re0">$Hardware</span> <span class="sy0">=</span> <span class="re0">$False</span>
<span class="br0">&#125;</span>
<span class="kw3">If</span><span class="br0">&#40;</span><span class="sy0">!</span><span class="br0">&#40;</span><span class="kw1">Test-Path</span> Variable:ComputerName<span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
	<span class="re0">$ComputerName</span> <span class="sy0">=</span> <span class="st0">&quot;LocalHost&quot;</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$MSWord</span> <span class="kw4">-eq</span> <span class="re0">$Null</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
	<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$Text</span> <span class="kw4">-or</span> <span class="re0">$HTML</span> <span class="kw4">-or</span> <span class="re0">$PDF</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<span class="re0">$MSWord</span> <span class="sy0">=</span> <span class="re0">$False</span>
	<span class="br0">&#125;</span>
	<span class="kw3">Else</span>
	<span class="br0">&#123;</span>
		<span class="re0">$MSWord</span> <span class="sy0">=</span> <span class="re0">$True</span>
	<span class="br0">&#125;</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$MSWord</span> <span class="kw4">-eq</span> <span class="re0">$False</span> <span class="kw4">-and</span> <span class="re0">$PDF</span> <span class="kw4">-eq</span> <span class="re0">$False</span> <span class="kw4">-and</span> <span class="re0">$Text</span> <span class="kw4">-eq</span> <span class="re0">$False</span> <span class="kw4">-and</span> <span class="re0">$HTML</span> <span class="kw4">-eq</span> <span class="re0">$False</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
	<span class="re0">$MSWord</span> <span class="sy0">=</span> <span class="re0">$True</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Testing output parameters&quot;</span>
&nbsp;
<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$MSWord</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): MSWord is set&quot;</span>
<span class="br0">&#125;</span>
<span class="kw3">ElseIf</span><span class="br0">&#40;</span><span class="re0">$PDF</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): PDF is set&quot;</span>
<span class="br0">&#125;</span>
<span class="kw3">ElseIf</span><span class="br0">&#40;</span><span class="re0">$Text</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Text is set&quot;</span>
<span class="br0">&#125;</span>
<span class="kw3">ElseIf</span><span class="br0">&#40;</span><span class="re0">$HTML</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): HTML is set&quot;</span>
<span class="br0">&#125;</span>
<span class="kw3">Else</span>
<span class="br0">&#123;</span>
	<a href="about:blank"><span class="kw6">$ErrorActionPreference</span></a> <span class="sy0">=</span> <span class="re0">$SaveEAPreference</span>
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Unable to determine output parameter&quot;</span>
	<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$MSWord</span> <span class="kw4">-eq</span> <span class="re0">$Null</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): MSWord is Null&quot;</span>
	<span class="br0">&#125;</span>
	<span class="kw3">ElseIf</span><span class="br0">&#40;</span><span class="re0">$PDF</span> <span class="kw4">-eq</span> <span class="re0">$Null</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): PDF is Null&quot;</span>
	<span class="br0">&#125;</span>
	<span class="kw3">ElseIf</span><span class="br0">&#40;</span><span class="re0">$Text</span> <span class="kw4">-eq</span> <span class="re0">$Null</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Text is Null&quot;</span>
	<span class="br0">&#125;</span>
	<span class="kw3">ElseIf</span><span class="br0">&#40;</span><span class="re0">$HTML</span> <span class="kw4">-eq</span> <span class="re0">$Null</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): HTML is Null&quot;</span>
	<span class="br0">&#125;</span>
	<span class="kw3">Else</span>
	<span class="br0">&#123;</span>
		<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): MSWord is $($MSWord)&quot;</span>
		<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): PDF is $($PDF)&quot;</span>
		<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Text is $($Text)&quot;</span>
		<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): HTML is $($HTML)&quot;</span>
	<span class="br0">&#125;</span>
	<span class="kw1">Write-Error</span> <span class="st0">&quot;Unable to determine output parameter.  Script cannot continue&quot;</span>
	Exit
<span class="br0">&#125;</span>
<span class="co1">#endregion</span>
&nbsp;
<span class="co1">#region initialize variables for word html and text</span>
<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$MSWord</span> <span class="kw4">-or</span> <span class="re0">$PDF</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
	<span class="co1">#try and fix the issue with the $CompanyName variable</span>
	<span class="re0">$Script</span>:CoName <span class="sy0">=</span> <span class="re0">$CompanyName</span>
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): CoName is $($Script:CoName)&quot;</span>
&nbsp;
	<span class="co1">#the following values were attained from </span>
	<span class="co1">#http://groovy.codehaus.org/modules/scriptom/1.6.0/scriptom-office-2K3-tlb/apidocs/</span>
	<span class="co1">#http://msdn.microsoft.com/en-us/library/office/aa211923(v=office.11).aspx</span>
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$wdAlignPageNumberRight</span> <span class="sy0">=</span> <span class="nu0">2</span>
	<span class="br0">&#91;</span><span class="re3">long</span><span class="br0">&#93;</span><span class="re0">$wdColorGray15</span> <span class="sy0">=</span> <span class="nu0">14277081</span>
	<span class="br0">&#91;</span><span class="re3">long</span><span class="br0">&#93;</span><span class="re0">$wdColorGray05</span> <span class="sy0">=</span> <span class="nu0">15987699</span> 
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$wdMove</span> <span class="sy0">=</span> <span class="nu0">0</span>
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$wdSeekMainDocument</span> <span class="sy0">=</span> <span class="nu0">0</span>
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$wdSeekPrimaryFooter</span> <span class="sy0">=</span> <span class="nu0">4</span>
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$wdStory</span> <span class="sy0">=</span> <span class="nu0">6</span>
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$wdColorRed</span> <span class="sy0">=</span> <span class="nu0">255</span>
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$wdColorBlack</span> <span class="sy0">=</span> <span class="nu0">0</span>
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$wdWord2007</span> <span class="sy0">=</span> <span class="nu0">12</span>
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$wdWord2010</span> <span class="sy0">=</span> <span class="nu0">14</span>
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$wdWord2013</span> <span class="sy0">=</span> <span class="nu0">15</span>
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$wdFormatDocumentDefault</span> <span class="sy0">=</span> <span class="nu0">16</span>
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$wdFormatPDF</span> <span class="sy0">=</span> <span class="nu0">17</span>
	<span class="co1">#http://blogs.technet.com/b/heyscriptingguy/archive/2006/03/01/how-can-i-right-align-a-single-column-in-a-word-table.aspx</span>
	<span class="co1">#http://msdn.microsoft.com/en-us/library/office/ff835817%28v=office.15%29.aspx</span>
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$wdAlignParagraphLeft</span> <span class="sy0">=</span> <span class="nu0">0</span>
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$wdAlignParagraphCenter</span> <span class="sy0">=</span> <span class="nu0">1</span>
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$wdAlignParagraphRight</span> <span class="sy0">=</span> <span class="nu0">2</span>
	<span class="co1">#http://msdn.microsoft.com/en-us/library/office/ff193345%28v=office.15%29.aspx</span>
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$wdCellAlignVerticalTop</span> <span class="sy0">=</span> <span class="nu0">0</span>
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$wdCellAlignVerticalCenter</span> <span class="sy0">=</span> <span class="nu0">1</span>
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$wdCellAlignVerticalBottom</span> <span class="sy0">=</span> <span class="nu0">2</span>
	<span class="co1">#http://msdn.microsoft.com/en-us/library/office/ff844856%28v=office.15%29.aspx</span>
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$wdAutoFitFixed</span> <span class="sy0">=</span> <span class="nu0">0</span>
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$wdAutoFitContent</span> <span class="sy0">=</span> <span class="nu0">1</span>
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$wdAutoFitWindow</span> <span class="sy0">=</span> <span class="nu0">2</span>
	<span class="co1">#http://msdn.microsoft.com/en-us/library/office/ff821928%28v=office.15%29.aspx</span>
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$wdAdjustNone</span> <span class="sy0">=</span> <span class="nu0">0</span>
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$wdAdjustProportional</span> <span class="sy0">=</span> <span class="nu0">1</span>
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$wdAdjustFirstColumn</span> <span class="sy0">=</span> <span class="nu0">2</span>
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$wdAdjustSameWidth</span> <span class="sy0">=</span> <span class="nu0">3</span>
&nbsp;
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$PointsPerTabStop</span> <span class="sy0">=</span> <span class="nu0">36</span>
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$Indent0TabStops</span> <span class="sy0">=</span> <span class="nu0">0</span> <span class="sy0">*</span> <span class="re0">$PointsPerTabStop</span>
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$Indent1TabStops</span> <span class="sy0">=</span> <span class="nu0">1</span> <span class="sy0">*</span> <span class="re0">$PointsPerTabStop</span>
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$Indent2TabStops</span> <span class="sy0">=</span> <span class="nu0">2</span> <span class="sy0">*</span> <span class="re0">$PointsPerTabStop</span>
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$Indent3TabStops</span> <span class="sy0">=</span> <span class="nu0">3</span> <span class="sy0">*</span> <span class="re0">$PointsPerTabStop</span>
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$Indent4TabStops</span> <span class="sy0">=</span> <span class="nu0">4</span> <span class="sy0">*</span> <span class="re0">$PointsPerTabStop</span>
&nbsp;
	<span class="co1"># http://www.thedoctools.com/index.php?show=wt_style_names_english_danish_german_french</span>
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$wdStyleHeading1</span> <span class="sy0">=</span> <span class="sy0">-</span><span class="nu0">2</span>
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$wdStyleHeading2</span> <span class="sy0">=</span> <span class="sy0">-</span><span class="nu0">3</span>
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$wdStyleHeading3</span> <span class="sy0">=</span> <span class="sy0">-</span><span class="nu0">4</span>
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$wdStyleHeading4</span> <span class="sy0">=</span> <span class="sy0">-</span><span class="nu0">5</span>
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$wdStyleNoSpacing</span> <span class="sy0">=</span> <span class="sy0">-</span><span class="nu0">158</span>
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$wdTableGrid</span> <span class="sy0">=</span> <span class="sy0">-</span><span class="nu0">155</span>
&nbsp;
	<span class="co1">#http://groovy.codehaus.org/modules/scriptom/1.6.0/scriptom-office-2K3-tlb/apidocs/org/codehaus/groovy/scriptom/tlb/office/word/WdLineStyle.html</span>
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$wdLineStyleNone</span> <span class="sy0">=</span> <span class="nu0">0</span>
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$wdLineStyleSingle</span> <span class="sy0">=</span> <span class="nu0">1</span>
&nbsp;
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$wdHeadingFormatTrue</span> <span class="sy0">=</span> <span class="sy0">-</span><span class="nu0">1</span>
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$wdHeadingFormatFalse</span> <span class="sy0">=</span> <span class="nu0">0</span> 
&nbsp;
	<span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span><span class="re0">$RunningOS</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="kw1">Get-WmiObject</span> <span class="kw5">-class</span> Win32_OperatingSystem <span class="sy0">-</span>EA <span class="nu0">0</span><span class="br0">&#41;</span>.Caption
<span class="br0">&#125;</span>
&nbsp;
<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$HTML</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
    <span class="kw2">Set</span> htmlredmask         <span class="kw5">-Option</span> AllScope <span class="kw5">-Value</span> <span class="st0">&quot;#FF0000&quot;</span> <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
    <span class="kw2">Set</span> htmlcyanmask        <span class="kw5">-Option</span> AllScope <span class="kw5">-Value</span> <span class="st0">&quot;#00FFFF&quot;</span> <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
    <span class="kw2">Set</span> htmlbluemask        <span class="kw5">-Option</span> AllScope <span class="kw5">-Value</span> <span class="st0">&quot;#0000FF&quot;</span> <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
    <span class="kw2">Set</span> htmldarkbluemask    <span class="kw5">-Option</span> AllScope <span class="kw5">-Value</span> <span class="st0">&quot;#0000A0&quot;</span> <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
    <span class="kw2">Set</span> htmllightbluemask   <span class="kw5">-Option</span> AllScope <span class="kw5">-Value</span> <span class="st0">&quot;#ADD8E6&quot;</span> <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
    <span class="kw2">Set</span> htmlpurplemask      <span class="kw5">-Option</span> AllScope <span class="kw5">-Value</span> <span class="st0">&quot;#800080&quot;</span> <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
    <span class="kw2">Set</span> htmlyellowmask      <span class="kw5">-Option</span> AllScope <span class="kw5">-Value</span> <span class="st0">&quot;#FFFF00&quot;</span> <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
    <span class="kw2">Set</span> htmllimemask        <span class="kw5">-Option</span> AllScope <span class="kw5">-Value</span> <span class="st0">&quot;#00FF00&quot;</span> <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
    <span class="kw2">Set</span> htmlmagentamask     <span class="kw5">-Option</span> AllScope <span class="kw5">-Value</span> <span class="st0">&quot;#FF00FF&quot;</span> <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
    <span class="kw2">Set</span> htmlwhitemask       <span class="kw5">-Option</span> AllScope <span class="kw5">-Value</span> <span class="st0">&quot;#FFFFFF&quot;</span> <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
    <span class="kw2">Set</span> htmlsilvermask      <span class="kw5">-Option</span> AllScope <span class="kw5">-Value</span> <span class="st0">&quot;#C0C0C0&quot;</span> <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
    <span class="kw2">Set</span> htmlgraymask        <span class="kw5">-Option</span> AllScope <span class="kw5">-Value</span> <span class="st0">&quot;#808080&quot;</span> <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
    <span class="kw2">Set</span> htmlblackmask       <span class="kw5">-Option</span> AllScope <span class="kw5">-Value</span> <span class="st0">&quot;#000000&quot;</span> <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
    <span class="kw2">Set</span> htmlorangemask      <span class="kw5">-Option</span> AllScope <span class="kw5">-Value</span> <span class="st0">&quot;#FFA500&quot;</span> <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
    <span class="kw2">Set</span> htmlmaroonmask      <span class="kw5">-Option</span> AllScope <span class="kw5">-Value</span> <span class="st0">&quot;#800000&quot;</span> <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
    <span class="kw2">Set</span> htmlgreenmask       <span class="kw5">-Option</span> AllScope <span class="kw5">-Value</span> <span class="st0">&quot;#008000&quot;</span> <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
    <span class="kw2">Set</span> htmlolivemask       <span class="kw5">-Option</span> AllScope <span class="kw5">-Value</span> <span class="st0">&quot;#808000&quot;</span> <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
&nbsp;
    <span class="kw2">Set</span> htmlbold        <span class="kw5">-Option</span> AllScope <span class="kw5">-Value</span> <span class="nu0">1</span> <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
    <span class="kw2">Set</span> htmlitalics     <span class="kw5">-Option</span> AllScope <span class="kw5">-Value</span> <span class="nu0">2</span> <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
    <span class="kw2">Set</span> htmlred         <span class="kw5">-Option</span> AllScope <span class="kw5">-Value</span> <span class="nu0">4</span> <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
    <span class="kw2">Set</span> htmlcyan        <span class="kw5">-Option</span> AllScope <span class="kw5">-Value</span> <span class="nu0">8</span> <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
    <span class="kw2">Set</span> htmlblue        <span class="kw5">-Option</span> AllScope <span class="kw5">-Value</span> <span class="nu0">16</span> <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
    <span class="kw2">Set</span> htmldarkblue    <span class="kw5">-Option</span> AllScope <span class="kw5">-Value</span> <span class="nu0">32</span> <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
    <span class="kw2">Set</span> htmllightblue   <span class="kw5">-Option</span> AllScope <span class="kw5">-Value</span> <span class="nu0">64</span> <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
    <span class="kw2">Set</span> htmlpurple      <span class="kw5">-Option</span> AllScope <span class="kw5">-Value</span> <span class="nu0">128</span> <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
    <span class="kw2">Set</span> htmlyellow      <span class="kw5">-Option</span> AllScope <span class="kw5">-Value</span> <span class="nu0">256</span> <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
    <span class="kw2">Set</span> htmllime        <span class="kw5">-Option</span> AllScope <span class="kw5">-Value</span> <span class="nu0">512</span> <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
    <span class="kw2">Set</span> htmlmagenta     <span class="kw5">-Option</span> AllScope <span class="kw5">-Value</span> <span class="nu0">1024</span> <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
    <span class="kw2">Set</span> htmlwhite       <span class="kw5">-Option</span> AllScope <span class="kw5">-Value</span> <span class="nu0">2048</span> <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
    <span class="kw2">Set</span> htmlsilver      <span class="kw5">-Option</span> AllScope <span class="kw5">-Value</span> <span class="nu0">4096</span> <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
    <span class="kw2">Set</span> htmlgray        <span class="kw5">-Option</span> AllScope <span class="kw5">-Value</span> <span class="nu0">8192</span> <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
    <span class="kw2">Set</span> htmlolive       <span class="kw5">-Option</span> AllScope <span class="kw5">-Value</span> <span class="nu0">16384</span> <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
    <span class="kw2">Set</span> htmlorange      <span class="kw5">-Option</span> AllScope <span class="kw5">-Value</span> <span class="nu0">32768</span> <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
    <span class="kw2">Set</span> htmlmaroon      <span class="kw5">-Option</span> AllScope <span class="kw5">-Value</span> <span class="nu0">65536</span> <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
    <span class="kw2">Set</span> htmlgreen       <span class="kw5">-Option</span> AllScope <span class="kw5">-Value</span> <span class="nu0">131072</span> <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
    <span class="kw2">Set</span> htmlblack       <span class="kw5">-Option</span> AllScope <span class="kw5">-Value</span> <span class="nu0">262144</span> <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$TEXT</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
	<span class="re0">$global</span>:output <span class="sy0">=</span> <span class="st0">&quot;&quot;</span>
<span class="br0">&#125;</span>
<span class="co1">#endregion</span>
&nbsp;
<span class="co1">#region word specific functions</span>
<span class="kw3">Function</span> SetWordHashTable
<span class="br0">&#123;</span>
	<span class="kw3">Param</span><span class="br0">&#40;</span><span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span><span class="re0">$CultureCode</span><span class="br0">&#41;</span>
&nbsp;
	<span class="co1">#optimized by Michael B. SMith</span>
&nbsp;
	<span class="co1"># DE and FR translations for Word 2010 by Vladimir Radojevic</span>
	<span class="co1"># Vladimir.Radojevic@Commerzreal.com</span>
&nbsp;
	<span class="co1"># DA translations for Word 2010 by Thomas Daugaard</span>
	<span class="co1"># Citrix Infrastructure Specialist at edgemo A/S</span>
&nbsp;
	<span class="co1"># CA translations by Javier Sanchez </span>
	<span class="co1"># CEO &amp; Founder 101 Consulting</span>
&nbsp;
	<span class="co1">#ca - Catalan</span>
	<span class="co1">#da - Danish</span>
	<span class="co1">#de - German</span>
	<span class="co1">#en - English</span>
	<span class="co1">#es - Spanish</span>
	<span class="co1">#fi - Finnish</span>
	<span class="co1">#fr - French</span>
	<span class="co1">#nb - Norwegian</span>
	<span class="co1">#nl - Dutch</span>
	<span class="co1">#pt - Portuguese</span>
	<span class="co1">#sv - Swedish</span>
&nbsp;
	<span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span><span class="re0">$toc</span> <span class="sy0">=</span> $<span class="br0">&#40;</span>
		<span class="kw3">Switch</span> <span class="br0">&#40;</span><span class="re0">$CultureCode</span><span class="br0">&#41;</span>
		<span class="br0">&#123;</span>
			<span class="st0">'ca-'</span>	<span class="br0">&#123;</span> <span class="st0">'Taula automática 2'</span> <span class="br0">&#125;</span>
&nbsp;
			<span class="st0">'da-'</span>	<span class="br0">&#123;</span> <span class="st0">'Automatisk tabel 2'</span> <span class="br0">&#125;</span>
&nbsp;
			<span class="st0">'de-'</span>	<span class="br0">&#123;</span> <span class="st0">'Automatische Tabelle 2'</span> <span class="br0">&#125;</span>
&nbsp;
			<span class="st0">'en-'</span>	<span class="br0">&#123;</span> <span class="st0">'Automatic Table 2'</span> <span class="br0">&#125;</span>
&nbsp;
			<span class="st0">'es-'</span>	<span class="br0">&#123;</span> <span class="st0">'Tabla automática 2'</span> <span class="br0">&#125;</span>
&nbsp;
			<span class="st0">'fi-'</span>	<span class="br0">&#123;</span> <span class="st0">'Automaattinen taulukko 2'</span> <span class="br0">&#125;</span>
&nbsp;
			<span class="st0">'fr-'</span>	<span class="br0">&#123;</span> <span class="st0">'Sommaire Automatique 2'</span> <span class="br0">&#125;</span>
&nbsp;
			<span class="st0">'nb-'</span>	<span class="br0">&#123;</span> <span class="st0">'Automatisk tabell 2'</span> <span class="br0">&#125;</span>
&nbsp;
			<span class="st0">'nl-'</span>	<span class="br0">&#123;</span> <span class="st0">'Automatische inhoudsopgave 2'</span> <span class="br0">&#125;</span>
&nbsp;
			<span class="st0">'pt-'</span>	<span class="br0">&#123;</span> <span class="st0">'Sumário Automático 2'</span> <span class="br0">&#125;</span>
&nbsp;
			<span class="st0">'sv-'</span>	<span class="br0">&#123;</span> <span class="st0">'Automatisk innehållsförteckning2'</span> <span class="br0">&#125;</span>
		<span class="br0">&#125;</span>
	<span class="br0">&#41;</span>
&nbsp;
	<span class="re0">$Script</span>:myHash                      <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#123;</span><span class="br0">&#125;</span>
	<span class="re0">$Script</span>:myHash.Word_TableOfContents <span class="sy0">=</span> <span class="re0">$toc</span>
	<span class="re0">$Script</span>:myHash.Word_NoSpacing       <span class="sy0">=</span> <span class="re0">$wdStyleNoSpacing</span>
	<span class="re0">$Script</span>:myHash.Word_Heading1        <span class="sy0">=</span> <span class="re0">$wdStyleheading1</span>
	<span class="re0">$Script</span>:myHash.Word_Heading2        <span class="sy0">=</span> <span class="re0">$wdStyleheading2</span>
	<span class="re0">$Script</span>:myHash.Word_Heading3        <span class="sy0">=</span> <span class="re0">$wdStyleheading3</span>
	<span class="re0">$Script</span>:myHash.Word_Heading4        <span class="sy0">=</span> <span class="re0">$wdStyleheading4</span>
	<span class="re0">$Script</span>:myHash.Word_TableGrid       <span class="sy0">=</span> <span class="re0">$wdTableGrid</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw3">Function</span> GetCulture
<span class="br0">&#123;</span>
	<span class="kw3">Param</span><span class="br0">&#40;</span><span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$WordValue</span><span class="br0">&#41;</span>
&nbsp;
	<span class="co1">#codes obtained from http://support.microsoft.com/kb/221435</span>
	<span class="co1">#http://msdn.microsoft.com/en-us/library/bb213877(v=office.12).aspx</span>
	<span class="re0">$CatalanArray</span> <span class="sy0">=</span> <span class="nu0">1027</span>
	<span class="re0">$DanishArray</span> <span class="sy0">=</span> <span class="nu0">1030</span>
	<span class="re0">$DutchArray</span> <span class="sy0">=</span> <span class="nu0">2067</span><span class="sy0">,</span> <span class="nu0">1043</span>
	<span class="re0">$EnglishArray</span> <span class="sy0">=</span> <span class="nu0">3081</span><span class="sy0">,</span> <span class="nu0">10249</span><span class="sy0">,</span> <span class="nu0">4105</span><span class="sy0">,</span> <span class="nu0">9225</span><span class="sy0">,</span> <span class="nu0">6153</span><span class="sy0">,</span> <span class="nu0">8201</span><span class="sy0">,</span> <span class="nu0">5129</span><span class="sy0">,</span> <span class="nu0">13321</span><span class="sy0">,</span> <span class="nu0">7177</span><span class="sy0">,</span> <span class="nu0">11273</span><span class="sy0">,</span> <span class="nu0">2057</span><span class="sy0">,</span> <span class="nu0">1033</span><span class="sy0">,</span> <span class="nu0">12297</span>
	<span class="re0">$FinnishArray</span> <span class="sy0">=</span> <span class="nu0">1035</span>
	<span class="re0">$FrenchArray</span> <span class="sy0">=</span> <span class="nu0">2060</span><span class="sy0">,</span> <span class="nu0">1036</span><span class="sy0">,</span> <span class="nu0">11276</span><span class="sy0">,</span> <span class="nu0">3084</span><span class="sy0">,</span> <span class="nu0">12300</span><span class="sy0">,</span> <span class="nu0">5132</span><span class="sy0">,</span> <span class="nu0">13324</span><span class="sy0">,</span> <span class="nu0">6156</span><span class="sy0">,</span> <span class="nu0">8204</span><span class="sy0">,</span> <span class="nu0">10252</span><span class="sy0">,</span> <span class="nu0">7180</span><span class="sy0">,</span> <span class="nu0">9228</span><span class="sy0">,</span> <span class="nu0">4108</span>
	<span class="re0">$GermanArray</span> <span class="sy0">=</span> <span class="nu0">1031</span><span class="sy0">,</span> <span class="nu0">3079</span><span class="sy0">,</span> <span class="nu0">5127</span><span class="sy0">,</span> <span class="nu0">4103</span><span class="sy0">,</span> <span class="nu0">2055</span>
	<span class="re0">$NorwegianArray</span> <span class="sy0">=</span> <span class="nu0">1044</span><span class="sy0">,</span> <span class="nu0">2068</span>
	<span class="re0">$PortugueseArray</span> <span class="sy0">=</span> <span class="nu0">1046</span><span class="sy0">,</span> <span class="nu0">2070</span>
	<span class="re0">$SpanishArray</span> <span class="sy0">=</span> <span class="nu0">1034</span><span class="sy0">,</span> <span class="nu0">11274</span><span class="sy0">,</span> <span class="nu0">16394</span><span class="sy0">,</span> <span class="nu0">13322</span><span class="sy0">,</span> <span class="nu0">9226</span><span class="sy0">,</span> <span class="nu0">5130</span><span class="sy0">,</span> <span class="nu0">7178</span><span class="sy0">,</span> <span class="nu0">12298</span><span class="sy0">,</span> <span class="nu0">17418</span><span class="sy0">,</span> <span class="nu0">4106</span><span class="sy0">,</span> <span class="nu0">18442</span><span class="sy0">,</span> <span class="nu0">19466</span><span class="sy0">,</span> <span class="nu0">6154</span><span class="sy0">,</span> <span class="nu0">15370</span><span class="sy0">,</span> <span class="nu0">10250</span><span class="sy0">,</span> <span class="nu0">20490</span><span class="sy0">,</span> <span class="nu0">3082</span><span class="sy0">,</span> <span class="nu0">14346</span><span class="sy0">,</span> <span class="nu0">8202</span>
	<span class="re0">$SwedishArray</span> <span class="sy0">=</span> <span class="nu0">1053</span><span class="sy0">,</span> <span class="nu0">2077</span>
&nbsp;
	<span class="co1">#ca - Catalan</span>
	<span class="co1">#da - Danish</span>
	<span class="co1">#de - German</span>
	<span class="co1">#en - English</span>
	<span class="co1">#es - Spanish</span>
	<span class="co1">#fi - Finnish</span>
	<span class="co1">#fr - French</span>
	<span class="co1">#nb - Norwegian</span>
	<span class="co1">#nl - Dutch</span>
	<span class="co1">#pt - Portuguese</span>
	<span class="co1">#sv - Swedish</span>
&nbsp;
	<span class="kw3">Switch</span> <span class="br0">&#40;</span><span class="re0">$WordValue</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<span class="br0">&#123;</span><span class="re0">$CatalanArray</span> <span class="kw4">-contains</span> <a href="about:blank"><span class="kw6">$_</span></a><span class="br0">&#125;</span> <span class="br0">&#123;</span><span class="re0">$CultureCode</span> <span class="sy0">=</span> <span class="st0">&quot;ca-&quot;</span><span class="br0">&#125;</span>
		<span class="br0">&#123;</span><span class="re0">$DanishArray</span> <span class="kw4">-contains</span> <a href="about:blank"><span class="kw6">$_</span></a><span class="br0">&#125;</span> <span class="br0">&#123;</span><span class="re0">$CultureCode</span> <span class="sy0">=</span> <span class="st0">&quot;da-&quot;</span><span class="br0">&#125;</span>
		<span class="br0">&#123;</span><span class="re0">$DutchArray</span> <span class="kw4">-contains</span> <a href="about:blank"><span class="kw6">$_</span></a><span class="br0">&#125;</span> <span class="br0">&#123;</span><span class="re0">$CultureCode</span> <span class="sy0">=</span> <span class="st0">&quot;nl-&quot;</span><span class="br0">&#125;</span>
		<span class="br0">&#123;</span><span class="re0">$EnglishArray</span> <span class="kw4">-contains</span> <a href="about:blank"><span class="kw6">$_</span></a><span class="br0">&#125;</span> <span class="br0">&#123;</span><span class="re0">$CultureCode</span> <span class="sy0">=</span> <span class="st0">&quot;en-&quot;</span><span class="br0">&#125;</span>
		<span class="br0">&#123;</span><span class="re0">$FinnishArray</span> <span class="kw4">-contains</span> <a href="about:blank"><span class="kw6">$_</span></a><span class="br0">&#125;</span> <span class="br0">&#123;</span><span class="re0">$CultureCode</span> <span class="sy0">=</span> <span class="st0">&quot;fi-&quot;</span><span class="br0">&#125;</span>
		<span class="br0">&#123;</span><span class="re0">$FrenchArray</span> <span class="kw4">-contains</span> <a href="about:blank"><span class="kw6">$_</span></a><span class="br0">&#125;</span> <span class="br0">&#123;</span><span class="re0">$CultureCode</span> <span class="sy0">=</span> <span class="st0">&quot;fr-&quot;</span><span class="br0">&#125;</span>
		<span class="br0">&#123;</span><span class="re0">$GermanArray</span> <span class="kw4">-contains</span> <a href="about:blank"><span class="kw6">$_</span></a><span class="br0">&#125;</span> <span class="br0">&#123;</span><span class="re0">$CultureCode</span> <span class="sy0">=</span> <span class="st0">&quot;de-&quot;</span><span class="br0">&#125;</span>
		<span class="br0">&#123;</span><span class="re0">$NorwegianArray</span> <span class="kw4">-contains</span> <a href="about:blank"><span class="kw6">$_</span></a><span class="br0">&#125;</span> <span class="br0">&#123;</span><span class="re0">$CultureCode</span> <span class="sy0">=</span> <span class="st0">&quot;nb-&quot;</span><span class="br0">&#125;</span>
		<span class="br0">&#123;</span><span class="re0">$PortugueseArray</span> <span class="kw4">-contains</span> <a href="about:blank"><span class="kw6">$_</span></a><span class="br0">&#125;</span> <span class="br0">&#123;</span><span class="re0">$CultureCode</span> <span class="sy0">=</span> <span class="st0">&quot;pt-&quot;</span><span class="br0">&#125;</span>
		<span class="br0">&#123;</span><span class="re0">$SpanishArray</span> <span class="kw4">-contains</span> <a href="about:blank"><span class="kw6">$_</span></a><span class="br0">&#125;</span> <span class="br0">&#123;</span><span class="re0">$CultureCode</span> <span class="sy0">=</span> <span class="st0">&quot;es-&quot;</span><span class="br0">&#125;</span>
		<span class="br0">&#123;</span><span class="re0">$SwedishArray</span> <span class="kw4">-contains</span> <a href="about:blank"><span class="kw6">$_</span></a><span class="br0">&#125;</span> <span class="br0">&#123;</span><span class="re0">$CultureCode</span> <span class="sy0">=</span> <span class="st0">&quot;sv-&quot;</span><span class="br0">&#125;</span>
		Default <span class="br0">&#123;</span><span class="re0">$CultureCode</span> <span class="sy0">=</span> <span class="st0">&quot;en-&quot;</span><span class="br0">&#125;</span>
	<span class="br0">&#125;</span>
&nbsp;
	<span class="kw3">Return</span> <span class="re0">$CultureCode</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw3">Function</span> ValidateCoverPage
<span class="br0">&#123;</span>
	<span class="kw3">Param</span><span class="br0">&#40;</span><span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$xWordVersion</span><span class="sy0">,</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span><span class="re0">$xCP</span><span class="sy0">,</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span><span class="re0">$CultureCode</span><span class="br0">&#41;</span>
&nbsp;
	<span class="re0">$xArray</span> <span class="sy0">=</span> <span class="st0">&quot;&quot;</span>
&nbsp;
	<span class="kw3">Switch</span> <span class="br0">&#40;</span><span class="re0">$CultureCode</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<span class="st0">'ca-'</span>	<span class="br0">&#123;</span>
				<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$xWordVersion</span> <span class="kw4">-eq</span> <span class="re0">$wdWord2013</span><span class="br0">&#41;</span>
				<span class="br0">&#123;</span>
					<span class="re0">$xArray</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="st0">&quot;Austin&quot;</span><span class="sy0">,</span> <span class="st0">&quot;En bandes&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Faceta&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Filigrana&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Integral&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Ió (clar)&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Ió (fosc)&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Línia lateral&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Moviment&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Quadrícula&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Retrospectiu&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Sector (clar)&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Sector (fosc)&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Semàfor&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Visualització&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Whisp&quot;</span><span class="br0">&#41;</span>
				<span class="br0">&#125;</span>
				<span class="kw3">ElseIf</span><span class="br0">&#40;</span><span class="re0">$xWordVersion</span> <span class="kw4">-eq</span> <span class="re0">$wdWord2010</span><span class="br0">&#41;</span>
				<span class="br0">&#123;</span>
					<span class="re0">$xArray</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="st0">&quot;Alfabet&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Anual&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Austin&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Conservador&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Contrast&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Cubicles&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Diplomàtic&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Exposició&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Línia lateral&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Mod&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Mosiac&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Moviment&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Paper de diari&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Perspectiva&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Piles&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Quadrícula&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Sobri&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Transcendir&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Trencaclosques&quot;</span><span class="br0">&#41;</span>
				<span class="br0">&#125;</span>
			<span class="br0">&#125;</span>
&nbsp;
		<span class="st0">'da-'</span>	<span class="br0">&#123;</span>
				<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$xWordVersion</span> <span class="kw4">-eq</span> <span class="re0">$wdWord2013</span><span class="br0">&#41;</span>
				<span class="br0">&#123;</span>
					<span class="re0">$xArray</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="st0">&quot;BevægElse&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Brusen&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Ion (lys)&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Filigran&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Retro&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Semafor&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Visningsmaster&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Integral&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Facet&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Gitter&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Stribet&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Sidelinje&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Udsnit (lys)&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Udsnit (mørk)&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Ion (mørk)&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Austin&quot;</span><span class="br0">&#41;</span>
				<span class="br0">&#125;</span>
				<span class="kw3">ElseIf</span><span class="br0">&#40;</span><span class="re0">$xWordVersion</span> <span class="kw4">-eq</span> <span class="re0">$wdWord2010</span><span class="br0">&#41;</span>
				<span class="br0">&#123;</span>
					<span class="re0">$xArray</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="st0">&quot;BevægElse&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Moderat&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Perspektiv&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Firkanter&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Overskrid&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Alfabet&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Kontrast&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Stakke&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Fliser&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Gåde&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Gitter&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Austin&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Eksponering&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Sidelinje&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Enkel&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Nålestribet&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Årlig&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Avispapir&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Tradionel&quot;</span><span class="br0">&#41;</span>
				<span class="br0">&#125;</span>
			<span class="br0">&#125;</span>
&nbsp;
		<span class="st0">'de-'</span>	<span class="br0">&#123;</span>
				<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$xWordVersion</span> <span class="kw4">-eq</span> <span class="re0">$wdWord2013</span><span class="br0">&#41;</span>
				<span class="br0">&#123;</span>
					<span class="re0">$xArray</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="st0">&quot;Semaphor&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Segment (hell)&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Ion (hell)&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Raster&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Ion (dunkel)&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Filigran&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Rückblick&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Pfiff&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;ViewMaster&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Segment (dunkel)&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Verbunden&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Bewegung&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Randlinie&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Austin&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Integral&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Facette&quot;</span><span class="br0">&#41;</span>
				<span class="br0">&#125;</span>
				<span class="kw3">ElseIf</span><span class="br0">&#40;</span><span class="re0">$xWordVersion</span> <span class="kw4">-eq</span> <span class="re0">$wdWord2010</span><span class="br0">&#41;</span>
				<span class="br0">&#123;</span>
					<span class="re0">$xArray</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="st0">&quot;Alphabet&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Austin&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Bewegung&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Durchscheinend&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Herausgestellt&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Jährlich&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Kacheln&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Kontrast&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Kubistisch&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Modern&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Nadelstreifen&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Perspektive&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Puzzle&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Randlinie&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Raster&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Schlicht&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Stapel&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Traditionell&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Zeitungspapier&quot;</span><span class="br0">&#41;</span>
				<span class="br0">&#125;</span>
			<span class="br0">&#125;</span>
&nbsp;
		<span class="st0">'en-'</span>	<span class="br0">&#123;</span>
				<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$xWordVersion</span> <span class="kw4">-eq</span> <span class="re0">$wdWord2013</span><span class="br0">&#41;</span>
				<span class="br0">&#123;</span>
					<span class="re0">$xArray</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="st0">&quot;Austin&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Banded&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Facet&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Filigree&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Grid&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Integral&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Ion (Dark)&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Ion (Light)&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Motion&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Retrospect&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Semaphore&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Sideline&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Slice (Dark)&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Slice (Light)&quot;</span><span class="sy0">,</span> <span class="st0">&quot;ViewMaster&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Whisp&quot;</span><span class="br0">&#41;</span>
				<span class="br0">&#125;</span>
				<span class="kw3">ElseIf</span><span class="br0">&#40;</span><span class="re0">$xWordVersion</span> <span class="kw4">-eq</span> <span class="re0">$wdWord2010</span><span class="br0">&#41;</span>
				<span class="br0">&#123;</span>
					<span class="re0">$xArray</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="st0">&quot;Alphabet&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Annual&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Austere&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Austin&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Conservative&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Contrast&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Cubicles&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Exposure&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Grid&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Mod&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Motion&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Newsprint&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Perspective&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Pinstripes&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Puzzle&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Sideline&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Stacks&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Tiles&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Transcend&quot;</span><span class="br0">&#41;</span>
				<span class="br0">&#125;</span>
			<span class="br0">&#125;</span>
&nbsp;
		<span class="st0">'es-'</span>	<span class="br0">&#123;</span>
				<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$xWordVersion</span> <span class="kw4">-eq</span> <span class="re0">$wdWord2013</span><span class="br0">&#41;</span>
				<span class="br0">&#123;</span>
					<span class="re0">$xArray</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="st0">&quot;Whisp&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Vista principal&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Filigrana&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Austin&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Slice (luz)&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Faceta&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Semáforo&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Retrospectiva&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Cuadrícula&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Movimiento&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Cortar (oscuro)&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Línea lateral&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Ion (oscuro)&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Ion (claro)&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Integral&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Con bandas&quot;</span><span class="br0">&#41;</span>
				<span class="br0">&#125;</span>
				<span class="kw3">ElseIf</span><span class="br0">&#40;</span><span class="re0">$xWordVersion</span> <span class="kw4">-eq</span> <span class="re0">$wdWord2010</span><span class="br0">&#41;</span>
				<span class="br0">&#123;</span>
					<span class="re0">$xArray</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="st0">&quot;Alfabeto&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Anual&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Austero&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Austin&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Conservador&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Contraste&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Cuadrícula&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Cubículos&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Exposición&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Línea lateral&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Moderno&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Mosaicos&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Movimiento&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Papel periódico&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Perspectiva&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Pilas&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Puzzle&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Rayas&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Sobrepasar&quot;</span><span class="br0">&#41;</span>
				<span class="br0">&#125;</span>
			<span class="br0">&#125;</span>
&nbsp;
		<span class="st0">'fi-'</span>	<span class="br0">&#123;</span>
				<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$xWordVersion</span> <span class="kw4">-eq</span> <span class="re0">$wdWord2013</span><span class="br0">&#41;</span>
				<span class="br0">&#123;</span>
					<span class="re0">$xArray</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="st0">&quot;Filigraani&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Integraali&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Ioni (tumma)&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Ioni (vaalea)&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Opastin&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Pinta&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Retro&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Sektori (tumma)&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Sektori (vaalea)&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Vaihtuvavärinen&quot;</span><span class="sy0">,</span> <span class="st0">&quot;ViewMaster&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Austin&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Kiehkura&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Liike&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Ruudukko&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Sivussa&quot;</span><span class="br0">&#41;</span>
				<span class="br0">&#125;</span>
				<span class="kw3">ElseIf</span><span class="br0">&#40;</span><span class="re0">$xWordVersion</span> <span class="kw4">-eq</span> <span class="re0">$wdWord2010</span><span class="br0">&#41;</span>
				<span class="br0">&#123;</span>
					<span class="re0">$xArray</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="st0">&quot;Aakkoset&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Askeettinen&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Austin&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Kontrasti&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Laatikot&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Liike&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Liituraita&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Mod&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Osittain peitossa&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Palapeli&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Perinteinen&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Perspektiivi&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Pinot&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Ruudukko&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Ruudut&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Sanomalehtipaperi&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Sivussa&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Vuotuinen&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Ylitys&quot;</span><span class="br0">&#41;</span>
				<span class="br0">&#125;</span>
			<span class="br0">&#125;</span>
&nbsp;
		<span class="st0">'fr-'</span>	<span class="br0">&#123;</span>
				<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$xWordVersion</span> <span class="kw4">-eq</span> <span class="re0">$wdWord2013</span><span class="br0">&#41;</span>
				<span class="br0">&#123;</span>
					<span class="re0">$xArray</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="st0">&quot;ViewMaster&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Secteur (foncé)&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Sémaphore&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Rétrospective&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Ion (foncé)&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Ion (clair)&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Intégrale&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Filigrane&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Facette&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Secteur (clair)&quot;</span><span class="sy0">,</span> <span class="st0">&quot;À bandes&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Austin&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Guide&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Whisp&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Lignes latérales&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Quadrillage&quot;</span><span class="br0">&#41;</span>
				<span class="br0">&#125;</span>
				<span class="kw3">ElseIf</span><span class="br0">&#40;</span><span class="re0">$xWordVersion</span> <span class="kw4">-eq</span> <span class="re0">$wdWord2010</span><span class="br0">&#41;</span>
				<span class="br0">&#123;</span>
					<span class="re0">$xArray</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="st0">&quot;Mosaïques&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Ligne latérale&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Annuel&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Perspective&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Contraste&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Emplacements de bureau&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Moderne&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Blocs empilés&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Rayures fines&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Austère&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Transcendant&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Classique&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Quadrillage&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Exposition&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Alphabet&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Mots croisés&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Papier journal&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Austin&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Guide&quot;</span><span class="br0">&#41;</span>
				<span class="br0">&#125;</span>
			<span class="br0">&#125;</span>
&nbsp;
		<span class="st0">'nb-'</span>	<span class="br0">&#123;</span>
				<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$xWordVersion</span> <span class="kw4">-eq</span> <span class="re0">$wdWord2013</span><span class="br0">&#41;</span>
				<span class="br0">&#123;</span>
					<span class="re0">$xArray</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="st0">&quot;Austin&quot;</span><span class="sy0">,</span> <span class="st0">&quot;BevegElse&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Dempet&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Fasett&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Filigran&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Integral&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Ion (lys)&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Ion (mørk)&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Retrospekt&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Rutenett&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Sektor (lys)&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Sektor (mørk)&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Semafor&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Sidelinje&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Stripet&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;ViewMaster&quot;</span><span class="br0">&#41;</span>
				<span class="br0">&#125;</span>
				<span class="kw3">ElseIf</span><span class="br0">&#40;</span><span class="re0">$xWordVersion</span> <span class="kw4">-eq</span> <span class="re0">$wdWord2010</span><span class="br0">&#41;</span>
				<span class="br0">&#123;</span>
					<span class="re0">$xArray</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="st0">&quot;Alfabet&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Årlig&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Avistrykk&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Austin&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Avlukker&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;BevegElse&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Engasjement&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Enkel&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Fliser&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Konservativ&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Kontrast&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Mod&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Perspektiv&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Puslespill&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Rutenett&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Sidelinje&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Smale striper&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Stabler&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Transcenderende&quot;</span><span class="br0">&#41;</span>
				<span class="br0">&#125;</span>
			<span class="br0">&#125;</span>
&nbsp;
		<span class="st0">'nl-'</span>	<span class="br0">&#123;</span>
				<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$xWordVersion</span> <span class="kw4">-eq</span> <span class="re0">$wdWord2013</span><span class="br0">&#41;</span>
				<span class="br0">&#123;</span>
					<span class="re0">$xArray</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="st0">&quot;Austin&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Beweging&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Facet&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Filigraan&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Gestreept&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Integraal&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Ion (donker)&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Ion (licht)&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Raster&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Segment (Light)&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Semafoor&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Slice (donker)&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Spriet&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Terugblik&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Terzijde&quot;</span><span class="sy0">,</span> <span class="st0">&quot;ViewMaster&quot;</span><span class="br0">&#41;</span>
				<span class="br0">&#125;</span>
				<span class="kw3">ElseIf</span><span class="br0">&#40;</span><span class="re0">$xWordVersion</span> <span class="kw4">-eq</span> <span class="re0">$wdWord2010</span><span class="br0">&#41;</span>
				<span class="br0">&#123;</span>
					<span class="re0">$xArray</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="st0">&quot;Aantrekkelijk&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Alfabet&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Austin&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Bescheiden&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Beweging&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Blikvanger&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Contrast&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Eenvoudig&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Jaarlijks&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Krantenpapier&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Krijtstreep&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Kubussen&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Mod&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Perspectief&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Puzzel&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Raster&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Stapels&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Tegels&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Terzijde&quot;</span><span class="br0">&#41;</span>
				<span class="br0">&#125;</span>
			<span class="br0">&#125;</span>
&nbsp;
		<span class="st0">'pt-'</span>	<span class="br0">&#123;</span>
				<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$xWordVersion</span> <span class="kw4">-eq</span> <span class="re0">$wdWord2013</span><span class="br0">&#41;</span>
				<span class="br0">&#123;</span>
					<span class="re0">$xArray</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="st0">&quot;Animação&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Austin&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Em Tiras&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Exibição Mestra&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Faceta&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Fatia (Clara)&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Fatia (Escura)&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Filete&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Filigrana&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Grade&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Integral&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Íon (Claro)&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Íon (Escuro)&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Linha Lateral&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Retrospectiva&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Semáforo&quot;</span><span class="br0">&#41;</span>
				<span class="br0">&#125;</span>
				<span class="kw3">ElseIf</span><span class="br0">&#40;</span><span class="re0">$xWordVersion</span> <span class="kw4">-eq</span> <span class="re0">$wdWord2010</span><span class="br0">&#41;</span>
				<span class="br0">&#123;</span>
					<span class="re0">$xArray</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="st0">&quot;Alfabeto&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Animação&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Anual&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Austero&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Austin&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Baias&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Conservador&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Contraste&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Exposição&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Grade&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Ladrilhos&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Linha Lateral&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Listras&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Mod&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Papel Jornal&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Perspectiva&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Pilhas&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Quebra-cabeça&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Transcend&quot;</span><span class="br0">&#41;</span>
				<span class="br0">&#125;</span>
			<span class="br0">&#125;</span>
&nbsp;
		<span class="st0">'sv-'</span>	<span class="br0">&#123;</span>
				<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$xWordVersion</span> <span class="kw4">-eq</span> <span class="re0">$wdWord2013</span><span class="br0">&#41;</span>
				<span class="br0">&#123;</span>
					<span class="re0">$xArray</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="st0">&quot;Austin&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Band&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Fasett&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Filigran&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Integrerad&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Jon (ljust)&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Jon (mörkt)&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Knippe&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Rutnät&quot;</span><span class="sy0">,</span> <span class="st0">&quot;RörElse&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Sektor (ljus)&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Sektor (mörk)&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Semafor&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Sidlinje&quot;</span><span class="sy0">,</span> <span class="st0">&quot;VisaHuvudsida&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Återblick&quot;</span><span class="br0">&#41;</span>
				<span class="br0">&#125;</span>
				<span class="kw3">ElseIf</span><span class="br0">&#40;</span><span class="re0">$xWordVersion</span> <span class="kw4">-eq</span> <span class="re0">$wdWord2010</span><span class="br0">&#41;</span>
				<span class="br0">&#123;</span>
					<span class="re0">$xArray</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="st0">&quot;Alfabetmönster&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Austin&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Enkelt&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Exponering&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Konservativt&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Kontrast&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Kritstreck&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Kuber&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Perspektiv&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Plattor&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Pussel&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Rutnät&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;RörElse&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Sidlinje&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Sobert&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Staplat&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Tidningspapper&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Årligt&quot;</span><span class="sy0">,</span>
					<span class="st0">&quot;Övergående&quot;</span><span class="br0">&#41;</span>
				<span class="br0">&#125;</span>
			<span class="br0">&#125;</span>
&nbsp;
		Default	<span class="br0">&#123;</span>
					<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$xWordVersion</span> <span class="kw4">-eq</span> <span class="re0">$wdWord2013</span><span class="br0">&#41;</span>
					<span class="br0">&#123;</span>
						<span class="re0">$xArray</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="st0">&quot;Austin&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Banded&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Facet&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Filigree&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Grid&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Integral&quot;</span><span class="sy0">,</span>
						<span class="st0">&quot;Ion (Dark)&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Ion (Light)&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Motion&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Retrospect&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Semaphore&quot;</span><span class="sy0">,</span>
						<span class="st0">&quot;Sideline&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Slice (Dark)&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Slice (Light)&quot;</span><span class="sy0">,</span> <span class="st0">&quot;ViewMaster&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Whisp&quot;</span><span class="br0">&#41;</span>
					<span class="br0">&#125;</span>
					<span class="kw3">ElseIf</span><span class="br0">&#40;</span><span class="re0">$xWordVersion</span> <span class="kw4">-eq</span> <span class="re0">$wdWord2010</span><span class="br0">&#41;</span>
					<span class="br0">&#123;</span>
						<span class="re0">$xArray</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="st0">&quot;Alphabet&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Annual&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Austere&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Austin&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Conservative&quot;</span><span class="sy0">,</span>
						<span class="st0">&quot;Contrast&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Cubicles&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Exposure&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Grid&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Mod&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Motion&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Newsprint&quot;</span><span class="sy0">,</span>
						<span class="st0">&quot;Perspective&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Pinstripes&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Puzzle&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Sideline&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Stacks&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Tiles&quot;</span><span class="sy0">,</span> <span class="st0">&quot;Transcend&quot;</span><span class="br0">&#41;</span>
					<span class="br0">&#125;</span>
				<span class="br0">&#125;</span>
	<span class="br0">&#125;</span>
&nbsp;
	<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$xArray</span> <span class="kw4">-contains</span> <span class="re0">$xCP</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<span class="re0">$xArray</span> <span class="sy0">=</span> <span class="re0">$Null</span>
		<span class="kw3">Return</span> <span class="re0">$True</span>
	<span class="br0">&#125;</span>
	<span class="kw3">Else</span>
	<span class="br0">&#123;</span>
		<span class="re0">$xArray</span> <span class="sy0">=</span> <span class="re0">$Null</span>
		<span class="kw3">Return</span> <span class="re0">$False</span>
	<span class="br0">&#125;</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw3">Function</span> CheckWordPrereq
<span class="br0">&#123;</span>
	<span class="kw3">If</span><span class="br0">&#40;</span><span class="br0">&#40;</span><span class="kw1">Test-Path</span>  REGISTRY::HKEY_CLASSES_ROOT\Word.Application<span class="br0">&#41;</span> <span class="kw4">-eq</span> <span class="re0">$False</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<a href="about:blank"><span class="kw6">$ErrorActionPreference</span></a> <span class="sy0">=</span> <span class="re0">$SaveEAPreference</span>
		<span class="kw1">Write-Host</span> <span class="st0">&quot;<span class="es0">`n</span><span class="es0">`n</span><span class="es0">`t</span><span class="es0">`t</span>This script directly outputs to Microsoft Word, please install Microsoft Word<span class="es0">`n</span><span class="es0">`n</span>&quot;</span>
		Exit
	<span class="br0">&#125;</span>
&nbsp;
	<span class="co1">#find out our session (usually &quot;1&quot; except on TS/RDC or Citrix)</span>
	<span class="re0">$SessionID</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="kw1">Get-Process</span> <span class="sy0">-</span>PID <span class="re0">$PID</span><span class="br0">&#41;</span>.SessionId
&nbsp;
	<span class="co1">#Find out if winword is running in our session</span>
	<span class="br0">&#91;</span><span class="re3">bool</span><span class="br0">&#93;</span><span class="re0">$wordrunning</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="br0">&#40;</span><span class="kw1">Get-Process</span> <span class="st0">'WinWord'</span> <span class="sy0">-</span>ea <span class="nu0">0</span><span class="br0">&#41;</span><span class="sy0">|?</span><span class="br0">&#123;</span><a href="about:blank"><span class="kw6">$_</span></a>.SessionId <span class="kw4">-eq</span> <span class="re0">$SessionID</span><span class="br0">&#125;</span><span class="br0">&#41;</span> <span class="kw4">-ne</span> <span class="re0">$Null</span>
	<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$wordrunning</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<a href="about:blank"><span class="kw6">$ErrorActionPreference</span></a> <span class="sy0">=</span> <span class="re0">$SaveEAPreference</span>
		<span class="kw1">Write-Host</span> <span class="st0">&quot;<span class="es0">`n</span><span class="es0">`n</span><span class="es0">`t</span>Please close all instances of Microsoft Word before running this report.<span class="es0">`n</span><span class="es0">`n</span>&quot;</span>
		Exit
	<span class="br0">&#125;</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw3">Function</span> ValidateCompanyName
<span class="br0">&#123;</span>
	<span class="br0">&#91;</span><span class="re3">bool</span><span class="br0">&#93;</span><span class="re0">$xResult</span> <span class="sy0">=</span> Test<span class="sy0">-</span>RegistryValue <span class="st0">&quot;HKCU:\Software\Microsoft\Office\Common\UserInfo&quot;</span> <span class="st0">&quot;CompanyName&quot;</span>
	<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$xResult</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<span class="kw3">Return</span> Get<span class="sy0">-</span>RegistryValue <span class="st0">&quot;HKCU:\Software\Microsoft\Office\Common\UserInfo&quot;</span> <span class="st0">&quot;CompanyName&quot;</span>
	<span class="br0">&#125;</span>
	<span class="kw3">Else</span>
	<span class="br0">&#123;</span>
		<span class="re0">$xResult</span> <span class="sy0">=</span> Test<span class="sy0">-</span>RegistryValue <span class="st0">&quot;HKCU:\Software\Microsoft\Office\Common\UserInfo&quot;</span> <span class="st0">&quot;Company&quot;</span>
		<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$xResult</span><span class="br0">&#41;</span>
		<span class="br0">&#123;</span>
			<span class="kw3">Return</span> Get<span class="sy0">-</span>RegistryValue <span class="st0">&quot;HKCU:\Software\Microsoft\Office\Common\UserInfo&quot;</span> <span class="st0">&quot;Company&quot;</span>
		<span class="br0">&#125;</span>
		<span class="kw3">Else</span>
		<span class="br0">&#123;</span>
			<span class="kw3">Return</span> <span class="st0">&quot;&quot;</span>
		<span class="br0">&#125;</span>
	<span class="br0">&#125;</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw3">Function</span> _SetDocumentProperty 
<span class="br0">&#123;</span>
	<span class="co1">#jeff hicks</span>
	<span class="kw3">Param</span><span class="br0">&#40;</span><span class="br0">&#91;</span><span class="re3">object</span><span class="br0">&#93;</span><span class="re0">$Properties</span><span class="sy0">,</span><span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span><span class="re0">$Name</span><span class="sy0">,</span><span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span><span class="re0">$Value</span><span class="br0">&#41;</span>
	<span class="co1">#get the property object</span>
	<span class="re0">$prop</span> <span class="sy0">=</span> <span class="re0">$properties</span> <span class="sy0">|</span> <span class="kw3">ForEach</span> <span class="br0">&#123;</span> 
		<span class="re0">$propname</span><span class="sy0">=</span><a href="about:blank"><span class="kw6">$_</span></a>.GetType<span class="br0">&#40;</span><span class="br0">&#41;</span>.InvokeMember<span class="br0">&#40;</span><span class="st0">&quot;Name&quot;</span><span class="sy0">,</span><span class="st0">&quot;GetProperty&quot;</span><span class="sy0">,</span><span class="re0">$Null</span><span class="sy0">,</span><a href="about:blank"><span class="kw6">$_</span></a><span class="sy0">,</span><span class="re0">$Null</span><span class="br0">&#41;</span>
		<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$propname</span> <span class="kw4">-eq</span> <span class="re0">$Name</span><span class="br0">&#41;</span> 
		<span class="br0">&#123;</span>
			<span class="kw3">Return</span> <a href="about:blank"><span class="kw6">$_</span></a>
		<span class="br0">&#125;</span>
	<span class="br0">&#125;</span> <span class="co1">#ForEach</span>
&nbsp;
	<span class="co1">#set the value</span>
	<span class="re0">$Prop</span>.GetType<span class="br0">&#40;</span><span class="br0">&#41;</span>.InvokeMember<span class="br0">&#40;</span><span class="st0">&quot;Value&quot;</span><span class="sy0">,</span><span class="st0">&quot;SetProperty&quot;</span><span class="sy0">,</span><span class="re0">$Null</span><span class="sy0">,</span><span class="re0">$prop</span><span class="sy0">,</span><span class="re0">$Value</span><span class="br0">&#41;</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw3">Function</span> FindWordDocumentEnd
<span class="br0">&#123;</span>
	<span class="co1">#return focus to main document    </span>
	<span class="re0">$Script</span>:Doc.ActiveWindow.ActivePane.view.SeekView <span class="sy0">=</span> <span class="re0">$wdSeekMainDocument</span>
	<span class="co1">#move to the end of the current document</span>
	<span class="re0">$Script</span>:Selection.EndKey<span class="br0">&#40;</span><span class="re0">$wdStory</span><span class="sy0">,</span><span class="re0">$wdMove</span><span class="br0">&#41;</span> <span class="sy0">|</span> <span class="kw1">Out-Null</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw3">Function</span> SetupWord
<span class="br0">&#123;</span>
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Setting up Word&quot;</span>
&nbsp;
	<span class="co1"># Setup word for output</span>
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Create Word comObject.&quot;</span>
	<span class="re0">$Script</span>:Word <span class="sy0">=</span> <span class="kw1">New-Object</span> <span class="kw5">-comobject</span> <span class="st0">&quot;Word.Application&quot;</span> <span class="sy0">-</span>EA <span class="nu0">0</span> <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
&nbsp;
	<span class="kw3">If</span><span class="br0">&#40;</span><span class="sy0">!</span><span class="re6">$?</span> <span class="kw4">-or</span> <span class="re0">$Script</span>:Word <span class="kw4">-eq</span> <span class="re0">$Null</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<span class="kw1">Write-Warning</span> <span class="st0">&quot;The Word object could not be created.  You may need to repair your Word installation.&quot;</span>
		<a href="about:blank"><span class="kw6">$ErrorActionPreference</span></a> <span class="sy0">=</span> <span class="re0">$SaveEAPreference</span>
		<span class="kw1">Write-Error</span> <span class="st0">&quot;<span class="es0">`n</span><span class="es0">`n</span><span class="es0">`t</span><span class="es0">`t</span>The Word object could not be created.  You may need to repair your Word installation.<span class="es0">`n</span><span class="es0">`n</span><span class="es0">`t</span><span class="es0">`t</span>Script cannot continue.<span class="es0">`n</span><span class="es0">`n</span>&quot;</span>
		Exit
	<span class="br0">&#125;</span>
&nbsp;
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Determine Word language value&quot;</span>
	<span class="kw3">If</span><span class="br0">&#40;</span> <span class="br0">&#40;</span> validStateProp <span class="re0">$Script</span>:Word Language Value__ <span class="br0">&#41;</span> <span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$Script</span>:WordLanguageValue <span class="sy0">=</span> <span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$Script</span>:Word.Language.Value__
	<span class="br0">&#125;</span>
	<span class="kw3">Else</span>
	<span class="br0">&#123;</span>
		<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$Script</span>:WordLanguageValue <span class="sy0">=</span> <span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$Script</span>:Word.Language
	<span class="br0">&#125;</span>
&nbsp;
	<span class="kw3">If</span><span class="br0">&#40;</span><span class="sy0">!</span><span class="br0">&#40;</span><span class="re0">$Script</span>:WordLanguageValue <span class="kw4">-gt</span> <span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<a href="about:blank"><span class="kw6">$ErrorActionPreference</span></a> <span class="sy0">=</span> <span class="re0">$SaveEAPreference</span>
		<span class="kw1">Write-Error</span> <span class="st0">&quot;<span class="es0">`n</span><span class="es0">`n</span><span class="es0">`t</span><span class="es0">`t</span>Unable to determine the Word language value.<span class="es0">`n</span><span class="es0">`n</span><span class="es0">`t</span><span class="es0">`t</span>Script cannot continue.<span class="es0">`n</span><span class="es0">`n</span>&quot;</span>
		AbortScript
	<span class="br0">&#125;</span>
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Word language value is $($Script:WordLanguageValue)&quot;</span>
&nbsp;
	<span class="re0">$Script</span>:WordCultureCode <span class="sy0">=</span> GetCulture <span class="re0">$Script</span>:WordLanguageValue
&nbsp;
	SetWordHashTable <span class="re0">$Script</span>:WordCultureCode
&nbsp;
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$Script</span>:WordVersion <span class="sy0">=</span> <span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$Script</span>:Word.Version
	<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$Script</span>:WordVersion <span class="kw4">-eq</span> <span class="re0">$wdWord2013</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<span class="re0">$Script</span>:WordProduct <span class="sy0">=</span> <span class="st0">&quot;Word 2013&quot;</span>
	<span class="br0">&#125;</span>
	<span class="kw3">ElseIf</span><span class="br0">&#40;</span><span class="re0">$Script</span>:WordVersion <span class="kw4">-eq</span> <span class="re0">$wdWord2010</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<span class="re0">$Script</span>:WordProduct <span class="sy0">=</span> <span class="st0">&quot;Word 2010&quot;</span>
	<span class="br0">&#125;</span>
	<span class="kw3">ElseIf</span><span class="br0">&#40;</span><span class="re0">$Script</span>:WordVersion <span class="kw4">-eq</span> <span class="re0">$wdWord2007</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<a href="about:blank"><span class="kw6">$ErrorActionPreference</span></a> <span class="sy0">=</span> <span class="re0">$SaveEAPreference</span>
		<span class="kw1">Write-Error</span> <span class="st0">&quot;<span class="es0">`n</span><span class="es0">`n</span><span class="es0">`t</span><span class="es0">`t</span>Microsoft Word 2007 is no longer supported.<span class="es0">`n</span><span class="es0">`n</span><span class="es0">`t</span><span class="es0">`t</span>Script will end.<span class="es0">`n</span><span class="es0">`n</span>&quot;</span>
		AbortScript
	<span class="br0">&#125;</span>
	<span class="kw3">Else</span>
	<span class="br0">&#123;</span>
		<a href="about:blank"><span class="kw6">$ErrorActionPreference</span></a> <span class="sy0">=</span> <span class="re0">$SaveEAPreference</span>
		<span class="kw1">Write-Error</span> <span class="st0">&quot;<span class="es0">`n</span><span class="es0">`n</span><span class="es0">`t</span><span class="es0">`t</span>You are running an untested or unsupported version of Microsoft Word.<span class="es0">`n</span><span class="es0">`n</span><span class="es0">`t</span><span class="es0">`t</span>Script will end.<span class="es0">`n</span><span class="es0">`n</span><span class="es0">`t</span><span class="es0">`t</span>Please send info on your version of Word to webster@carlwebster.com<span class="es0">`n</span><span class="es0">`n</span>&quot;</span>
		AbortScript
	<span class="br0">&#125;</span>
&nbsp;
	<span class="co1">#only validate CompanyName if the field is blank</span>
	<span class="kw3">If</span><span class="br0">&#40;</span><span class="br0">&#91;</span><span class="re3">String</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$Script</span>:CoName<span class="br0">&#41;</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Company name is blank.  Retrieve company name from registry.&quot;</span>
		<span class="re0">$TmpName</span> <span class="sy0">=</span> ValidateCompanyName
&nbsp;
		<span class="kw3">If</span><span class="br0">&#40;</span><span class="br0">&#91;</span><span class="re3">String</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$TmpName</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
		<span class="br0">&#123;</span>
			<span class="kw1">Write-Warning</span> <span class="st0">&quot;<span class="es0">`n</span><span class="es0">`n</span><span class="es0">`t</span><span class="es0">`t</span>Company Name is blank so Cover Page will not show a Company Name.&quot;</span>
			<span class="kw1">Write-Warning</span> <span class="st0">&quot;<span class="es0">`n</span><span class="es0">`t</span><span class="es0">`t</span>Check HKCU:\Software\Microsoft\Office\Common\UserInfo for Company or CompanyName value.&quot;</span>
			<span class="kw1">Write-Warning</span> <span class="st0">&quot;<span class="es0">`n</span><span class="es0">`t</span><span class="es0">`t</span>You may want to use the -CompanyName parameter if you need a Company Name on the cover page.<span class="es0">`n</span><span class="es0">`n</span>&quot;</span>
		<span class="br0">&#125;</span>
		<span class="kw3">Else</span>
		<span class="br0">&#123;</span>
			<span class="re0">$Script</span>:CoName <span class="sy0">=</span> <span class="re0">$TmpName</span>
			<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Updated company name to $($Script:CoName)&quot;</span>
		<span class="br0">&#125;</span>
	<span class="br0">&#125;</span>
&nbsp;
	<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$Script</span>:WordCultureCode <span class="kw4">-ne</span> <span class="st0">&quot;en-&quot;</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Check Default Cover Page for $($WordCultureCode)&quot;</span>
		<span class="br0">&#91;</span><span class="re3">bool</span><span class="br0">&#93;</span><span class="re0">$CPChanged</span> <span class="sy0">=</span> <span class="re0">$False</span>
		<span class="kw3">Switch</span> <span class="br0">&#40;</span><span class="re0">$Script</span>:WordCultureCode<span class="br0">&#41;</span>
		<span class="br0">&#123;</span>
			<span class="st0">'ca-'</span>	<span class="br0">&#123;</span>
					<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$CoverPage</span> <span class="kw4">-eq</span> <span class="st0">&quot;Sideline&quot;</span><span class="br0">&#41;</span>
					<span class="br0">&#123;</span>
						<span class="re0">$CoverPage</span> <span class="sy0">=</span> <span class="st0">&quot;Línia lateral&quot;</span>
						<span class="re0">$CPChanged</span> <span class="sy0">=</span> <span class="re0">$True</span>
					<span class="br0">&#125;</span>
				<span class="br0">&#125;</span>
&nbsp;
			<span class="st0">'da-'</span>	<span class="br0">&#123;</span>
					<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$CoverPage</span> <span class="kw4">-eq</span> <span class="st0">&quot;Sideline&quot;</span><span class="br0">&#41;</span>
					<span class="br0">&#123;</span>
						<span class="re0">$CoverPage</span> <span class="sy0">=</span> <span class="st0">&quot;Sidelinje&quot;</span>
						<span class="re0">$CPChanged</span> <span class="sy0">=</span> <span class="re0">$True</span>
					<span class="br0">&#125;</span>
				<span class="br0">&#125;</span>
&nbsp;
			<span class="st0">'de-'</span>	<span class="br0">&#123;</span>
					<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$CoverPage</span> <span class="kw4">-eq</span> <span class="st0">&quot;Sideline&quot;</span><span class="br0">&#41;</span>
					<span class="br0">&#123;</span>
						<span class="re0">$CoverPage</span> <span class="sy0">=</span> <span class="st0">&quot;Randlinie&quot;</span>
						<span class="re0">$CPChanged</span> <span class="sy0">=</span> <span class="re0">$True</span>
					<span class="br0">&#125;</span>
				<span class="br0">&#125;</span>
&nbsp;
			<span class="st0">'es-'</span>	<span class="br0">&#123;</span>
					<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$CoverPage</span> <span class="kw4">-eq</span> <span class="st0">&quot;Sideline&quot;</span><span class="br0">&#41;</span>
					<span class="br0">&#123;</span>
						<span class="re0">$CoverPage</span> <span class="sy0">=</span> <span class="st0">&quot;Línea lateral&quot;</span>
						<span class="re0">$CPChanged</span> <span class="sy0">=</span> <span class="re0">$True</span>
					<span class="br0">&#125;</span>
				<span class="br0">&#125;</span>
&nbsp;
			<span class="st0">'fi-'</span>	<span class="br0">&#123;</span>
					<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$CoverPage</span> <span class="kw4">-eq</span> <span class="st0">&quot;Sideline&quot;</span><span class="br0">&#41;</span>
					<span class="br0">&#123;</span>
						<span class="re0">$CoverPage</span> <span class="sy0">=</span> <span class="st0">&quot;Sivussa&quot;</span>
						<span class="re0">$CPChanged</span> <span class="sy0">=</span> <span class="re0">$True</span>
					<span class="br0">&#125;</span>
				<span class="br0">&#125;</span>
&nbsp;
			<span class="st0">'fr-'</span>	<span class="br0">&#123;</span>
					<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$CoverPage</span> <span class="kw4">-eq</span> <span class="st0">&quot;Sideline&quot;</span><span class="br0">&#41;</span>
					<span class="br0">&#123;</span>
						<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$Script</span>:WordVersion <span class="kw4">-eq</span> <span class="re0">$wdWord2013</span><span class="br0">&#41;</span>
						<span class="br0">&#123;</span>
							<span class="re0">$CoverPage</span> <span class="sy0">=</span> <span class="st0">&quot;Lignes latérales&quot;</span>
							<span class="re0">$CPChanged</span> <span class="sy0">=</span> <span class="re0">$True</span>
						<span class="br0">&#125;</span>
						<span class="kw3">Else</span>
						<span class="br0">&#123;</span>
							<span class="re0">$CoverPage</span> <span class="sy0">=</span> <span class="st0">&quot;Ligne latérale&quot;</span>
							<span class="re0">$CPChanged</span> <span class="sy0">=</span> <span class="re0">$True</span>
						<span class="br0">&#125;</span>
					<span class="br0">&#125;</span>
				<span class="br0">&#125;</span>
&nbsp;
			<span class="st0">'nb-'</span>	<span class="br0">&#123;</span>
					<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$CoverPage</span> <span class="kw4">-eq</span> <span class="st0">&quot;Sideline&quot;</span><span class="br0">&#41;</span>
					<span class="br0">&#123;</span>
						<span class="re0">$CoverPage</span> <span class="sy0">=</span> <span class="st0">&quot;Sidelinje&quot;</span>
						<span class="re0">$CPChanged</span> <span class="sy0">=</span> <span class="re0">$True</span>
					<span class="br0">&#125;</span>
				<span class="br0">&#125;</span>
&nbsp;
			<span class="st0">'nl-'</span>	<span class="br0">&#123;</span>
					<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$CoverPage</span> <span class="kw4">-eq</span> <span class="st0">&quot;Sideline&quot;</span><span class="br0">&#41;</span>
					<span class="br0">&#123;</span>
						<span class="re0">$CoverPage</span> <span class="sy0">=</span> <span class="st0">&quot;Terzijde&quot;</span>
						<span class="re0">$CPChanged</span> <span class="sy0">=</span> <span class="re0">$True</span>
					<span class="br0">&#125;</span>
				<span class="br0">&#125;</span>
&nbsp;
			<span class="st0">'pt-'</span>	<span class="br0">&#123;</span>
					<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$CoverPage</span> <span class="kw4">-eq</span> <span class="st0">&quot;Sideline&quot;</span><span class="br0">&#41;</span>
					<span class="br0">&#123;</span>
						<span class="re0">$CoverPage</span> <span class="sy0">=</span> <span class="st0">&quot;Linha Lateral&quot;</span>
						<span class="re0">$CPChanged</span> <span class="sy0">=</span> <span class="re0">$True</span>
					<span class="br0">&#125;</span>
				<span class="br0">&#125;</span>
&nbsp;
			<span class="st0">'sv-'</span>	<span class="br0">&#123;</span>
					<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$CoverPage</span> <span class="kw4">-eq</span> <span class="st0">&quot;Sideline&quot;</span><span class="br0">&#41;</span>
					<span class="br0">&#123;</span>
						<span class="re0">$CoverPage</span> <span class="sy0">=</span> <span class="st0">&quot;Sidlinje&quot;</span>
						<span class="re0">$CPChanged</span> <span class="sy0">=</span> <span class="re0">$True</span>
					<span class="br0">&#125;</span>
				<span class="br0">&#125;</span>
		<span class="br0">&#125;</span>
&nbsp;
		<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$CPChanged</span><span class="br0">&#41;</span>
		<span class="br0">&#123;</span>
			<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Changed Default Cover Page from Sideline to $($CoverPage)&quot;</span>
		<span class="br0">&#125;</span>
	<span class="br0">&#125;</span>
&nbsp;
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Validate cover page $($CoverPage) for culture code $($Script:WordCultureCode)&quot;</span>
	<span class="br0">&#91;</span><span class="re3">bool</span><span class="br0">&#93;</span><span class="re0">$ValidCP</span> <span class="sy0">=</span> <span class="re0">$False</span>
&nbsp;
	<span class="re0">$ValidCP</span> <span class="sy0">=</span> ValidateCoverPage <span class="re0">$Script</span>:WordVersion <span class="re0">$CoverPage</span> <span class="re0">$Script</span>:WordCultureCode
&nbsp;
	<span class="kw3">If</span><span class="br0">&#40;</span><span class="sy0">!</span><span class="re0">$ValidCP</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<a href="about:blank"><span class="kw6">$ErrorActionPreference</span></a> <span class="sy0">=</span> <span class="re0">$SaveEAPreference</span>
		<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Word language value $($Script:WordLanguageValue)&quot;</span>
		<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Culture code $($Script:WordCultureCode)&quot;</span>
		<span class="kw1">Write-Error</span> <span class="st0">&quot;<span class="es0">`n</span><span class="es0">`n</span><span class="es0">`t</span><span class="es0">`t</span>For $($Script:WordProduct), $($CoverPage) is not a valid Cover Page option.<span class="es0">`n</span><span class="es0">`n</span><span class="es0">`t</span><span class="es0">`t</span>Script cannot continue.<span class="es0">`n</span><span class="es0">`n</span>&quot;</span>
		AbortScript
	<span class="br0">&#125;</span>
&nbsp;
	ShowScriptOptions
&nbsp;
	<span class="re0">$Script</span>:Word.Visible <span class="sy0">=</span> <span class="re0">$False</span>
&nbsp;
	<span class="co1">#http://jdhitsolutions.com/blog/2012/05/san-diego-2012-powershell-deep-dive-slides-and-demos/</span>
	<span class="co1">#using Jeff's Demo-WordReport.ps1 file for examples</span>
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Load Word Templates&quot;</span>
&nbsp;
	<span class="br0">&#91;</span><span class="re3">bool</span><span class="br0">&#93;</span><span class="re0">$Script</span>:CoverPagesExist <span class="sy0">=</span> <span class="re0">$False</span>
	<span class="br0">&#91;</span><span class="re3">bool</span><span class="br0">&#93;</span><span class="re0">$BuildingBlocksExist</span> <span class="sy0">=</span> <span class="re0">$False</span>
&nbsp;
	<span class="re0">$Script</span>:Word.Templates.LoadBuildingBlocks<span class="br0">&#40;</span><span class="br0">&#41;</span>
	<span class="co1">#word 2010/2013</span>
	<span class="re0">$BuildingBlocksCollection</span> <span class="sy0">=</span> <span class="re0">$Script</span>:Word.Templates <span class="sy0">|</span> <span class="kw3">Where</span> <span class="br0">&#123;</span><a href="about:blank"><span class="kw6">$_</span></a>.name <span class="kw4">-eq</span> <span class="st0">&quot;Built-In Building Blocks.dotx&quot;</span><span class="br0">&#125;</span>
&nbsp;
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Attempt to load cover page $($CoverPage)&quot;</span>
	<span class="re0">$part</span> <span class="sy0">=</span> <span class="re0">$Null</span>
&nbsp;
	<span class="re0">$BuildingBlocksCollection</span> <span class="sy0">|</span> 
	<span class="kw3">ForEach</span><span class="br0">&#123;</span>
		<span class="kw3">If</span> <span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a>.BuildingBlockEntries.Item<span class="br0">&#40;</span><span class="re0">$CoverPage</span><span class="br0">&#41;</span>.Name <span class="kw4">-eq</span> <span class="re0">$CoverPage</span><span class="br0">&#41;</span> 
		<span class="br0">&#123;</span>
			<span class="re0">$BuildingBlocks</span> <span class="sy0">=</span> <a href="about:blank"><span class="kw6">$_</span></a>
		<span class="br0">&#125;</span>
	<span class="br0">&#125;</span>        
&nbsp;
	<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$BuildingBlocks</span> <span class="kw4">-ne</span> <span class="re0">$Null</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<span class="re0">$BuildingBlocksExist</span> <span class="sy0">=</span> <span class="re0">$True</span>
&nbsp;
		Try 
		<span class="br0">&#123;</span>
			<span class="re0">$part</span> <span class="sy0">=</span> <span class="re0">$BuildingBlocks</span>.BuildingBlockEntries.Item<span class="br0">&#40;</span><span class="re0">$CoverPage</span><span class="br0">&#41;</span>
		<span class="br0">&#125;</span>
&nbsp;
		Catch
		<span class="br0">&#123;</span>
			<span class="re0">$part</span> <span class="sy0">=</span> <span class="re0">$Null</span>
		<span class="br0">&#125;</span>
&nbsp;
		<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$part</span> <span class="kw4">-ne</span> <span class="re0">$Null</span><span class="br0">&#41;</span>
		<span class="br0">&#123;</span>
			<span class="re0">$Script</span>:CoverPagesExist <span class="sy0">=</span> <span class="re0">$True</span>
		<span class="br0">&#125;</span>
	<span class="br0">&#125;</span>
&nbsp;
	<span class="kw3">If</span><span class="br0">&#40;</span><span class="sy0">!</span><span class="re0">$Script</span>:CoverPagesExist<span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Cover Pages are not installed or the Cover Page $($CoverPage) does not exist.&quot;</span>
		<span class="kw1">Write-Warning</span> <span class="st0">&quot;Cover Pages are not installed or the Cover Page $($CoverPage) does not exist.&quot;</span>
		<span class="kw1">Write-Warning</span> <span class="st0">&quot;This report will not have a Cover Page.&quot;</span>
	<span class="br0">&#125;</span>
&nbsp;
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Create empty word doc&quot;</span>
	<span class="re0">$Script</span>:Doc <span class="sy0">=</span> <span class="re0">$Script</span>:Word.Documents.Add<span class="br0">&#40;</span><span class="br0">&#41;</span>
	<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$Script</span>:Doc <span class="kw4">-eq</span> <span class="re0">$Null</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): &quot;</span>
		<a href="about:blank"><span class="kw6">$ErrorActionPreference</span></a> <span class="sy0">=</span> <span class="re0">$SaveEAPreference</span>
		<span class="kw1">Write-Error</span> <span class="st0">&quot;<span class="es0">`n</span><span class="es0">`n</span><span class="es0">`t</span><span class="es0">`t</span>An empty Word document could not be created.<span class="es0">`n</span><span class="es0">`n</span><span class="es0">`t</span><span class="es0">`t</span>Script cannot continue.<span class="es0">`n</span><span class="es0">`n</span>&quot;</span>
		AbortScript
	<span class="br0">&#125;</span>
&nbsp;
	<span class="re0">$Script</span>:Selection <span class="sy0">=</span> <span class="re0">$Script</span>:Word.Selection
	<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$Script</span>:Selection <span class="kw4">-eq</span> <span class="re0">$Null</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): &quot;</span>
		<a href="about:blank"><span class="kw6">$ErrorActionPreference</span></a> <span class="sy0">=</span> <span class="re0">$SaveEAPreference</span>
		<span class="kw1">Write-Error</span> <span class="st0">&quot;<span class="es0">`n</span><span class="es0">`n</span><span class="es0">`t</span><span class="es0">`t</span>An unknown error happened selecting the entire Word document for default formatting options.<span class="es0">`n</span><span class="es0">`n</span><span class="es0">`t</span><span class="es0">`t</span>Script cannot continue.<span class="es0">`n</span><span class="es0">`n</span>&quot;</span>
		AbortScript
	<span class="br0">&#125;</span>
&nbsp;
	<span class="co1">#set Default tab stops to 1/2 inch (this line is not from Jeff Hicks)</span>
	<span class="co1">#36 = .50&quot;</span>
	<span class="re0">$Script</span>:Word.ActiveDocument.DefaultTabStop <span class="sy0">=</span> <span class="nu0">36</span>
&nbsp;
	<span class="co1">#Disable Spell and Grammar Check to resolve issue and improve performance (from Pat Coughlin)</span>
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Disable grammar and spell checking&quot;</span>
	<span class="co1">#bug reported 1-Apr-2014 by Tim Mangan</span>
	<span class="co1">#save current options first before turning them off</span>
	<span class="re0">$Script</span>:CurrentGrammarOption <span class="sy0">=</span> <span class="re0">$Script</span>:Word.Options.CheckGrammarAsYouType
	<span class="re0">$Script</span>:CurrentSpellingOption <span class="sy0">=</span> <span class="re0">$Script</span>:Word.Options.CheckSpellingAsYouType
	<span class="re0">$Script</span>:Word.Options.CheckGrammarAsYouType <span class="sy0">=</span> <span class="re0">$False</span>
	<span class="re0">$Script</span>:Word.Options.CheckSpellingAsYouType <span class="sy0">=</span> <span class="re0">$False</span>
&nbsp;
	<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$BuildingBlocksExist</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<span class="co1">#insert new page, getting ready for table of contents</span>
		<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Insert new page, getting ready for table of contents&quot;</span>
		<span class="re0">$part</span>.Insert<span class="br0">&#40;</span><span class="re0">$Script</span>:Selection.Range<span class="sy0">,</span><span class="re0">$True</span><span class="br0">&#41;</span> <span class="sy0">|</span> <span class="kw1">Out-Null</span>
		<span class="re0">$Script</span>:Selection.InsertNewPage<span class="br0">&#40;</span><span class="br0">&#41;</span>
&nbsp;
		<span class="co1">#table of contents</span>
		<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Table of Contents - $($Script:MyHash.Word_TableOfContents)&quot;</span>
		<span class="re0">$toc</span> <span class="sy0">=</span> <span class="re0">$BuildingBlocks</span>.BuildingBlockEntries.Item<span class="br0">&#40;</span><span class="re0">$Script</span>:MyHash.Word_TableOfContents<span class="br0">&#41;</span>
		<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$toc</span> <span class="kw4">-eq</span> <span class="re0">$Null</span><span class="br0">&#41;</span>
		<span class="br0">&#123;</span>
			<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): &quot;</span>
			<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Table of Content - $($Script:MyHash.Word_TableOfContents) could not be retrieved.&quot;</span>
			<span class="kw1">Write-Warning</span> <span class="st0">&quot;This report will not have a Table of Contents.&quot;</span>
		<span class="br0">&#125;</span>
		<span class="kw3">Else</span>
		<span class="br0">&#123;</span>
			<span class="re0">$toc</span>.insert<span class="br0">&#40;</span><span class="re0">$Script</span>:Selection.Range<span class="sy0">,</span><span class="re0">$True</span><span class="br0">&#41;</span> <span class="sy0">|</span> <span class="kw1">Out-Null</span>
		<span class="br0">&#125;</span>
	<span class="br0">&#125;</span>
	<span class="kw3">Else</span>
	<span class="br0">&#123;</span>
		<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Table of Contents are not installed.&quot;</span>
		<span class="kw1">Write-Warning</span> <span class="st0">&quot;Table of Contents are not installed so this report will not have a Table of Contents.&quot;</span>
	<span class="br0">&#125;</span>
&nbsp;
	<span class="co1">#set the footer</span>
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Set the footer&quot;</span>
	<span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span><span class="re0">$footertext</span> <span class="sy0">=</span> <span class="st0">&quot;Report created by $username&quot;</span>
&nbsp;
	<span class="co1">#get the footer</span>
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Get the footer and format font&quot;</span>
	<span class="re0">$Script</span>:Doc.ActiveWindow.ActivePane.view.SeekView <span class="sy0">=</span> <span class="re0">$wdSeekPrimaryFooter</span>
	<span class="co1">#get the footer and format font</span>
	<span class="re0">$footers</span> <span class="sy0">=</span> <span class="re0">$Script</span>:Doc.Sections.Last.Footers
	<span class="kw3">ForEach</span> <span class="br0">&#40;</span><span class="re0">$footer</span> <span class="kw3">in</span> <span class="re0">$footers</span><span class="br0">&#41;</span> 
	<span class="br0">&#123;</span>
		<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$footer</span>.exists<span class="br0">&#41;</span> 
		<span class="br0">&#123;</span>
			<span class="re0">$footer</span>.range.Font.name <span class="sy0">=</span> <span class="st0">&quot;Calibri&quot;</span>
			<span class="re0">$footer</span>.range.Font.size <span class="sy0">=</span> <span class="nu0">8</span>
			<span class="re0">$footer</span>.range.Font.Italic <span class="sy0">=</span> <span class="re0">$True</span>
			<span class="re0">$footer</span>.range.Font.Bold <span class="sy0">=</span> <span class="re0">$True</span>
		<span class="br0">&#125;</span>
	<span class="br0">&#125;</span> <span class="co1">#end ForEach</span>
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Footer text&quot;</span>
	<span class="re0">$Script</span>:Selection.HeaderFooter.Range.Text <span class="sy0">=</span> <span class="re0">$footerText</span>
&nbsp;
	<span class="co1">#add page numbering</span>
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Add page numbering&quot;</span>
	<span class="re0">$Script</span>:Selection.HeaderFooter.PageNumbers.Add<span class="br0">&#40;</span><span class="re0">$wdAlignPageNumberRight</span><span class="br0">&#41;</span> <span class="sy0">|</span> <span class="kw1">Out-Null</span>
&nbsp;
	FindWordDocumentEnd
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date):&quot;</span>
	<span class="co1">#end of Jeff Hicks </span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw3">Function</span> UpdateDocumentProperties
<span class="br0">&#123;</span>
	<span class="kw3">Param</span><span class="br0">&#40;</span><span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span><span class="re0">$AbstractTitle</span><span class="sy0">,</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span><span class="re0">$SubjectTitle</span><span class="br0">&#41;</span>
	<span class="co1">#Update document properties</span>
	<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$MSWORD</span> <span class="kw4">-or</span> <span class="re0">$PDF</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$Script</span>:CoverPagesExist<span class="br0">&#41;</span>
		<span class="br0">&#123;</span>
			<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Set Cover Page Properties&quot;</span>
			_SetDocumentProperty <span class="re0">$Script</span>:Doc.BuiltInDocumentProperties <span class="st0">&quot;Company&quot;</span> <span class="re0">$Script</span>:CoName
			_SetDocumentProperty <span class="re0">$Script</span>:Doc.BuiltInDocumentProperties <span class="st0">&quot;Title&quot;</span> <span class="re0">$Script</span>:title
			_SetDocumentProperty <span class="re0">$Script</span>:Doc.BuiltInDocumentProperties <span class="st0">&quot;Author&quot;</span> <span class="re0">$username</span>
&nbsp;
			_SetDocumentProperty <span class="re0">$Script</span>:Doc.BuiltInDocumentProperties <span class="st0">&quot;Subject&quot;</span> <span class="re0">$SubjectTitle</span>
&nbsp;
			<span class="co1">#Get the Coverpage XML part</span>
			<span class="re0">$cp</span> <span class="sy0">=</span> <span class="re0">$Script</span>:Doc.CustomXMLParts <span class="sy0">|</span> <span class="kw3">Where</span> <span class="br0">&#123;</span><a href="about:blank"><span class="kw6">$_</span></a>.NamespaceURI <span class="kw4">-match</span> <span class="st0">&quot;coverPageProps$&quot;</span><span class="br0">&#125;</span>
&nbsp;
			<span class="co1">#get the abstract XML part</span>
			<span class="re0">$ab</span> <span class="sy0">=</span> <span class="re0">$cp</span>.documentelement.ChildNodes <span class="sy0">|</span> <span class="kw3">Where</span> <span class="br0">&#123;</span><a href="about:blank"><span class="kw6">$_</span></a>.basename <span class="kw4">-eq</span> <span class="st0">&quot;Abstract&quot;</span><span class="br0">&#125;</span>
&nbsp;
			<span class="co1">#set the text</span>
			<span class="kw3">If</span><span class="br0">&#40;</span><span class="br0">&#91;</span><span class="re3">String</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$Script</span>:CoName<span class="br0">&#41;</span><span class="br0">&#41;</span>
			<span class="br0">&#123;</span>
				<span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span><span class="re0">$abstract</span> <span class="sy0">=</span> <span class="re0">$AbstractTitle</span>
			<span class="br0">&#125;</span>
			<span class="kw3">Else</span>
			<span class="br0">&#123;</span>
				<span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span><span class="re0">$abstract</span> <span class="sy0">=</span> <span class="st0">&quot;$($AbstractTitle) for $($Script:CoName)&quot;</span>
			<span class="br0">&#125;</span>
&nbsp;
			<span class="re0">$ab</span>.Text <span class="sy0">=</span> <span class="re0">$abstract</span>
&nbsp;
			<span class="re0">$ab</span> <span class="sy0">=</span> <span class="re0">$cp</span>.documentelement.ChildNodes <span class="sy0">|</span> <span class="kw3">Where</span> <span class="br0">&#123;</span><a href="about:blank"><span class="kw6">$_</span></a>.basename <span class="kw4">-eq</span> <span class="st0">&quot;PublishDate&quot;</span><span class="br0">&#125;</span>
			<span class="co1">#set the text</span>
			<span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span><span class="re0">$abstract</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="kw1">Get-Date</span> <span class="kw5">-Format</span> d<span class="br0">&#41;</span>.ToString<span class="br0">&#40;</span><span class="br0">&#41;</span>
			<span class="re0">$ab</span>.Text <span class="sy0">=</span> <span class="re0">$abstract</span>
&nbsp;
			<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Update the Table of Contents&quot;</span>
			<span class="co1">#update the Table of Contents</span>
			<span class="re0">$Script</span>:Doc.TablesOfContents.item<span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>.Update<span class="br0">&#40;</span><span class="br0">&#41;</span>
			<span class="re0">$cp</span> <span class="sy0">=</span> <span class="re0">$Null</span>
			<span class="re0">$ab</span> <span class="sy0">=</span> <span class="re0">$Null</span>
			<span class="re0">$abstract</span> <span class="sy0">=</span> <span class="re0">$Null</span>
		<span class="br0">&#125;</span>
	<span class="br0">&#125;</span>
<span class="br0">&#125;</span>
<span class="co1">#endregion</span>
&nbsp;
<span class="co1">#region registry functions</span>
<span class="co1">#http://stackoverflow.com/questions/5648931/test-if-registry-value-exists</span>
<span class="co1"># This Function just gets $True or $False</span>
<span class="kw3">Function</span> Test<span class="sy0">-</span>RegistryValue<span class="br0">&#40;</span><span class="re0">$path</span><span class="sy0">,</span> <span class="re0">$name</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
	<span class="re0">$key</span> <span class="sy0">=</span> <span class="kw1">Get-Item</span> <span class="kw5">-LiteralPath</span> <span class="re0">$path</span> <span class="sy0">-</span>EA <span class="nu0">0</span>
	<span class="re0">$key</span> <span class="kw4">-and</span> <span class="re0">$Null</span> <span class="kw4">-ne</span> <span class="re0">$key</span>.GetValue<span class="br0">&#40;</span><span class="re0">$name</span><span class="sy0">,</span> <span class="re0">$Null</span><span class="br0">&#41;</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="co1"># Gets the specified registry value or $Null if it is missing</span>
<span class="kw3">Function</span> Get<span class="sy0">-</span>RegistryValue<span class="br0">&#40;</span><span class="re0">$path</span><span class="sy0">,</span> <span class="re0">$name</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
	<span class="re0">$key</span> <span class="sy0">=</span> <span class="kw1">Get-Item</span> <span class="kw5">-LiteralPath</span> <span class="re0">$path</span> <span class="sy0">-</span>EA <span class="nu0">0</span>
	<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$key</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<span class="re0">$key</span>.GetValue<span class="br0">&#40;</span><span class="re0">$name</span><span class="sy0">,</span> <span class="re0">$Null</span><span class="br0">&#41;</span>
	<span class="br0">&#125;</span>
	<span class="kw3">Else</span>
	<span class="br0">&#123;</span>
		<span class="re0">$Null</span>
	<span class="br0">&#125;</span>
<span class="br0">&#125;</span>
<span class="co1">#endregion</span>
&nbsp;
<span class="co1">#region word, text and html line output functions</span>
<span class="kw3">Function</span> line
<span class="co1">#function created by Michael B. Smith, Exchange MVP</span>
<span class="co1">#@essentialexchange on Twitter</span>
<span class="co1">#http://TheEssentialExchange.com</span>
<span class="co1">#for creating the formatted text report</span>
<span class="co1">#created March 2011</span>
<span class="co1">#updated March 2014</span>
<span class="br0">&#123;</span>
	<span class="kw3">Param</span><span class="br0">&#40;</span> <span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$tabs</span> <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">,</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span><span class="re0">$name</span> <span class="sy0">=</span> <span class="st0">''</span><span class="sy0">,</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span><span class="re0">$value</span> <span class="sy0">=</span> <span class="st0">''</span><span class="sy0">,</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span><span class="re0">$newline</span> <span class="sy0">=</span> <span class="st0">&quot;<span class="es0">`r</span><span class="es0">`n</span>&quot;</span><span class="sy0">,</span> <span class="br0">&#91;</span><span class="kw3">switch</span><span class="br0">&#93;</span><span class="re0">$nonewline</span> <span class="br0">&#41;</span>
	<span class="kw3">While</span><span class="br0">&#40;</span> <span class="re0">$tabs</span> <span class="kw4">-gt</span> <span class="nu0">0</span> <span class="br0">&#41;</span> <span class="br0">&#123;</span> <span class="re0">$Global</span>:Output <span class="sy0">+=</span> <span class="st0">&quot;<span class="es0">`t</span>&quot;</span>; <span class="re0">$tabs</span><span class="sy0">--</span>; <span class="br0">&#125;</span>
	<span class="kw3">If</span><span class="br0">&#40;</span> <span class="re0">$nonewline</span> <span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<span class="re0">$Global</span>:Output <span class="sy0">+=</span> <span class="re0">$name</span> <span class="sy0">+</span> <span class="re0">$value</span>
	<span class="br0">&#125;</span>
	<span class="kw3">Else</span>
	<span class="br0">&#123;</span>
		<span class="re0">$Global</span>:Output <span class="sy0">+=</span> <span class="re0">$name</span> <span class="sy0">+</span> <span class="re0">$value</span> <span class="sy0">+</span> <span class="re0">$newline</span>
	<span class="br0">&#125;</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw3">Function</span> WriteWordLine
<span class="co1">#Function created by Ryan Revord</span>
<span class="co1">#@rsrevord on Twitter</span>
<span class="co1">#Function created to make output to Word easy in this script</span>
<span class="co1">#updated 27-Mar-2014 to include font name, font size, italics and bold options</span>
<span class="br0">&#123;</span>
	<span class="kw3">Param</span><span class="br0">&#40;</span><span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$style</span><span class="sy0">=</span><span class="nu0">0</span><span class="sy0">,</span> 
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$tabs</span> <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">,</span> 
	<span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span><span class="re0">$name</span> <span class="sy0">=</span> <span class="st0">''</span><span class="sy0">,</span> 
	<span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span><span class="re0">$value</span> <span class="sy0">=</span> <span class="st0">''</span><span class="sy0">,</span> 
	<span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span><span class="re0">$fontName</span><span class="sy0">=</span><span class="re0">$Null</span><span class="sy0">,</span>
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$fontSize</span><span class="sy0">=</span><span class="nu0">0</span><span class="sy0">,</span>
	<span class="br0">&#91;</span><span class="re3">bool</span><span class="br0">&#93;</span><span class="re0">$italics</span><span class="sy0">=</span><span class="re0">$False</span><span class="sy0">,</span>
	<span class="br0">&#91;</span><span class="re3">bool</span><span class="br0">&#93;</span><span class="re0">$boldface</span><span class="sy0">=</span><span class="re0">$False</span><span class="sy0">,</span>
	<span class="br0">&#91;</span><span class="kw3">Switch</span><span class="br0">&#93;</span><span class="re0">$nonewline</span><span class="br0">&#41;</span>
&nbsp;
	<span class="co1">#Build output style</span>
	<span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span><span class="re0">$output</span> <span class="sy0">=</span> <span class="st0">&quot;&quot;</span>
	<span class="kw3">Switch</span> <span class="br0">&#40;</span><span class="re0">$style</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<span class="nu0">0</span> <span class="br0">&#123;</span><span class="re0">$Script</span>:Selection.Style <span class="sy0">=</span> <span class="re0">$Script</span>:MyHash.Word_NoSpacing<span class="br0">&#125;</span>
		<span class="nu0">1</span> <span class="br0">&#123;</span><span class="re0">$Script</span>:Selection.Style <span class="sy0">=</span> <span class="re0">$Script</span>:MyHash.Word_Heading1<span class="br0">&#125;</span>
		<span class="nu0">2</span> <span class="br0">&#123;</span><span class="re0">$Script</span>:Selection.Style <span class="sy0">=</span> <span class="re0">$Script</span>:MyHash.Word_Heading2<span class="br0">&#125;</span>
		<span class="nu0">3</span> <span class="br0">&#123;</span><span class="re0">$Script</span>:Selection.Style <span class="sy0">=</span> <span class="re0">$Script</span>:MyHash.Word_Heading3<span class="br0">&#125;</span>
		<span class="nu0">4</span> <span class="br0">&#123;</span><span class="re0">$Script</span>:Selection.Style <span class="sy0">=</span> <span class="re0">$Script</span>:MyHash.Word_Heading4<span class="br0">&#125;</span>
		Default <span class="br0">&#123;</span><span class="re0">$Script</span>:Selection.Style <span class="sy0">=</span> <span class="re0">$Script</span>:MyHash.Word_NoSpacing<span class="br0">&#125;</span>
	<span class="br0">&#125;</span>
&nbsp;
	<span class="co1">#build # of tabs</span>
	<span class="kw3">While</span><span class="br0">&#40;</span><span class="re0">$tabs</span> <span class="kw4">-gt</span> <span class="nu0">0</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span> 
		<span class="re0">$output</span> <span class="sy0">+=</span> <span class="st0">&quot;<span class="es0">`t</span>&quot;</span>; <span class="re0">$tabs</span><span class="sy0">--</span>; 
	<span class="br0">&#125;</span>
&nbsp;
	<span class="kw3">If</span><span class="br0">&#40;</span><span class="sy0">!</span><span class="br0">&#91;</span><span class="re3">String</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$fontName</span><span class="br0">&#41;</span><span class="br0">&#41;</span> 
	<span class="br0">&#123;</span>
		<span class="re0">$Script</span>:Selection.Font.name <span class="sy0">=</span> <span class="re0">$fontName</span>
	<span class="br0">&#125;</span> 
&nbsp;
	<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$fontSize</span> <span class="kw4">-ne</span> <span class="nu0">0</span><span class="br0">&#41;</span> 
	<span class="br0">&#123;</span>
		<span class="re0">$Script</span>:Selection.Font.size <span class="sy0">=</span> <span class="re0">$fontSize</span>
	<span class="br0">&#125;</span> 
&nbsp;
	<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$italics</span> <span class="kw4">-eq</span> <span class="re0">$True</span><span class="br0">&#41;</span> 
	<span class="br0">&#123;</span>
		<span class="re0">$Script</span>:Selection.Font.Italic <span class="sy0">=</span> <span class="re0">$True</span>
	<span class="br0">&#125;</span> 
&nbsp;
	<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$boldface</span> <span class="kw4">-eq</span> <span class="re0">$True</span><span class="br0">&#41;</span> 
	<span class="br0">&#123;</span>
		<span class="re0">$Script</span>:Selection.Font.Bold <span class="sy0">=</span> <span class="re0">$True</span>
	<span class="br0">&#125;</span> 
&nbsp;
	<span class="co1">#output the rest of the parameters.</span>
	<span class="re0">$output</span> <span class="sy0">+=</span> <span class="re0">$name</span> <span class="sy0">+</span> <span class="re0">$value</span>
	<span class="re0">$Script</span>:Selection.TypeText<span class="br0">&#40;</span><span class="re0">$output</span><span class="br0">&#41;</span>
&nbsp;
	<span class="co1">#test for new WriteWordLine 0.</span>
	<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$nonewline</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<span class="co1"># Do nothing.</span>
	<span class="br0">&#125;</span> 
	<span class="kw3">Else</span> 
	<span class="br0">&#123;</span>
		<span class="re0">$Script</span>:Selection.TypeParagraph<span class="br0">&#40;</span><span class="br0">&#41;</span>
	<span class="br0">&#125;</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="co1">#***********************************************************************************************************</span>
<span class="co1"># WriteHTMLLine</span>
<span class="co1">#***********************************************************************************************************</span>
&nbsp;
<span class="coMULTI">&lt;#
.Synopsis
	Writes a line of output for HTML output
.DESCRIPTION
	This function formats an HTML line
&nbsp;
&nbsp;
.USAGE
	WriteHTMLLine &lt;Style&gt; &lt;Tabs&gt; &lt;Name&gt; &lt;Value&gt; &lt;Font Name&gt; &lt;Font Size&gt; &lt;Options&gt;
&nbsp;
    0 for Font Size denotes using the default font size of 2 or 10 point
&nbsp;
.EXAMPLE
	WriteHTMLLine 0 0 &quot;&quot;
&nbsp;
    Writes a blank line with no style or tab stops, obviously none needed.
&nbsp;
.EXAMPLE
	WriteHTMLLine 0 1 &quot;This is a regular line of text indented 1 tab stops&quot;
&nbsp;
    Writes a line with 1 tab stop.
&nbsp;
.EXAMPLE
	WriteHTMLLine 0 0 &quot;This is a regular line of text in the default font in italics&quot; &quot;&quot; $null 0 $htmlitalics
&nbsp;
    Writes a line omitting font and font size and setting the italics attribute
&nbsp;
.EXAMPLE
	WriteHTMLLine 0 0 &quot;This is a regular line of text in the default font in bold&quot; &quot;&quot; $null 0 $htmlbold
&nbsp;
    Writes a line omitting font and font size and setting the bold attribute
&nbsp;
.EXAMPLE
	WriteHTMLLine 0 0 &quot;This is a regular line of text in the default font in bold italics&quot; &quot;&quot; $null 0 ($htmlbold -bor $htmlitalics)
&nbsp;
    Writes a line omitting font and font size and setting both italics and bold options
&nbsp;
.EXAMPLE	
    WriteHTMLLine 0 0 &quot;This is a regular line of text in the default font in 10 point&quot; &quot;&quot; $null 2  # 10 point font
&nbsp;
    Writes a line using 10 point font
&nbsp;
.EXAMPLE
	WriteHTMLLine 0 0 &quot;This is a regular line of text in Courier New font&quot; &quot;&quot; &quot;Courier New&quot; 0 
&nbsp;
	Writes a line using Courier New Font and 0 font point size (default = 2 if set to 0)
&nbsp;
.EXAMPLE	
	WriteHTMLLine 0 0 &quot;This is a regular line of RED text indented 0 tab stops with the computer name as data in 10 point Courier New bold italics: &quot; $env:computername &quot;Courier New&quot; 2 ($htmlbold -bor $htmlred -bor $htmlitalics)
&nbsp;
    Writes a line using Courier New Font with first and second string values to be used, also uses 10 point font with bold, italics and red color options set.
&nbsp;
.NOTES
&nbsp;
    Font Size - Unlike word, there is a limited set of font sizes that can be used in HTML.  They are:
        0 - default which actually gives it a 2 or 10 point.
        1 - 7.5 point font size
        2 - 10 point
        3 - 13.5 point
        4 - 15 point
        5 - 18 point
        6 - 24 point
        7 - 36 point
            Any number larger than 7 defaults to 7
&nbsp;
    Style - Refers to the headers that are used with output and resemble the headers in word, HTML supports headers h1-h6 and h1-h4 are more commonly used.  Unlike word, H1 will not give you
    a blue colored font, you will have to set that yourself.
&nbsp;
    Colors and Bold/Italics Flags are:
&nbsp;
        htmlbold       
        htmlitalics    
        htmlred        
        htmlcyan        
        htmlblue       
        htmldarkblue   
        htmllightblue   
        htmlpurple      
        htmlyellow      
        htmllime       
        htmlmagenta     
        htmlwhite       
        htmlsilver      
        htmlgray       
        htmlolive       
        htmlorange      
        htmlmaroon      
        htmlgreen       
        htmlblack       
&nbsp;
&nbsp;
&nbsp;
&nbsp;
#&gt;</span>
&nbsp;
<span class="kw3">Function</span> WriteHTMLLine
<span class="co1">#Function created by Ken Avram</span>
<span class="co1">#Function created to make output to HTML easy in this script</span>
<span class="br0">&#123;</span>
	<span class="kw3">Param</span><span class="br0">&#40;</span><span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$style</span><span class="sy0">=</span><span class="nu0">0</span><span class="sy0">,</span> 
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$tabs</span> <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">,</span> 
	<span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span><span class="re0">$name</span> <span class="sy0">=</span> <span class="st0">''</span><span class="sy0">,</span> 
	<span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span><span class="re0">$value</span> <span class="sy0">=</span> <span class="st0">''</span><span class="sy0">,</span> 
    <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span><span class="re0">$fontName</span><span class="sy0">=</span><span class="st0">&quot;Calibri&quot;</span><span class="sy0">,</span>
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$fontSize</span><span class="sy0">=</span><span class="nu0">1</span><span class="sy0">,</span>
	<span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$options</span><span class="sy0">=</span><span class="re0">$htmlblack</span><span class="br0">&#41;</span>
&nbsp;
&nbsp;
	<span class="co1">#Build output style</span>
	<span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span><span class="re0">$output</span> <span class="sy0">=</span> <span class="st0">&quot;&quot;</span>
&nbsp;
    <span class="kw3">If</span><span class="br0">&#40;</span><span class="br0">&#91;</span><span class="re3">String</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$Name</span><span class="br0">&#41;</span><span class="br0">&#41;</span>	
    <span class="br0">&#123;</span>
        <span class="re0">$HTMLBody</span> <span class="sy0">=</span> <span class="st0">&quot;&lt;p&gt;&lt;/p&gt;&quot;</span>
    <span class="br0">&#125;</span>
    <span class="kw3">Else</span>
        <span class="br0">&#123;</span>
&nbsp;
        <span class="re0">$color</span> <span class="sy0">=</span> CheckHTMLColor <span class="re0">$options</span>
&nbsp;
	    <span class="co1">#build # of tabs</span>
&nbsp;
	    <span class="kw3">While</span><span class="br0">&#40;</span><span class="re0">$tabs</span> <span class="kw4">-gt</span> <span class="nu0">0</span><span class="br0">&#41;</span>
	    <span class="br0">&#123;</span> 
		    <span class="re0">$output</span> <span class="sy0">+=</span> <span class="st0">&quot;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&quot;</span>; <span class="re0">$tabs</span><span class="sy0">--</span>; 
	    <span class="br0">&#125;</span>
&nbsp;
	    <span class="re0">$HTMLFontName</span> <span class="sy0">=</span> <span class="re0">$fontName</span>		
&nbsp;
        <span class="re0">$HTMLBody</span> <span class="sy0">=</span> <span class="st0">&quot;&quot;</span>
&nbsp;
	    <span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$options</span> <span class="kw4">-band</span> <span class="re0">$htmlitalics</span><span class="br0">&#41;</span> 
	    <span class="br0">&#123;</span>
		    <span class="re0">$HTMLBody</span> <span class="sy0">+=</span> <span class="st0">&quot;&lt;i&gt;&quot;</span>
	    <span class="br0">&#125;</span> 
&nbsp;
	    <span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$options</span> <span class="kw4">-band</span> <span class="re0">$htmlbold</span><span class="br0">&#41;</span> 
	    <span class="br0">&#123;</span>
		    <span class="re0">$HTMLBody</span> <span class="sy0">+=</span> <span class="st0">&quot;&lt;b&gt;&quot;</span>
	    <span class="br0">&#125;</span> 
&nbsp;
	    <span class="co1">#output the rest of the parameters.</span>
	    <span class="re0">$output</span> <span class="sy0">+=</span> <span class="re0">$name</span> <span class="sy0">+</span> <span class="re0">$value</span>
&nbsp;
&nbsp;
        <span class="re0">$HTMLBody</span> <span class="sy0">+=</span> <span class="st0">&quot;&lt;font face='&quot;</span> <span class="sy0">+</span> <span class="re0">$HTMLFontName</span> <span class="sy0">+</span> <span class="st0">&quot;' &quot;</span> <span class="sy0">+</span> <span class="st0">&quot;color='&quot;</span> <span class="sy0">+</span> <span class="re0">$color</span> <span class="sy0">+</span> <span class="st0">&quot;' size='&quot;</span>  <span class="sy0">+</span> <span class="re0">$fontsize</span> <span class="sy0">+</span> <span class="st0">&quot;'&gt;&quot;</span>
        <span class="kw3">Switch</span> <span class="br0">&#40;</span><span class="re0">$style</span><span class="br0">&#41;</span>
	    <span class="br0">&#123;</span>
&nbsp;
		    <span class="nu0">1</span> <span class="br0">&#123;</span><span class="re0">$HTMLStyle</span> <span class="sy0">=</span> <span class="st0">&quot;&lt;h1&gt;&quot;</span><span class="br0">&#125;</span>
		    <span class="nu0">2</span> <span class="br0">&#123;</span><span class="re0">$HTMLStyle</span> <span class="sy0">=</span> <span class="st0">&quot;&lt;h2&gt;&quot;</span><span class="br0">&#125;</span>
		    <span class="nu0">3</span> <span class="br0">&#123;</span><span class="re0">$HTMLStyle</span> <span class="sy0">=</span> <span class="st0">&quot;&lt;h3&gt;&quot;</span><span class="br0">&#125;</span>
		    <span class="nu0">4</span> <span class="br0">&#123;</span><span class="re0">$HTMLStyle</span> <span class="sy0">=</span> <span class="st0">&quot;&lt;h4&gt;&quot;</span><span class="br0">&#125;</span>
		    Default <span class="br0">&#123;</span><span class="re0">$HTMLStyle</span> <span class="sy0">=</span> <span class="st0">&quot;&quot;</span><span class="br0">&#125;</span>
	    <span class="br0">&#125;</span>
&nbsp;
        <span class="re0">$HTMLBody</span> <span class="sy0">+=</span> <span class="re0">$HTMLStyle</span> <span class="sy0">+</span> <span class="re0">$output</span>
&nbsp;
        <span class="kw3">Switch</span> <span class="br0">&#40;</span><span class="re0">$style</span><span class="br0">&#41;</span>
	    <span class="br0">&#123;</span>
&nbsp;
		    <span class="nu0">1</span> <span class="br0">&#123;</span><span class="re0">$HTMLStyle</span> <span class="sy0">=</span> <span class="st0">&quot;&lt;/h1&gt;&quot;</span><span class="br0">&#125;</span>
		    <span class="nu0">2</span> <span class="br0">&#123;</span><span class="re0">$HTMLStyle</span> <span class="sy0">=</span> <span class="st0">&quot;&lt;/h2&gt;&quot;</span><span class="br0">&#125;</span>
		    <span class="nu0">3</span> <span class="br0">&#123;</span><span class="re0">$HTMLStyle</span> <span class="sy0">=</span> <span class="st0">&quot;&lt;/h3&gt;&quot;</span><span class="br0">&#125;</span>
		    <span class="nu0">4</span> <span class="br0">&#123;</span><span class="re0">$HTMLStyle</span> <span class="sy0">=</span> <span class="st0">&quot;&lt;/h4&gt;&quot;</span><span class="br0">&#125;</span>
		    Default <span class="br0">&#123;</span><span class="re0">$HTMLStyle</span> <span class="sy0">=</span> <span class="st0">&quot;&quot;</span><span class="br0">&#125;</span>
	    <span class="br0">&#125;</span>
&nbsp;
        <span class="re0">$HTMLBody</span> <span class="sy0">+=</span> <span class="re0">$HTMLStyle</span> <span class="sy0">+</span>  <span class="st0">&quot;&lt;/font&gt;&quot;</span>
&nbsp;
        <span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$options</span> <span class="kw4">-band</span> <span class="re0">$htmlitalics</span><span class="br0">&#41;</span> 
	    <span class="br0">&#123;</span>
		    <span class="re0">$HTMLBody</span> <span class="sy0">+=</span> <span class="st0">&quot;&lt;/i&gt;&quot;</span>
	    <span class="br0">&#125;</span> 
&nbsp;
	    <span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$options</span> <span class="kw4">-band</span> <span class="re0">$htmlbold</span><span class="br0">&#41;</span> 
	    <span class="br0">&#123;</span>
		    <span class="re0">$HTMLBody</span> <span class="sy0">+=</span> <span class="st0">&quot;&lt;/b&gt;&quot;</span>
	    <span class="br0">&#125;</span> 
	<span class="br0">&#125;</span>
&nbsp;
	<span class="co1">#echo $HTMLBody &gt;&gt; $FileName1</span>
	<span class="kw1">out<span class="kw4">-file</span></span> <span class="kw5">-FilePath</span> <span class="re0">$Script</span>:FileName1 <span class="kw5">-Append</span> <span class="kw5">-InputObject</span> <span class="re0">$HTMLBody</span> <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
<span class="br0">&#125;</span>
<span class="co1">#endregion</span>
&nbsp;
<span class="co1">#region Iain's Word table functions</span>
&nbsp;
<span class="coMULTI">&lt;#
.Synopsis
	Add a table to a Microsoft Word document
.DESCRIPTION
	This function adds a table to a Microsoft Word document from either an array of
	Hashtables or an array of PSCustomObjects.
&nbsp;
	Using this function is quicker than setting each table cell individually but can
	only utilise the built-in MS Word table autoformats. Individual tables cells can
	be altered after the table has been appended to the document (a table reference
	is returned).
.EXAMPLE
	AddWordTable -Hashtable $HashtableArray
&nbsp;
	This example adds table to the MS Word document, utilising all key/value pairs in
	the array of hashtables. Column headers will display the key names as defined.
	Note: the columns might not be displayed in the order that they were defined. To
	ensure columns are displayed in the required order utilise the -Columns parameter.
.EXAMPLE
	AddWordTable -Hashtable $HashtableArray -List
&nbsp;
	This example adds table to the MS Word document, utilising all key/value pairs in
	the array of hashtables. No column headers will be added, in a ListView format.
	Note: the columns might not be displayed in the order that they were defined. To
	ensure columns are displayed in the required order utilise the -Columns parameter.
.EXAMPLE
	AddWordTable -CustomObject $PSCustomObjectArray
&nbsp;
	This example adds table to the MS Word document, utilising all note property names
	the array of PSCustomObjects. Column headers will display the note property names.
	Note: the columns might not be displayed in the order that they were defined. To
	ensure columns are displayed in the required order utilise the -Columns parameter.
.EXAMPLE
	AddWordTable -Hashtable $HashtableArray -Columns FirstName,LastName,EmailAddress
&nbsp;
	This example adds a table to the MS Word document, but only using the specified
	key names: FirstName, LastName and EmailAddress. If other keys are present in the
	array of Hashtables they will be ignored.
.EXAMPLE
	AddWordTable -CustomObject $PSCustomObjectArray -Columns FirstName,LastName,EmailAddress -Headers &quot;First Name&quot;,&quot;Last Name&quot;,&quot;Email Address&quot;
&nbsp;
	This example adds a table to the MS Word document, but only using the specified
	PSCustomObject note properties: FirstName, LastName and EmailAddress. If other note
	properties are present in the array of PSCustomObjects they will be ignored. The
	display names for each specified column header has been overridden to display a
	custom header. Note: the order of the header names must match the specified columns.
#&gt;</span>
&nbsp;
<span class="kw3">Function</span> AddWordTable
<span class="br0">&#123;</span>
	<span class="br0">&#91;</span>CmdletBinding<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#93;</span>
	<span class="kw3">Param</span>
	<span class="br0">&#40;</span>
		<span class="co1"># Array of Hashtable (including table headers)</span>
		<span class="br0">&#91;</span>Parameter<span class="br0">&#40;</span>Mandatory<span class="sy0">=</span><span class="re0">$True</span><span class="sy0">,</span> ValueFromPipelineByPropertyName<span class="sy0">=</span><span class="re0">$True</span><span class="sy0">,</span> ParameterSetName<span class="sy0">=</span><span class="st0">'Hashtable'</span><span class="sy0">,</span> Position<span class="sy0">=</span><span class="nu0">0</span><span class="br0">&#41;</span><span class="br0">&#93;</span>
		<span class="br0">&#91;</span>ValidateNotNullOrEmpty<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#93;</span> <span class="br0">&#91;</span>System.Collections.Hashtable<span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#93;</span> <span class="re0">$Hashtable</span><span class="sy0">,</span>
		<span class="co1"># Array of PSCustomObjects</span>
		<span class="br0">&#91;</span>Parameter<span class="br0">&#40;</span>Mandatory<span class="sy0">=</span><span class="re0">$True</span><span class="sy0">,</span> ValueFromPipelineByPropertyName<span class="sy0">=</span><span class="re0">$True</span><span class="sy0">,</span> ParameterSetName<span class="sy0">=</span><span class="st0">'CustomObject'</span><span class="sy0">,</span> Position<span class="sy0">=</span><span class="nu0">0</span><span class="br0">&#41;</span><span class="br0">&#93;</span>
		<span class="br0">&#91;</span>ValidateNotNullOrEmpty<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#93;</span> <span class="br0">&#91;</span>PSCustomObject<span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#93;</span> <span class="re0">$CustomObject</span><span class="sy0">,</span>
		<span class="co1"># Array of Hashtable key names or PSCustomObject property names to include, in display order.</span>
		<span class="co1"># If not supplied then all Hashtable keys or all PSCustomObject properties will be displayed.</span>
		<span class="br0">&#91;</span>Parameter<span class="br0">&#40;</span>ValueFromPipelineByPropertyName<span class="sy0">=</span><span class="re0">$True</span><span class="br0">&#41;</span><span class="br0">&#93;</span> <span class="br0">&#91;</span>AllowNull<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#93;</span> <span class="re0">$Columns</span> <span class="sy0">=</span> <span class="re0">$Null</span><span class="sy0">,</span>
		<span class="co1"># Array of custom table header strings in display order.</span>
		<span class="br0">&#91;</span>Parameter<span class="br0">&#40;</span>ValueFromPipelineByPropertyName<span class="sy0">=</span><span class="re0">$True</span><span class="br0">&#41;</span><span class="br0">&#93;</span> <span class="br0">&#91;</span>AllowNull<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#93;</span> <span class="re0">$Headers</span> <span class="sy0">=</span> <span class="re0">$Null</span><span class="sy0">,</span>
		<span class="co1"># AutoFit table behavior.</span>
		<span class="br0">&#91;</span>Parameter<span class="br0">&#40;</span>ValueFromPipelineByPropertyName<span class="sy0">=</span><span class="re0">$True</span><span class="br0">&#41;</span><span class="br0">&#93;</span> <span class="br0">&#91;</span>AllowNull<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span> <span class="re0">$AutoFit</span> <span class="sy0">=</span> <span class="sy0">-</span><span class="nu0">1</span><span class="sy0">,</span>
		<span class="co1"># List view (no headers)</span>
		<span class="br0">&#91;</span><span class="kw3">Switch</span><span class="br0">&#93;</span> <span class="re0">$List</span><span class="sy0">,</span>
		<span class="co1"># Grid lines</span>
		<span class="br0">&#91;</span><span class="kw3">Switch</span><span class="br0">&#93;</span> <span class="re0">$NoGridLines</span><span class="sy0">,</span>
		<span class="br0">&#91;</span><span class="kw3">Switch</span><span class="br0">&#93;</span> <span class="re0">$NoInternalGridLines</span><span class="sy0">,</span>
		<span class="co1"># Built-in Word table formatting style constant</span>
		<span class="co1"># Would recommend only $wdTableFormatContempory for normal usage (possibly $wdTableFormatList5 for List view)</span>
		<span class="br0">&#91;</span>Parameter<span class="br0">&#40;</span>ValueFromPipelineByPropertyName<span class="sy0">=</span><span class="re0">$True</span><span class="br0">&#41;</span><span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span> <span class="re0">$Format</span> <span class="sy0">=</span> <span class="nu0">0</span>
	<span class="br0">&#41;</span>
&nbsp;
	Begin 
	<span class="br0">&#123;</span>
		<span class="kw1">Write-Debug</span> <span class="br0">&#40;</span><span class="st0">&quot;Using parameter set '{0}'&quot;</span> <span class="kw4">-f</span> <span class="re0">$PSCmdlet</span>.ParameterSetName<span class="br0">&#41;</span>;
		<span class="co1">## Check if -Columns wasn't specified but -Headers were (saves some additional parameter sets!)</span>
		<span class="kw3">If</span><span class="br0">&#40;</span><span class="br0">&#40;</span><span class="re0">$Columns</span> <span class="kw4">-eq</span> <span class="re0">$Null</span><span class="br0">&#41;</span> <span class="kw4">-and</span> <span class="br0">&#40;</span><span class="re0">$Headers</span> <span class="kw4">-ne</span> <span class="re0">$Null</span><span class="br0">&#41;</span><span class="br0">&#41;</span> 
		<span class="br0">&#123;</span>
			<span class="kw1">Write-Warning</span> <span class="st0">&quot;No columns specified and therefore, specified headers will be ignored.&quot;</span>;
			<span class="re0">$Columns</span> <span class="sy0">=</span> <span class="re0">$Null</span>;
		<span class="br0">&#125;</span>
		<span class="kw3">ElseIf</span><span class="br0">&#40;</span><span class="br0">&#40;</span><span class="re0">$Columns</span> <span class="kw4">-ne</span> <span class="re0">$Null</span><span class="br0">&#41;</span> <span class="kw4">-and</span> <span class="br0">&#40;</span><span class="re0">$Headers</span> <span class="kw4">-ne</span> <span class="re0">$Null</span><span class="br0">&#41;</span><span class="br0">&#41;</span> 
		<span class="br0">&#123;</span>
			<span class="co1">## Check if number of specified -Columns matches number of specified -Headers</span>
			<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$Columns</span>.Length <span class="kw4">-ne</span> <span class="re0">$Headers</span>.Length<span class="br0">&#41;</span> 
			<span class="br0">&#123;</span>
				<span class="kw1">Write-Error</span> <span class="st0">&quot;The specified number of columns does not match the specified number of headers.&quot;</span>;
			<span class="br0">&#125;</span>
		<span class="br0">&#125;</span> <span class="co1">## end elseif</span>
	<span class="br0">&#125;</span> <span class="co1">## end Begin</span>
&nbsp;
	Process
	<span class="br0">&#123;</span>
		<span class="co1">## Build the Word table data string to be converted to a range and then a table later.</span>
		<span class="br0">&#91;</span>System.Text.StringBuilder<span class="br0">&#93;</span> <span class="re0">$WordRangeString</span> <span class="sy0">=</span> <span class="kw1">New-Object</span> System.Text.StringBuilder;
&nbsp;
		<span class="kw3">Switch</span> <span class="br0">&#40;</span><span class="re0">$PSCmdlet</span>.ParameterSetName<span class="br0">&#41;</span> 
		<span class="br0">&#123;</span>
			<span class="st0">'CustomObject'</span> 
			<span class="br0">&#123;</span>
				<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$Columns</span> <span class="kw4">-eq</span> <span class="re0">$Null</span><span class="br0">&#41;</span> 
				<span class="br0">&#123;</span>
					<span class="co1">## Build the available columns from all availble PSCustomObject note properties</span>
					<span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#93;</span> <span class="re0">$Columns</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
					<span class="co1">## Add each NoteProperty name to the array</span>
					<span class="kw3">ForEach</span><span class="br0">&#40;</span><span class="re0">$Property</span> <span class="kw3">in</span> <span class="br0">&#40;</span><span class="re0">$CustomObject</span> <span class="sy0">|</span> <span class="kw1">Get-Member</span> <span class="kw5">-MemberType</span> NoteProperty<span class="br0">&#41;</span><span class="br0">&#41;</span> 
					<span class="br0">&#123;</span> 
						<span class="re0">$Columns</span> <span class="sy0">+=</span> <span class="re0">$Property</span>.Name; 
					<span class="br0">&#125;</span>
				<span class="br0">&#125;</span>
&nbsp;
				<span class="co1">## Add the table headers from -Headers or -Columns (except when in -List(view)</span>
				<span class="kw3">If</span><span class="br0">&#40;</span><span class="kw4">-not</span> <span class="re0">$List</span><span class="br0">&#41;</span> 
				<span class="br0">&#123;</span>
					<span class="kw1">Write-Debug</span> <span class="br0">&#40;</span><span class="st0">&quot;$(Get-Date): <span class="es0">`t</span><span class="es0">`t</span>Building table headers&quot;</span><span class="br0">&#41;</span>;
					<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$Headers</span> <span class="kw4">-ne</span> <span class="re0">$Null</span><span class="br0">&#41;</span> 
					<span class="br0">&#123;</span>
                        <span class="br0">&#91;</span><span class="re3">ref</span><span class="br0">&#93;</span> <span class="re0">$Null</span> <span class="sy0">=</span> <span class="re0">$WordRangeString</span>.AppendFormat<span class="br0">&#40;</span><span class="st0">&quot;{0}<span class="es0">`n</span>&quot;</span><span class="sy0">,</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::Join<span class="br0">&#40;</span><span class="st0">&quot;<span class="es0">`t</span>&quot;</span><span class="sy0">,</span> <span class="re0">$Headers</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
					<span class="br0">&#125;</span>
					<span class="kw3">Else</span> 
					<span class="br0">&#123;</span> 
                        <span class="br0">&#91;</span><span class="re3">ref</span><span class="br0">&#93;</span> <span class="re0">$Null</span> <span class="sy0">=</span> <span class="re0">$WordRangeString</span>.AppendFormat<span class="br0">&#40;</span><span class="st0">&quot;{0}<span class="es0">`n</span>&quot;</span><span class="sy0">,</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::Join<span class="br0">&#40;</span><span class="st0">&quot;<span class="es0">`t</span>&quot;</span><span class="sy0">,</span> <span class="re0">$Columns</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
					<span class="br0">&#125;</span>
				<span class="br0">&#125;</span>
&nbsp;
				<span class="co1">## Iterate through each PSCustomObject</span>
				<span class="kw1">Write-Debug</span> <span class="br0">&#40;</span><span class="st0">&quot;$(Get-Date): <span class="es0">`t</span><span class="es0">`t</span>Building table rows&quot;</span><span class="br0">&#41;</span>;
				<span class="kw3">ForEach</span><span class="br0">&#40;</span><span class="re0">$Object</span> <span class="kw3">in</span> <span class="re0">$CustomObject</span><span class="br0">&#41;</span> 
				<span class="br0">&#123;</span>
					<span class="re0">$OrderedValues</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
					<span class="co1">## Add each row item in the specified order</span>
					<span class="kw3">ForEach</span><span class="br0">&#40;</span><span class="re0">$Column</span> <span class="kw3">in</span> <span class="re0">$Columns</span><span class="br0">&#41;</span> 
					<span class="br0">&#123;</span> 
						<span class="re0">$OrderedValues</span> <span class="sy0">+=</span> <span class="re0">$Object</span>.<span class="re0">$Column</span>; 
					<span class="br0">&#125;</span>
					<span class="co1">## Use the ordered list to add each column in specified order</span>
					<span class="br0">&#91;</span><span class="re3">ref</span><span class="br0">&#93;</span> <span class="re0">$Null</span> <span class="sy0">=</span> <span class="re0">$WordRangeString</span>.AppendFormat<span class="br0">&#40;</span><span class="st0">&quot;{0}<span class="es0">`n</span>&quot;</span><span class="sy0">,</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::Join<span class="br0">&#40;</span><span class="st0">&quot;<span class="es0">`t</span>&quot;</span><span class="sy0">,</span> <span class="re0">$OrderedValues</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
				<span class="br0">&#125;</span> <span class="co1">## end foreach</span>
				<span class="kw1">Write-Debug</span> <span class="br0">&#40;</span><span class="st0">&quot;$(Get-Date): <span class="es0">`t</span><span class="es0">`t</span><span class="es0">`t</span>Added '{0}' table rows&quot;</span> <span class="kw4">-f</span> <span class="br0">&#40;</span><span class="re0">$CustomObject</span>.Count<span class="br0">&#41;</span><span class="br0">&#41;</span>;
			<span class="br0">&#125;</span> <span class="co1">## end CustomObject</span>
&nbsp;
			Default 
			<span class="br0">&#123;</span>   <span class="co1">## Hashtable</span>
				<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$Columns</span> <span class="kw4">-eq</span> <span class="re0">$Null</span><span class="br0">&#41;</span> 
				<span class="br0">&#123;</span>
					<span class="co1">## Build the available columns from all available hashtable keys. Hopefully</span>
					<span class="co1">## all Hashtables have the same keys (they should for a table).</span>
					<span class="re0">$Columns</span> <span class="sy0">=</span> <span class="re0">$Hashtable</span><span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span>.Keys;
				<span class="br0">&#125;</span>
&nbsp;
				<span class="co1">## Add the table headers from -Headers or -Columns (except when in -List(view)</span>
				<span class="kw3">If</span><span class="br0">&#40;</span><span class="kw4">-not</span> <span class="re0">$List</span><span class="br0">&#41;</span> 
				<span class="br0">&#123;</span>
					<span class="kw1">Write-Debug</span> <span class="br0">&#40;</span><span class="st0">&quot;$(Get-Date): <span class="es0">`t</span><span class="es0">`t</span>Building table headers&quot;</span><span class="br0">&#41;</span>;
					<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$Headers</span> <span class="kw4">-ne</span> <span class="re0">$Null</span><span class="br0">&#41;</span> 
					<span class="br0">&#123;</span> 
						<span class="br0">&#91;</span><span class="re3">ref</span><span class="br0">&#93;</span> <span class="re0">$Null</span> <span class="sy0">=</span> <span class="re0">$WordRangeString</span>.AppendFormat<span class="br0">&#40;</span><span class="st0">&quot;{0}<span class="es0">`n</span>&quot;</span><span class="sy0">,</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::Join<span class="br0">&#40;</span><span class="st0">&quot;<span class="es0">`t</span>&quot;</span><span class="sy0">,</span> <span class="re0">$Headers</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
					<span class="br0">&#125;</span>
					<span class="kw3">Else</span> 
					<span class="br0">&#123;</span>
						<span class="br0">&#91;</span><span class="re3">ref</span><span class="br0">&#93;</span> <span class="re0">$Null</span> <span class="sy0">=</span> <span class="re0">$WordRangeString</span>.AppendFormat<span class="br0">&#40;</span><span class="st0">&quot;{0}<span class="es0">`n</span>&quot;</span><span class="sy0">,</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::Join<span class="br0">&#40;</span><span class="st0">&quot;<span class="es0">`t</span>&quot;</span><span class="sy0">,</span> <span class="re0">$Columns</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
					<span class="br0">&#125;</span>
				<span class="br0">&#125;</span>
&nbsp;
				<span class="co1">## Iterate through each Hashtable</span>
				<span class="kw1">Write-Debug</span> <span class="br0">&#40;</span><span class="st0">&quot;$(Get-Date): <span class="es0">`t</span><span class="es0">`t</span>Building table rows&quot;</span><span class="br0">&#41;</span>;
				<span class="kw3">ForEach</span><span class="br0">&#40;</span><span class="re0">$Hash</span> <span class="kw3">in</span> <span class="re0">$Hashtable</span><span class="br0">&#41;</span> 
				<span class="br0">&#123;</span>
					<span class="re0">$OrderedValues</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
					<span class="co1">## Add each row item in the specified order</span>
					<span class="kw3">ForEach</span><span class="br0">&#40;</span><span class="re0">$Column</span> <span class="kw3">in</span> <span class="re0">$Columns</span><span class="br0">&#41;</span> 
					<span class="br0">&#123;</span> 
						<span class="re0">$OrderedValues</span> <span class="sy0">+=</span> <span class="re0">$Hash</span>.<span class="re0">$Column</span>; 
					<span class="br0">&#125;</span>
					<span class="co1">## Use the ordered list to add each column in specified order</span>
					<span class="br0">&#91;</span><span class="re3">ref</span><span class="br0">&#93;</span> <span class="re0">$Null</span> <span class="sy0">=</span> <span class="re0">$WordRangeString</span>.AppendFormat<span class="br0">&#40;</span><span class="st0">&quot;{0}<span class="es0">`n</span>&quot;</span><span class="sy0">,</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::Join<span class="br0">&#40;</span><span class="st0">&quot;<span class="es0">`t</span>&quot;</span><span class="sy0">,</span> <span class="re0">$OrderedValues</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
				<span class="br0">&#125;</span> <span class="co1">## end foreach</span>
&nbsp;
				<span class="kw1">Write-Debug</span> <span class="br0">&#40;</span><span class="st0">&quot;$(Get-Date): <span class="es0">`t</span><span class="es0">`t</span><span class="es0">`t</span>Added '{0}' table rows&quot;</span> <span class="kw4">-f</span> <span class="re0">$Hashtable</span>.Count<span class="br0">&#41;</span>;
			<span class="br0">&#125;</span> <span class="co1">## end default</span>
		<span class="br0">&#125;</span> <span class="co1">## end switch</span>
&nbsp;
		<span class="co1">## Create a MS Word range and set its text to our tab-delimited, concatenated string</span>
		<span class="kw1">Write-Debug</span> <span class="br0">&#40;</span><span class="st0">&quot;$(Get-Date): <span class="es0">`t</span><span class="es0">`t</span>Building table range&quot;</span><span class="br0">&#41;</span>;
		<span class="re0">$WordRange</span> <span class="sy0">=</span> <span class="re0">$Script</span>:Doc.Application.Selection.Range;
		<span class="re0">$WordRange</span>.Text <span class="sy0">=</span> <span class="re0">$WordRangeString</span>.ToString<span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
		<span class="co1">## Create hash table of named arguments to pass to the ConvertToTable method</span>
		<span class="re0">$ConvertToTableArguments</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#123;</span> Separator <span class="sy0">=</span> <span class="br0">&#91;</span>Microsoft.Office.Interop.Word.WdTableFieldSeparator<span class="br0">&#93;</span>::wdSeparateByTabs; <span class="br0">&#125;</span>
&nbsp;
		<span class="co1">## Negative built-in styles are not supported by the ConvertToTable method</span>
		<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$Format</span> <span class="kw4">-ge</span> <span class="nu0">0</span><span class="br0">&#41;</span> 
		<span class="br0">&#123;</span>
			<span class="re0">$ConvertToTableArguments</span>.Add<span class="br0">&#40;</span><span class="st0">&quot;Format&quot;</span><span class="sy0">,</span> <span class="re0">$Format</span><span class="br0">&#41;</span>;
			<span class="re0">$ConvertToTableArguments</span>.Add<span class="br0">&#40;</span><span class="st0">&quot;ApplyBorders&quot;</span><span class="sy0">,</span> <span class="re0">$True</span><span class="br0">&#41;</span>;
			<span class="re0">$ConvertToTableArguments</span>.Add<span class="br0">&#40;</span><span class="st0">&quot;ApplyShading&quot;</span><span class="sy0">,</span> <span class="re0">$True</span><span class="br0">&#41;</span>;
			<span class="re0">$ConvertToTableArguments</span>.Add<span class="br0">&#40;</span><span class="st0">&quot;ApplyFont&quot;</span><span class="sy0">,</span> <span class="re0">$True</span><span class="br0">&#41;</span>;
			<span class="re0">$ConvertToTableArguments</span>.Add<span class="br0">&#40;</span><span class="st0">&quot;ApplyColor&quot;</span><span class="sy0">,</span> <span class="re0">$True</span><span class="br0">&#41;</span>;
			<span class="kw3">If</span><span class="br0">&#40;</span><span class="sy0">!</span><span class="re0">$List</span><span class="br0">&#41;</span> 
			<span class="br0">&#123;</span> 
				<span class="re0">$ConvertToTableArguments</span>.Add<span class="br0">&#40;</span><span class="st0">&quot;ApplyHeadingRows&quot;</span><span class="sy0">,</span> <span class="re0">$True</span><span class="br0">&#41;</span>; 
			<span class="br0">&#125;</span>
			<span class="re0">$ConvertToTableArguments</span>.Add<span class="br0">&#40;</span><span class="st0">&quot;ApplyLastRow&quot;</span><span class="sy0">,</span> <span class="re0">$True</span><span class="br0">&#41;</span>;
			<span class="re0">$ConvertToTableArguments</span>.Add<span class="br0">&#40;</span><span class="st0">&quot;ApplyFirstColumn&quot;</span><span class="sy0">,</span> <span class="re0">$True</span><span class="br0">&#41;</span>;
			<span class="re0">$ConvertToTableArguments</span>.Add<span class="br0">&#40;</span><span class="st0">&quot;ApplyLastColumn&quot;</span><span class="sy0">,</span> <span class="re0">$True</span><span class="br0">&#41;</span>;
		<span class="br0">&#125;</span>
&nbsp;
		<span class="co1">## Invoke ConvertToTable method - with named arguments - to convert Word range to a table</span>
		<span class="co1">## See http://msdn.microsoft.com/en-us/library/office/aa171893(v=office.11).aspx</span>
		<span class="kw1">Write-Debug</span> <span class="br0">&#40;</span><span class="st0">&quot;$(Get-Date): <span class="es0">`t</span><span class="es0">`t</span>Converting range to table&quot;</span><span class="br0">&#41;</span>;
		<span class="co1">## Store the table reference just in case we need to set alternate row coloring</span>
		<span class="re0">$WordTable</span> <span class="sy0">=</span> <span class="re0">$WordRange</span>.GetType<span class="br0">&#40;</span><span class="br0">&#41;</span>.InvokeMember<span class="br0">&#40;</span>
			<span class="st0">&quot;ConvertToTable&quot;</span><span class="sy0">,</span>                               <span class="co1"># Method name</span>
			<span class="br0">&#91;</span>System.Reflection.BindingFlags<span class="br0">&#93;</span>::InvokeMethod<span class="sy0">,</span> <span class="co1"># Flags</span>
			<span class="re0">$Null</span><span class="sy0">,</span>                                          <span class="co1"># Binder</span>
			<span class="re0">$WordRange</span><span class="sy0">,</span>                                     <span class="co1"># Target (self!)</span>
			<span class="br0">&#40;</span><span class="br0">&#91;</span><span class="re3">Object</span><span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="re0">$ConvertToTableArguments</span>.Values<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">,</span>  <span class="co1">## Named argument values</span>
			<span class="re0">$Null</span><span class="sy0">,</span>                                          <span class="co1"># Modifiers</span>
			<span class="re0">$Null</span><span class="sy0">,</span>                                          <span class="co1"># Culture</span>
			<span class="br0">&#40;</span><span class="br0">&#91;</span><span class="re3">String</span><span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#93;</span><span class="br0">&#40;</span><span class="re0">$ConvertToTableArguments</span>.Keys<span class="br0">&#41;</span><span class="br0">&#41;</span>     <span class="co1">## Named argument names</span>
		<span class="br0">&#41;</span>;
&nbsp;
		<span class="co1">## Implement grid lines (will wipe out any existing formatting</span>
		<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$Format</span> <span class="kw4">-lt</span> <span class="nu0">0</span><span class="br0">&#41;</span> 
		<span class="br0">&#123;</span>
			<span class="kw1">Write-Debug</span> <span class="br0">&#40;</span><span class="st0">&quot;$(Get-Date): <span class="es0">`t</span><span class="es0">`t</span>Setting table format&quot;</span><span class="br0">&#41;</span>;
			<span class="re0">$WordTable</span>.Style <span class="sy0">=</span> <span class="re0">$Format</span>;
		<span class="br0">&#125;</span>
&nbsp;
		<span class="co1">## Set the table autofit behavior</span>
		<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$AutoFit</span> <span class="kw4">-ne</span> <span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span> 
		<span class="br0">&#123;</span> 
			<span class="re0">$WordTable</span>.AutoFitBehavior<span class="br0">&#40;</span><span class="re0">$AutoFit</span><span class="br0">&#41;</span>; 
		<span class="br0">&#125;</span>
&nbsp;
		<span class="kw3">If</span><span class="br0">&#40;</span><span class="sy0">!</span><span class="re0">$List</span><span class="br0">&#41;</span>
		<span class="br0">&#123;</span>
			<span class="co1">#the next line causes the heading row to flow across page breaks</span>
			<span class="re0">$WordTable</span>.Rows.First.Headingformat <span class="sy0">=</span> <span class="re0">$wdHeadingFormatTrue</span>;
		<span class="br0">&#125;</span>
&nbsp;
		<span class="kw3">If</span><span class="br0">&#40;</span><span class="sy0">!</span><span class="re0">$NoGridLines</span><span class="br0">&#41;</span> 
		<span class="br0">&#123;</span>
			<span class="re0">$WordTable</span>.Borders.InsideLineStyle <span class="sy0">=</span> <span class="re0">$wdLineStyleSingle</span>;
			<span class="re0">$WordTable</span>.Borders.OutsideLineStyle <span class="sy0">=</span> <span class="re0">$wdLineStyleSingle</span>;
		<span class="br0">&#125;</span>
		<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$NoGridLines</span><span class="br0">&#41;</span> 
		<span class="br0">&#123;</span>
			<span class="re0">$WordTable</span>.Borders.InsideLineStyle <span class="sy0">=</span> <span class="re0">$wdLineStyleNone</span>;
			<span class="re0">$WordTable</span>.Borders.OutsideLineStyle <span class="sy0">=</span> <span class="re0">$wdLineStyleNone</span>;
		<span class="br0">&#125;</span>
		<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$NoInternalGridLines</span><span class="br0">&#41;</span> 
		<span class="br0">&#123;</span>
			<span class="re0">$WordTable</span>.Borders.InsideLineStyle <span class="sy0">=</span> <span class="re0">$wdLineStyleNone</span>;
			<span class="re0">$WordTable</span>.Borders.OutsideLineStyle <span class="sy0">=</span> <span class="re0">$wdLineStyleSingle</span>;
		<span class="br0">&#125;</span>
&nbsp;
		<span class="kw3">Return</span> <span class="re0">$WordTable</span>;
&nbsp;
	<span class="br0">&#125;</span> <span class="co1">## end Process</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="coMULTI">&lt;#
.Synopsis
	Sets the format of one or more Word table cells
.DESCRIPTION
	This function sets the format of one or more table cells, either from a collection
	of Word COM object cell references, an individual Word COM object cell reference or
	a hashtable containing Row and Column information.
&nbsp;
	The font name, font size, bold, italic , underline and shading values can be used.
.EXAMPLE
	SetWordCellFormat -Hashtable $Coordinates -Table $TableReference -Bold
&nbsp;
	This example sets all text to bold that is contained within the $TableReference
	Word table, using an array of hashtables. Each hashtable contain a pair of co-
	ordinates that is used to select the required cells. Note: the hashtable must
	contain the .Row and .Column key names. For example:
	@ { Row = 7; Column = 3 } to set the cell at row 7 and column 3 to bold.
.EXAMPLE
	$RowCollection = $Table.Rows.First.Cells
	SetWordCellFormat -Collection $RowCollection -Bold -Size 10
&nbsp;
	This example sets all text to size 8 and bold for all cells that are contained
	within the first row of the table.
	Note: the $Table.Rows.First.Cells returns a collection of Word COM cells objects
	that are in the first table row.
.EXAMPLE
	$ColumnCollection = $Table.Columns.Item(2).Cells
	SetWordCellFormat -Collection $ColumnCollection -BackgroundColor 255
&nbsp;
	This example sets the background (shading) of all cells in the table's second
	column to red.
	Note: the $Table.Columns.Item(2).Cells returns a collection of Word COM cells objects
	that are in the table's second column.
.EXAMPLE
	SetWordCellFormat -Cell $Table.Cell(17,3) -Font &quot;Tahoma&quot; -Color 16711680
&nbsp;
	This example sets the font to Tahoma and the text color to blue for the cell located
	in the table's 17th row and 3rd column.
	Note: the $Table.Cell(17,3) returns a single Word COM cells object.
#&gt;</span>
&nbsp;
<span class="kw3">Function</span> SetWordCellFormat 
<span class="br0">&#123;</span>
	<span class="br0">&#91;</span>CmdletBinding<span class="br0">&#40;</span>DefaultParameterSetName<span class="sy0">=</span><span class="st0">'Collection'</span><span class="br0">&#41;</span><span class="br0">&#93;</span>
	<span class="kw3">Param</span> <span class="br0">&#40;</span>
		<span class="co1"># Word COM object cell collection reference</span>
		<span class="br0">&#91;</span>Parameter<span class="br0">&#40;</span>Mandatory<span class="sy0">=</span><span class="re0">$true</span><span class="sy0">,</span> ValueFromPipeline<span class="sy0">=</span><span class="re0">$true</span><span class="sy0">,</span> ParameterSetName<span class="sy0">=</span><span class="st0">'Collection'</span><span class="sy0">,</span> Position<span class="sy0">=</span><span class="nu0">0</span><span class="br0">&#41;</span><span class="br0">&#93;</span> <span class="br0">&#91;</span>ValidateNotNullOrEmpty<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#93;</span> <span class="re0">$Collection</span><span class="sy0">,</span>
		<span class="co1"># Word COM object individual cell reference</span>
		<span class="br0">&#91;</span>Parameter<span class="br0">&#40;</span>Mandatory<span class="sy0">=</span><span class="re0">$true</span><span class="sy0">,</span> ParameterSetName<span class="sy0">=</span><span class="st0">'Cell'</span><span class="sy0">,</span> Position<span class="sy0">=</span><span class="nu0">0</span><span class="br0">&#41;</span><span class="br0">&#93;</span> <span class="br0">&#91;</span>ValidateNotNullOrEmpty<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#93;</span> <span class="re0">$Cell</span><span class="sy0">,</span>
		<span class="co1"># Hashtable of cell co-ordinates</span>
		<span class="br0">&#91;</span>Parameter<span class="br0">&#40;</span>Mandatory<span class="sy0">=</span><span class="re0">$true</span><span class="sy0">,</span> ParameterSetName<span class="sy0">=</span><span class="st0">'Hashtable'</span><span class="sy0">,</span> Position<span class="sy0">=</span><span class="nu0">0</span><span class="br0">&#41;</span><span class="br0">&#93;</span> <span class="br0">&#91;</span>ValidateNotNullOrEmpty<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#93;</span> <span class="br0">&#91;</span>System.Collections.Hashtable<span class="br0">&#91;</span><span class="br0">&#93;</span><span class="br0">&#93;</span> <span class="re0">$Coordinates</span><span class="sy0">,</span>
		<span class="co1"># Word COM object table reference</span>
		<span class="br0">&#91;</span>Parameter<span class="br0">&#40;</span>Mandatory<span class="sy0">=</span><span class="re0">$true</span><span class="sy0">,</span> ParameterSetName<span class="sy0">=</span><span class="st0">'Hashtable'</span><span class="sy0">,</span> Position<span class="sy0">=</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="br0">&#93;</span> <span class="br0">&#91;</span>ValidateNotNullOrEmpty<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#93;</span> <span class="re0">$Table</span><span class="sy0">,</span>
		<span class="co1"># Font name</span>
		<span class="br0">&#91;</span>Parameter<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#93;</span> <span class="br0">&#91;</span>AllowNull<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span> <span class="re0">$Font</span> <span class="sy0">=</span> <span class="re0">$null</span><span class="sy0">,</span>
		<span class="co1"># Font color</span>
		<span class="br0">&#91;</span>Parameter<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#93;</span> <span class="br0">&#91;</span>AllowNull<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#93;</span> <span class="re0">$Color</span> <span class="sy0">=</span> <span class="re0">$null</span><span class="sy0">,</span>
		<span class="co1"># Font size</span>
		<span class="br0">&#91;</span>Parameter<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#93;</span> <span class="br0">&#91;</span>ValidateNotNullOrEmpty<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span> <span class="re0">$Size</span> <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">,</span>
		<span class="co1"># Cell background color</span>
		<span class="br0">&#91;</span>Parameter<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#93;</span> <span class="br0">&#91;</span>AllowNull<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#93;</span> <span class="re0">$BackgroundColor</span> <span class="sy0">=</span> <span class="re0">$null</span><span class="sy0">,</span>
		<span class="co1"># Force solid background color</span>
		<span class="br0">&#91;</span><span class="kw3">Switch</span><span class="br0">&#93;</span> <span class="re0">$Solid</span><span class="sy0">,</span>
		<span class="br0">&#91;</span><span class="kw3">Switch</span><span class="br0">&#93;</span> <span class="re0">$Bold</span><span class="sy0">,</span>
		<span class="br0">&#91;</span><span class="kw3">Switch</span><span class="br0">&#93;</span> <span class="re0">$Italic</span><span class="sy0">,</span>
		<span class="br0">&#91;</span><span class="kw3">Switch</span><span class="br0">&#93;</span> <span class="re0">$Underline</span>
	<span class="br0">&#41;</span>
&nbsp;
	Begin 
	<span class="br0">&#123;</span>
		<span class="kw1">Write-Debug</span> <span class="br0">&#40;</span><span class="st0">&quot;Using parameter set '{0}'.&quot;</span> <span class="kw4">-f</span> <span class="re0">$PSCmdlet</span>.ParameterSetName<span class="br0">&#41;</span>;
	<span class="br0">&#125;</span>
&nbsp;
	Process 
	<span class="br0">&#123;</span>
		<span class="kw3">Switch</span> <span class="br0">&#40;</span><span class="re0">$PSCmdlet</span>.ParameterSetName<span class="br0">&#41;</span> 
		<span class="br0">&#123;</span>
			<span class="st0">'Collection'</span> <span class="br0">&#123;</span>
				<span class="kw3">ForEach</span><span class="br0">&#40;</span><span class="re0">$Cell</span> <span class="kw3">in</span> <span class="re0">$Collection</span><span class="br0">&#41;</span> 
				<span class="br0">&#123;</span>
					<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$BackgroundColor</span> <span class="kw4">-ne</span> <span class="re0">$null</span><span class="br0">&#41;</span> <span class="br0">&#123;</span> <span class="re0">$Cell</span>.Shading.BackgroundPatternColor <span class="sy0">=</span> <span class="re0">$BackgroundColor</span>; <span class="br0">&#125;</span>
					<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$Bold</span><span class="br0">&#41;</span> <span class="br0">&#123;</span> <span class="re0">$Cell</span>.Range.Font.Bold <span class="sy0">=</span> <span class="re0">$true</span>; <span class="br0">&#125;</span>
					<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$Italic</span><span class="br0">&#41;</span> <span class="br0">&#123;</span> <span class="re0">$Cell</span>.Range.Font.Italic <span class="sy0">=</span> <span class="re0">$true</span>; <span class="br0">&#125;</span>
					<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$Underline</span><span class="br0">&#41;</span> <span class="br0">&#123;</span> <span class="re0">$Cell</span>.Range.Font.Underline <span class="sy0">=</span> <span class="nu0">1</span>; <span class="br0">&#125;</span>
					<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$Font</span> <span class="kw4">-ne</span> <span class="re0">$null</span><span class="br0">&#41;</span> <span class="br0">&#123;</span> <span class="re0">$Cell</span>.Range.Font.Name <span class="sy0">=</span> <span class="re0">$Font</span>; <span class="br0">&#125;</span>
					<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$Color</span> <span class="kw4">-ne</span> <span class="re0">$null</span><span class="br0">&#41;</span> <span class="br0">&#123;</span> <span class="re0">$Cell</span>.Range.Font.Color <span class="sy0">=</span> <span class="re0">$Color</span>; <span class="br0">&#125;</span>
					<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$Size</span> <span class="kw4">-ne</span> <span class="nu0">0</span><span class="br0">&#41;</span> <span class="br0">&#123;</span> <span class="re0">$Cell</span>.Range.Font.Size <span class="sy0">=</span> <span class="re0">$Size</span>; <span class="br0">&#125;</span>
					<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$Solid</span><span class="br0">&#41;</span> <span class="br0">&#123;</span> <span class="re0">$Cell</span>.Shading.Texture <span class="sy0">=</span> <span class="nu0">0</span>; <span class="br0">&#125;</span> <span class="co1">## wdTextureNone</span>
				<span class="br0">&#125;</span> <span class="co1"># end foreach</span>
			<span class="br0">&#125;</span> <span class="co1"># end Collection</span>
			<span class="st0">'Cell'</span> 
			<span class="br0">&#123;</span>
				<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$Bold</span><span class="br0">&#41;</span> <span class="br0">&#123;</span> <span class="re0">$Cell</span>.Range.Font.Bold <span class="sy0">=</span> <span class="re0">$true</span>; <span class="br0">&#125;</span>
				<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$Italic</span><span class="br0">&#41;</span> <span class="br0">&#123;</span> <span class="re0">$Cell</span>.Range.Font.Italic <span class="sy0">=</span> <span class="re0">$true</span>; <span class="br0">&#125;</span>
				<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$Underline</span><span class="br0">&#41;</span> <span class="br0">&#123;</span> <span class="re0">$Cell</span>.Range.Font.Underline <span class="sy0">=</span> <span class="nu0">1</span>; <span class="br0">&#125;</span>
				<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$Font</span> <span class="kw4">-ne</span> <span class="re0">$null</span><span class="br0">&#41;</span> <span class="br0">&#123;</span> <span class="re0">$Cell</span>.Range.Font.Name <span class="sy0">=</span> <span class="re0">$Font</span>; <span class="br0">&#125;</span>
				<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$Color</span> <span class="kw4">-ne</span> <span class="re0">$null</span><span class="br0">&#41;</span> <span class="br0">&#123;</span> <span class="re0">$Cell</span>.Range.Font.Color <span class="sy0">=</span> <span class="re0">$Color</span>; <span class="br0">&#125;</span>
				<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$Size</span> <span class="kw4">-ne</span> <span class="nu0">0</span><span class="br0">&#41;</span> <span class="br0">&#123;</span> <span class="re0">$Cell</span>.Range.Font.Size <span class="sy0">=</span> <span class="re0">$Size</span>; <span class="br0">&#125;</span>
				<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$BackgroundColor</span> <span class="kw4">-ne</span> <span class="re0">$null</span><span class="br0">&#41;</span> <span class="br0">&#123;</span> <span class="re0">$Cell</span>.Shading.BackgroundPatternColor <span class="sy0">=</span> <span class="re0">$BackgroundColor</span>; <span class="br0">&#125;</span>
				<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$Solid</span><span class="br0">&#41;</span> <span class="br0">&#123;</span> <span class="re0">$Cell</span>.Shading.Texture <span class="sy0">=</span> <span class="nu0">0</span>; <span class="br0">&#125;</span> <span class="co1">## wdTextureNone</span>
			<span class="br0">&#125;</span> <span class="co1"># end Cell</span>
			<span class="st0">'Hashtable'</span> 
			<span class="br0">&#123;</span>
				<span class="kw3">ForEach</span><span class="br0">&#40;</span><span class="re0">$Coordinate</span> <span class="kw3">in</span> <span class="re0">$Coordinates</span><span class="br0">&#41;</span> 
				<span class="br0">&#123;</span>
					<span class="re0">$Cell</span> <span class="sy0">=</span> <span class="re0">$Table</span>.Cell<span class="br0">&#40;</span><span class="re0">$Coordinate</span>.Row<span class="sy0">,</span> <span class="re0">$Coordinate</span>.Column<span class="br0">&#41;</span>;
					<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$Bold</span><span class="br0">&#41;</span> <span class="br0">&#123;</span> <span class="re0">$Cell</span>.Range.Font.Bold <span class="sy0">=</span> <span class="re0">$true</span>; <span class="br0">&#125;</span>
					<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$Italic</span><span class="br0">&#41;</span> <span class="br0">&#123;</span> <span class="re0">$Cell</span>.Range.Font.Italic <span class="sy0">=</span> <span class="re0">$true</span>; <span class="br0">&#125;</span>
					<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$Underline</span><span class="br0">&#41;</span> <span class="br0">&#123;</span> <span class="re0">$Cell</span>.Range.Font.Underline <span class="sy0">=</span> <span class="nu0">1</span>; <span class="br0">&#125;</span>
					<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$Font</span> <span class="kw4">-ne</span> <span class="re0">$null</span><span class="br0">&#41;</span> <span class="br0">&#123;</span> <span class="re0">$Cell</span>.Range.Font.Name <span class="sy0">=</span> <span class="re0">$Font</span>; <span class="br0">&#125;</span>
					<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$Color</span> <span class="kw4">-ne</span> <span class="re0">$null</span><span class="br0">&#41;</span> <span class="br0">&#123;</span> <span class="re0">$Cell</span>.Range.Font.Color <span class="sy0">=</span> <span class="re0">$Color</span>; <span class="br0">&#125;</span>
					<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$Size</span> <span class="kw4">-ne</span> <span class="nu0">0</span><span class="br0">&#41;</span> <span class="br0">&#123;</span> <span class="re0">$Cell</span>.Range.Font.Size <span class="sy0">=</span> <span class="re0">$Size</span>; <span class="br0">&#125;</span>
					<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$BackgroundColor</span> <span class="kw4">-ne</span> <span class="re0">$null</span><span class="br0">&#41;</span> <span class="br0">&#123;</span> <span class="re0">$Cell</span>.Shading.BackgroundPatternColor <span class="sy0">=</span> <span class="re0">$BackgroundColor</span>; <span class="br0">&#125;</span>
					<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$Solid</span><span class="br0">&#41;</span> <span class="br0">&#123;</span> <span class="re0">$Cell</span>.Shading.Texture <span class="sy0">=</span> <span class="nu0">0</span>; <span class="br0">&#125;</span> <span class="co1">## wdTextureNone</span>
				<span class="br0">&#125;</span>
			<span class="br0">&#125;</span> <span class="co1"># end Hashtable</span>
		<span class="br0">&#125;</span> <span class="co1"># end switch</span>
	<span class="br0">&#125;</span> <span class="co1"># end process</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="coMULTI">&lt;#
.Synopsis
	Sets alternate row colors in a Word table
.DESCRIPTION
	This function sets the format of alternate rows within a Word table using the
	specified $BackgroundColor. This function is expensive (in performance terms) as
	it recursively sets the format on alternate rows. It would be better to pick one
	of the predefined table formats (if one exists)? Obviously the more rows, the
	longer it takes :'(
&nbsp;
	Note: this function is called by the AddWordTable function if an alternate row
	format is specified.
.EXAMPLE
	SetWordTableAlternateRowColor -Table $TableReference -BackgroundColor 255
&nbsp;
	This example sets every-other table (starting with the first) row and sets the
	background color to red (wdColorRed).
.EXAMPLE
	SetWordTableAlternateRowColor -Table $TableReference -BackgroundColor 39423 -Seed Second
&nbsp;
	This example sets every other table (starting with the second) row and sets the
	background color to light orange (weColorLightOrange).
#&gt;</span>
&nbsp;
<span class="kw3">Function</span> SetWordTableAlternateRowColor 
<span class="br0">&#123;</span>
	<span class="br0">&#91;</span>CmdletBinding<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#93;</span>
	<span class="kw3">Param</span> <span class="br0">&#40;</span>
		<span class="co1"># Word COM object table reference</span>
		<span class="br0">&#91;</span>Parameter<span class="br0">&#40;</span>Mandatory<span class="sy0">=</span><span class="re0">$true</span><span class="sy0">,</span> ValueFromPipeline<span class="sy0">=</span><span class="re0">$true</span><span class="sy0">,</span> Position<span class="sy0">=</span><span class="nu0">0</span><span class="br0">&#41;</span><span class="br0">&#93;</span> <span class="br0">&#91;</span>ValidateNotNullOrEmpty<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#93;</span> <span class="re0">$Table</span><span class="sy0">,</span>
		<span class="co1"># Alternate row background color</span>
		<span class="br0">&#91;</span>Parameter<span class="br0">&#40;</span>Mandatory<span class="sy0">=</span><span class="re0">$true</span><span class="sy0">,</span> Position<span class="sy0">=</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="br0">&#93;</span> <span class="br0">&#91;</span>ValidateNotNull<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span> <span class="re0">$BackgroundColor</span><span class="sy0">,</span>
		<span class="co1"># Alternate row starting seed</span>
		<span class="br0">&#91;</span>Parameter<span class="br0">&#40;</span>ValueFromPipelineByPropertyName<span class="sy0">=</span><span class="re0">$true</span><span class="sy0">,</span> Position<span class="sy0">=</span><span class="nu0">2</span><span class="br0">&#41;</span><span class="br0">&#93;</span> <span class="br0">&#91;</span>ValidateSet<span class="br0">&#40;</span><span class="st0">'First'</span><span class="sy0">,</span><span class="st0">'Second'</span><span class="br0">&#41;</span><span class="br0">&#93;</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span> <span class="re0">$Seed</span> <span class="sy0">=</span> <span class="st0">'First'</span>
	<span class="br0">&#41;</span>
&nbsp;
	Process 
	<span class="br0">&#123;</span>
		<span class="re0">$StartDateTime</span> <span class="sy0">=</span> <span class="kw1">Get-Date</span>;
		<span class="kw1">Write-Debug</span> <span class="br0">&#40;</span><span class="st0">&quot;{0}: <span class="es0">`t</span><span class="es0">`t</span>Setting alternate table row colors..&quot;</span> <span class="kw4">-f</span> <span class="re0">$StartDateTime</span><span class="br0">&#41;</span>;
&nbsp;
		<span class="co1">## Determine the row seed (only really need to check for 'Second' and default to 'First' otherwise</span>
		<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$Seed</span>.ToLower<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="kw4">-eq</span> <span class="st0">'second'</span><span class="br0">&#41;</span> 
		<span class="br0">&#123;</span> 
			<span class="re0">$StartRowIndex</span> <span class="sy0">=</span> <span class="nu0">2</span>; 
		<span class="br0">&#125;</span>
		<span class="kw3">Else</span> 
		<span class="br0">&#123;</span> 
			<span class="re0">$StartRowIndex</span> <span class="sy0">=</span> <span class="nu0">1</span>; 
		<span class="br0">&#125;</span>
&nbsp;
		<span class="kw3">For</span><span class="br0">&#40;</span><span class="re0">$AlternateRowIndex</span> <span class="sy0">=</span> <span class="re0">$StartRowIndex</span>; <span class="re0">$AlternateRowIndex</span> <span class="kw4">-lt</span> <span class="re0">$Table</span>.Rows.Count; <span class="re0">$AlternateRowIndex</span> <span class="sy0">+=</span> <span class="nu0">2</span><span class="br0">&#41;</span> 
		<span class="br0">&#123;</span> 
			<span class="re0">$Table</span>.Rows.Item<span class="br0">&#40;</span><span class="re0">$AlternateRowIndex</span><span class="br0">&#41;</span>.Shading.BackgroundPatternColor <span class="sy0">=</span> <span class="re0">$BackgroundColor</span>;
		<span class="br0">&#125;</span>
&nbsp;
		<span class="co1">## I've put verbose calls in here we can see how expensive this functionality actually is.</span>
		<span class="re0">$EndDateTime</span> <span class="sy0">=</span> <span class="kw1">Get-Date</span>;
		<span class="re0">$ExecutionTime</span> <span class="sy0">=</span> <span class="kw1">New-TimeSpan</span> <span class="kw5">-Start</span> <span class="re0">$StartDateTime</span> <span class="kw5">-End</span> <span class="re0">$EndDateTime</span>;
		<span class="kw1">Write-Debug</span> <span class="br0">&#40;</span><span class="st0">&quot;{0}: <span class="es0">`t</span><span class="es0">`t</span>Done setting alternate row style color in '{1}' seconds&quot;</span> <span class="kw4">-f</span> <span class="re0">$EndDateTime</span><span class="sy0">,</span> <span class="re0">$ExecutionTime</span>.TotalSeconds<span class="br0">&#41;</span>;
	<span class="br0">&#125;</span>
<span class="br0">&#125;</span>
<span class="co1">#endregion</span>
&nbsp;
<span class="co1">#region general script functions</span>
<span class="kw3">Function</span> ShowScriptOptions
<span class="br0">&#123;</span>
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): &quot;</span>
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): &quot;</span>
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Company Name : $($Script:CoName)&quot;</span>
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Cover Page   : $($CoverPage)&quot;</span>
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): User Name    : $($UserName)&quot;</span>
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Save As PDF  : $($PDF)&quot;</span>
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Save As TEXT : $($TEXT)&quot;</span>
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Save As WORD : $($MSWORD)&quot;</span>
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Save As HTML : $($HTML)&quot;</span>
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Add DateTime : $($AddDateTime)&quot;</span>
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): HW Inventory : $($Hardware)&quot;</span>
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Filename1    : $($Script:FileName1)&quot;</span>
	<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$PDF</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Filename2    : $($Script:FileName2)&quot;</span>
	<span class="br0">&#125;</span>
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): OS Detected  : $($RunningOS)&quot;</span>
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): PSUICulture  : $($PSUICulture)&quot;</span>
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): PSCulture    : $($PSCulture)&quot;</span>
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Word version : $($Script:WordProduct)&quot;</span>
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Word language: $($Script:WordLanguageValue)&quot;</span>
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): PoSH version : $($Host.Version)&quot;</span>
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): &quot;</span>
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Script start : $($Script:StartTime)&quot;</span>
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): &quot;</span>
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): &quot;</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw3">Function</span> validStateProp<span class="br0">&#40;</span> <span class="br0">&#91;</span><span class="re3">object</span><span class="br0">&#93;</span> <span class="re0">$object</span><span class="sy0">,</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span> <span class="re0">$topLevel</span><span class="sy0">,</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span> <span class="re0">$secondLevel</span> <span class="br0">&#41;</span>
<span class="br0">&#123;</span>
	<span class="co1">#function created 8-jan-2014 by Michael B. Smith</span>
	<span class="kw3">if</span><span class="br0">&#40;</span> <span class="re0">$object</span> <span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<span class="kw3">If</span><span class="br0">&#40;</span> <span class="br0">&#40;</span> <span class="kw2">gm</span> <span class="kw5">-Name</span> <span class="re0">$topLevel</span> <span class="kw5">-InputObject</span> <span class="re0">$object</span> <span class="br0">&#41;</span> <span class="br0">&#41;</span>
		<span class="br0">&#123;</span>
			<span class="kw3">If</span><span class="br0">&#40;</span> <span class="br0">&#40;</span> <span class="kw2">gm</span> <span class="kw5">-Name</span> <span class="re0">$secondLevel</span> <span class="kw5">-InputObject</span> <span class="re0">$object</span>.<span class="re0">$topLevel</span> <span class="br0">&#41;</span> <span class="br0">&#41;</span>
			<span class="br0">&#123;</span>
				<span class="kw3">Return</span> <span class="re0">$True</span>
			<span class="br0">&#125;</span>
		<span class="br0">&#125;</span>
	<span class="br0">&#125;</span>
	<span class="kw3">Return</span> <span class="re0">$False</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw3">Function</span> SaveandCloseDocumentandShutdownWord
<span class="br0">&#123;</span>
	<span class="co1">#bug fix 1-Apr-2014</span>
	<span class="co1">#reset Grammar and Spelling options back to their original settings</span>
	<span class="re0">$Script</span>:Word.Options.CheckGrammarAsYouType <span class="sy0">=</span> <span class="re0">$Script</span>:CurrentGrammarOption
	<span class="re0">$Script</span>:Word.Options.CheckSpellingAsYouType <span class="sy0">=</span> <span class="re0">$Script</span>:CurrentSpellingOption
&nbsp;
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Save and Close document and Shutdown Word&quot;</span>
	<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$Script</span>:WordVersion <span class="kw4">-eq</span> <span class="re0">$wdWord2010</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<span class="co1">#the $saveFormat below passes StrictMode 2</span>
		<span class="co1">#I found this at the following two links</span>
		<span class="co1">#http://blogs.technet.com/b/bshukla/archive/2011/09/27/3347395.aspx</span>
		<span class="co1">#http://msdn.microsoft.com/en-us/library/microsoft.office.interop.word.wdsaveformat(v=office.14).aspx</span>
		<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$PDF</span><span class="br0">&#41;</span>
		<span class="br0">&#123;</span>
			<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Saving as DOCX file first before saving to PDF&quot;</span>
		<span class="br0">&#125;</span>
		<span class="kw3">Else</span>
		<span class="br0">&#123;</span>
			<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Saving DOCX file&quot;</span>
		<span class="br0">&#125;</span>
		<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$AddDateTime</span><span class="br0">&#41;</span>
		<span class="br0">&#123;</span>
			<span class="re0">$Script</span>:FileName1 <span class="sy0">+=</span> <span class="st0">&quot;_$(Get-Date -f yyyy-MM-dd_HHmm).docx&quot;</span>
			<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$PDF</span><span class="br0">&#41;</span>
			<span class="br0">&#123;</span>
				<span class="re0">$Script</span>:FileName2 <span class="sy0">+=</span> <span class="st0">&quot;_$(Get-Date -f yyyy-MM-dd_HHmm).pdf&quot;</span>
			<span class="br0">&#125;</span>
		<span class="br0">&#125;</span>
		<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Running Word 2010 and detected operating system $($RunningOS)&quot;</span>
		<span class="re0">$saveFormat</span> <span class="sy0">=</span> <span class="br0">&#91;</span>Enum<span class="br0">&#93;</span>::Parse<span class="br0">&#40;</span><span class="br0">&#91;</span>Microsoft.Office.Interop.Word.WdSaveFormat<span class="br0">&#93;</span><span class="sy0">,</span> <span class="st0">&quot;wdFormatDocumentDefault&quot;</span><span class="br0">&#41;</span>
		<span class="re0">$Script</span>:Doc.SaveAs<span class="br0">&#40;</span><span class="br0">&#91;</span><span class="re3">REF</span><span class="br0">&#93;</span><span class="re0">$Script</span>:FileName1<span class="sy0">,</span> <span class="br0">&#91;</span><span class="re3">ref</span><span class="br0">&#93;</span><span class="re0">$SaveFormat</span><span class="br0">&#41;</span>
		<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$PDF</span><span class="br0">&#41;</span>
		<span class="br0">&#123;</span>
			<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Now saving as PDF&quot;</span>
			<span class="re0">$saveFormat</span> <span class="sy0">=</span> <span class="br0">&#91;</span>Enum<span class="br0">&#93;</span>::Parse<span class="br0">&#40;</span><span class="br0">&#91;</span>Microsoft.Office.Interop.Word.WdSaveFormat<span class="br0">&#93;</span><span class="sy0">,</span> <span class="st0">&quot;wdFormatPDF&quot;</span><span class="br0">&#41;</span>
			<span class="re0">$Script</span>:Doc.SaveAs<span class="br0">&#40;</span><span class="br0">&#91;</span><span class="re3">REF</span><span class="br0">&#93;</span><span class="re0">$Script</span>:FileName2<span class="sy0">,</span> <span class="br0">&#91;</span><span class="re3">ref</span><span class="br0">&#93;</span><span class="re0">$saveFormat</span><span class="br0">&#41;</span>
		<span class="br0">&#125;</span>
	<span class="br0">&#125;</span>
	<span class="kw3">ElseIf</span><span class="br0">&#40;</span><span class="re0">$Script</span>:WordVersion <span class="kw4">-eq</span> <span class="re0">$wdWord2013</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$PDF</span><span class="br0">&#41;</span>
		<span class="br0">&#123;</span>
			<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Saving as DOCX file first before saving to PDF&quot;</span>
		<span class="br0">&#125;</span>
		<span class="kw3">Else</span>
		<span class="br0">&#123;</span>
			<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Saving DOCX file&quot;</span>
		<span class="br0">&#125;</span>
		<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$AddDateTime</span><span class="br0">&#41;</span>
		<span class="br0">&#123;</span>
			<span class="re0">$Script</span>:FileName1 <span class="sy0">+=</span> <span class="st0">&quot;_$(Get-Date -f yyyy-MM-dd_HHmm).docx&quot;</span>
			<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$PDF</span><span class="br0">&#41;</span>
			<span class="br0">&#123;</span>
				<span class="re0">$Script</span>:FileName2 <span class="sy0">+=</span> <span class="st0">&quot;_$(Get-Date -f yyyy-MM-dd_HHmm).pdf&quot;</span>
			<span class="br0">&#125;</span>
		<span class="br0">&#125;</span>
		<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Running Word 2013 and detected operating system $($RunningOS)&quot;</span>
		<span class="re0">$Script</span>:Doc.SaveAs2<span class="br0">&#40;</span><span class="br0">&#91;</span><span class="re3">REF</span><span class="br0">&#93;</span><span class="re0">$Script</span>:FileName1<span class="sy0">,</span> <span class="br0">&#91;</span><span class="re3">ref</span><span class="br0">&#93;</span><span class="re0">$wdFormatDocumentDefault</span><span class="br0">&#41;</span>
		<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$PDF</span><span class="br0">&#41;</span>
		<span class="br0">&#123;</span>
			<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Now saving as PDF&quot;</span>
			<span class="re0">$Script</span>:Doc.SaveAs<span class="br0">&#40;</span><span class="br0">&#91;</span><span class="re3">REF</span><span class="br0">&#93;</span><span class="re0">$Script</span>:FileName2<span class="sy0">,</span> <span class="br0">&#91;</span><span class="re3">ref</span><span class="br0">&#93;</span><span class="re0">$wdFormatPDF</span><span class="br0">&#41;</span>
		<span class="br0">&#125;</span>
	<span class="br0">&#125;</span>
&nbsp;
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Closing Word&quot;</span>
	<span class="re0">$Script</span>:Doc.Close<span class="br0">&#40;</span><span class="br0">&#41;</span>
	<span class="re0">$Script</span>:Word.Quit<span class="br0">&#40;</span><span class="br0">&#41;</span>
	<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$PDF</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Deleting $($Script:FileName1) since only $($Script:FileName2) is needed&quot;</span>
		<span class="kw1">Remove-Item</span> <span class="re0">$Script</span>:FileName1 <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
	<span class="br0">&#125;</span>
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): System Cleanup&quot;</span>
	<span class="br0">&#91;</span>System.Runtime.Interopservices.Marshal<span class="br0">&#93;</span>::ReleaseComObject<span class="br0">&#40;</span><span class="re0">$Script</span>:Word<span class="br0">&#41;</span> <span class="sy0">|</span> <span class="kw1">Out-Null</span>
	<span class="kw3">If</span><span class="br0">&#40;</span><span class="kw1">Test-Path</span> variable:global:word<span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<span class="kw1">Remove-Variable</span> <span class="kw5">-Name</span> word <span class="kw5">-Scope</span> Global <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
	<span class="br0">&#125;</span>
	<span class="re0">$SaveFormat</span> <span class="sy0">=</span> <span class="re0">$Null</span>
	<span class="br0">&#91;</span><span class="kw2">gc</span><span class="br0">&#93;</span>::collect<span class="br0">&#40;</span><span class="br0">&#41;</span> 
	<span class="br0">&#91;</span><span class="kw2">gc</span><span class="br0">&#93;</span>::WaitForPendingFinalizers<span class="br0">&#40;</span><span class="br0">&#41;</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw3">Function</span> SaveandCloseTextDocument
<span class="br0">&#123;</span>
	<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$AddDateTime</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<span class="re0">$Script</span>:FileName1 <span class="sy0">+=</span> <span class="st0">&quot;_$(Get-Date -f yyyy-MM-dd_HHmm).txt&quot;</span>
	<span class="br0">&#125;</span>
&nbsp;
	<span class="kw1">Write-Output</span> <span class="re0">$Global</span>:Output <span class="sy0">|</span> <span class="kw1">Out<span class="kw4">-File</span></span> <span class="re0">$Script</span>:Filename1 <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw3">Function</span> SaveandCloseHTMLDocument
<span class="br0">&#123;</span>
    <span class="co1">#echo &quot;&lt;p&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;&quot; &gt;&gt; $FileName1</span>
	<span class="kw1">out<span class="kw4">-file</span></span> <span class="kw5">-FilePath</span> <span class="re0">$Script</span>:FileName1 <span class="kw5">-Append</span> <span class="kw5">-InputObject</span> <span class="st0">&quot;&lt;p&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;&quot;</span> <span class="nu0">4</span><span class="sy0">&gt;</span><span class="re0">$Null</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw3">Function</span> SetFileName1andFileName2
<span class="br0">&#123;</span>
	<span class="kw3">Param</span><span class="br0">&#40;</span><span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span><span class="re0">$OutputFileName</span><span class="br0">&#41;</span>
	<span class="re0">$pwdpath</span> <span class="sy0">=</span> <span class="re0">$pwd</span>.Path
&nbsp;
	<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$pwdpath</span>.EndsWith<span class="br0">&#40;</span><span class="st0">&quot;\&quot;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<span class="co1">#remove the trailing \</span>
		<span class="re0">$pwdpath</span> <span class="sy0">=</span> <span class="re0">$pwdpath</span>.SubString<span class="br0">&#40;</span><span class="nu0">0</span><span class="sy0">,</span> <span class="br0">&#40;</span><span class="re0">$pwdpath</span>.Length <span class="sy0">-</span> <span class="nu0">1</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
	<span class="br0">&#125;</span>
&nbsp;
	<span class="co1">#set $filename1 and $filename2 with no file extension</span>
	<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$AddDateTime</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span><span class="re0">$Script</span>:FileName1 <span class="sy0">=</span> <span class="st0">&quot;$($pwdpath)\$($OutputFileName)&quot;</span>
		<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$PDF</span><span class="br0">&#41;</span>
		<span class="br0">&#123;</span>
			<span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span><span class="re0">$Script</span>:FileName2 <span class="sy0">=</span> <span class="st0">&quot;$($pwdpath)\$($OutputFileName)&quot;</span>
		<span class="br0">&#125;</span>
	<span class="br0">&#125;</span>
&nbsp;
	<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$MSWord</span> <span class="kw4">-or</span> <span class="re0">$PDF</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		CheckWordPreReq
&nbsp;
		<span class="kw3">If</span><span class="br0">&#40;</span><span class="sy0">!</span><span class="re0">$AddDateTime</span><span class="br0">&#41;</span>
		<span class="br0">&#123;</span>
			<span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span><span class="re0">$Script</span>:FileName1 <span class="sy0">=</span> <span class="st0">&quot;$($pwdpath)\$($OutputFileName).docx&quot;</span>
			<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$PDF</span><span class="br0">&#41;</span>
			<span class="br0">&#123;</span>
				<span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span><span class="re0">$Script</span>:FileName2 <span class="sy0">=</span> <span class="st0">&quot;$($pwdpath)\$($OutputFileName).pdf&quot;</span>
			<span class="br0">&#125;</span>
		<span class="br0">&#125;</span>
&nbsp;
		SetupWord
	<span class="br0">&#125;</span>
	<span class="kw3">ElseIf</span><span class="br0">&#40;</span><span class="re0">$Text</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<span class="kw3">If</span><span class="br0">&#40;</span><span class="sy0">!</span><span class="re0">$AddDateTime</span><span class="br0">&#41;</span>
		<span class="br0">&#123;</span>
			<span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span><span class="re0">$Script</span>:FileName1 <span class="sy0">=</span> <span class="st0">&quot;$($pwdpath)\$($OutputFileName).txt&quot;</span>
		<span class="br0">&#125;</span>
	<span class="br0">&#125;</span>
	<span class="kw3">ElseIf</span><span class="br0">&#40;</span><span class="re0">$HTML</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<span class="kw3">If</span><span class="br0">&#40;</span><span class="sy0">!</span><span class="re0">$AddDateTime</span><span class="br0">&#41;</span>
		<span class="br0">&#123;</span>
			<span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span><span class="re0">$Script</span>:FileName1 <span class="sy0">=</span> <span class="st0">&quot;$($pwdpath)\$($OutputFileName).html&quot;</span>
		<span class="br0">&#125;</span>
       SetupHTML
	<span class="br0">&#125;</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw3">Function</span> TestComputerName
<span class="br0">&#123;</span>
	<span class="kw3">Param</span><span class="br0">&#40;</span><span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span><span class="re0">$Cname</span><span class="br0">&#41;</span>
	<span class="kw3">If</span><span class="br0">&#40;</span><span class="sy0">!</span><span class="br0">&#91;</span><span class="re3">String</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$CName</span><span class="br0">&#41;</span><span class="br0">&#41;</span> 
	<span class="br0">&#123;</span>
		<span class="co1">#get computer name</span>
		<span class="co1">#first test to make sure the computer is reachable</span>
		<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Testing to see if $($CName) is online and reachable&quot;</span>
		<span class="kw3">If</span><span class="br0">&#40;</span>Test<span class="sy0">-</span>Connection <span class="kw5">-ComputerName</span> <span class="re0">$CName</span> <span class="kw5">-quiet</span><span class="br0">&#41;</span>
		<span class="br0">&#123;</span>
			<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Server $($CName) is online.&quot;</span>
		<span class="br0">&#125;</span>
		<span class="kw3">Else</span>
		<span class="br0">&#123;</span>
			<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Computer $($CName) is offline&quot;</span>
			<a href="about:blank"><span class="kw6">$ErrorActionPreference</span></a> <span class="sy0">=</span> <span class="re0">$SaveEAPreference</span>
			<span class="kw1">Write-Error</span> <span class="st0">&quot;<span class="es0">`n</span><span class="es0">`n</span><span class="es0">`t</span><span class="es0">`t</span>Computer $($CName) is offline.<span class="es0">`n</span>Script cannot continue.<span class="es0">`n</span><span class="es0">`n</span>&quot;</span>
			Exit
		<span class="br0">&#125;</span>
	<span class="br0">&#125;</span>
&nbsp;
	<span class="co1">#if computer name is localhost, get actual computer name</span>
	<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$CName</span> <span class="kw4">-eq</span> <span class="st0">&quot;localhost&quot;</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<span class="re0">$CName</span> <span class="sy0">=</span> <span class="re0">$env</span>:ComputerName
		<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Computer name has been renamed from localhost to $($CName)&quot;</span>
		<span class="kw3">Return</span> <span class="re0">$CName</span>
	<span class="br0">&#125;</span>
&nbsp;
	<span class="co1">#if computer name is an IP address, get host name from DNS</span>
	<span class="co1">#http://blogs.technet.com/b/gary/archive/2009/08/29/resolve-ip-addresses-to-hostname-using-powershell.aspx</span>
	<span class="co1">#help from Michael B. Smith</span>
	<span class="re0">$ip</span> <span class="sy0">=</span> <span class="re0">$CName</span> <span class="kw4">-as</span> <span class="br0">&#91;</span>System.Net.IpAddress<span class="br0">&#93;</span>
	<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$ip</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<span class="re0">$Result</span> <span class="sy0">=</span> <span class="br0">&#91;</span>System.Net.Dns<span class="br0">&#93;</span>::gethostentry<span class="br0">&#40;</span><span class="re0">$ip</span><span class="br0">&#41;</span>
&nbsp;
		<span class="kw3">If</span><span class="br0">&#40;</span><span class="re6">$?</span> <span class="kw4">-and</span> <span class="re0">$Result</span> <span class="kw4">-ne</span> <span class="re0">$Null</span><span class="br0">&#41;</span>
		<span class="br0">&#123;</span>
			<span class="re0">$CName</span> <span class="sy0">=</span> <span class="re0">$Result</span>.HostName
			<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Computer name has been renamed from $($ip) to $($CName)&quot;</span>
			<span class="kw3">Return</span> <span class="re0">$CName</span>
		<span class="br0">&#125;</span>
		<span class="kw3">Else</span>
		<span class="br0">&#123;</span>
			<span class="kw1">Write-Warning</span> <span class="st0">&quot;Unable to resolve $($CName) to a hostname&quot;</span>
		<span class="br0">&#125;</span>
	<span class="br0">&#125;</span>
	<span class="kw3">Else</span>
	<span class="br0">&#123;</span>
		<span class="co1">#computer is online but for some reason $ComputerName cannot be converted to a System.Net.IpAddress</span>
	<span class="br0">&#125;</span>
	<span class="kw3">Return</span> <span class="re0">$CName</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw3">Function</span> ProcessDocumentOutput
<span class="br0">&#123;</span>
	<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$MSWORD</span> <span class="kw4">-or</span> <span class="re0">$PDF</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		SaveandCloseDocumentandShutdownWord
	<span class="br0">&#125;</span>
	<span class="kw3">ElseIf</span><span class="br0">&#40;</span><span class="re0">$Text</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		SaveandCloseTextDocument
	<span class="br0">&#125;</span>
	<span class="kw3">ElseIf</span><span class="br0">&#40;</span><span class="re0">$HTML</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		SaveandCloseHTMLDocument
	<span class="br0">&#125;</span>
&nbsp;
	<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$PDF</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<span class="kw3">If</span><span class="br0">&#40;</span><span class="kw1">Test-Path</span> <span class="st0">&quot;$($Script:FileName2)&quot;</span><span class="br0">&#41;</span>
		<span class="br0">&#123;</span>
			<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): $($Script:FileName2) is ready for use&quot;</span>
		<span class="br0">&#125;</span>
		<span class="kw3">Else</span>
		<span class="br0">&#123;</span>
			<span class="kw1">Write-Warning</span> <span class="st0">&quot;$(Get-Date): Unable to save the output file, $($Script:FileName2)&quot;</span>
			<span class="kw1">Write-Error</span> <span class="st0">&quot;Unable to save the output file, $($Script:FileName2)&quot;</span>
		<span class="br0">&#125;</span>
	<span class="br0">&#125;</span>
	<span class="kw3">Else</span>
	<span class="br0">&#123;</span>
		<span class="kw3">If</span><span class="br0">&#40;</span><span class="kw1">Test-Path</span> <span class="st0">&quot;$($Script:FileName1)&quot;</span><span class="br0">&#41;</span>
		<span class="br0">&#123;</span>
			<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): $($Script:FileName1) is ready for use&quot;</span>
		<span class="br0">&#125;</span>
		<span class="kw3">Else</span>
		<span class="br0">&#123;</span>
			<span class="kw1">Write-Warning</span> <span class="st0">&quot;$(Get-Date): Unable to save the output file, $($Script:FileName1)&quot;</span>
			<span class="kw1">Write-Error</span> <span class="st0">&quot;Unable to save the output file, $($Script:FileName1)&quot;</span>
		<span class="br0">&#125;</span>
	<span class="br0">&#125;</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw3">Function</span> AbortScript
<span class="br0">&#123;</span>
	<span class="kw3">If</span><span class="br0">&#40;</span><span class="re0">$MSWord</span> <span class="kw4">-or</span> <span class="re0">$PDF</span><span class="br0">&#41;</span>
	<span class="br0">&#123;</span>
		<span class="re0">$Script</span>:Word.quit<span class="br0">&#40;</span><span class="br0">&#41;</span>
		<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): System Cleanup&quot;</span>
		<span class="br0">&#91;</span>System.Runtime.Interopservices.Marshal<span class="br0">&#93;</span>::ReleaseComObject<span class="br0">&#40;</span><span class="re0">$Script</span>:Word<span class="br0">&#41;</span> <span class="sy0">|</span> <span class="kw1">Out-Null</span>
		<span class="kw3">If</span><span class="br0">&#40;</span><span class="kw1">Test-Path</span> variable:global:word<span class="br0">&#41;</span>
		<span class="br0">&#123;</span>
			<span class="kw1">Remove-Variable</span> <span class="kw5">-Name</span> word <span class="kw5">-Scope</span> Global
		<span class="br0">&#125;</span>
	<span class="br0">&#125;</span>
	<span class="br0">&#91;</span><span class="kw2">gc</span><span class="br0">&#93;</span>::collect<span class="br0">&#40;</span><span class="br0">&#41;</span> 
	<span class="br0">&#91;</span><span class="kw2">gc</span><span class="br0">&#93;</span>::WaitForPendingFinalizers<span class="br0">&#40;</span><span class="br0">&#41;</span>
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Script has been aborted&quot;</span>
	<a href="about:blank"><span class="kw6">$ErrorActionPreference</span></a> <span class="sy0">=</span> <span class="re0">$SaveEAPreference</span>
	Exit
<span class="br0">&#125;</span>
<span class="co1">#endregion</span>
&nbsp;
<span class="co1">#region script setup function</span>
<span class="kw3">Function</span> ProcessScriptSetup
<span class="br0">&#123;</span>
	<span class="re0">$script</span>:startTime <span class="sy0">=</span> <span class="kw1">Get-Date</span>
&nbsp;
	<span class="re0">$ComputerName</span> <span class="sy0">=</span> TestComputerName <span class="re0">$ComputerName</span>
<span class="br0">&#125;</span>
<span class="co1">#endregion</span>
&nbsp;
<span class="co1">#region script core</span>
<span class="co1">#Script begins</span>
&nbsp;
ProcessScriptSetup
&nbsp;
&nbsp;
<span class="co1">###REPLACE AFTER THIS SECTION WITH YOUR SCRIPT###</span>
&nbsp;
<span class="co1">###The function SetFileName1andFileName2 needs your script output filename###</span>
SetFileName1andFileName2 <span class="st0">'InventoryScript'</span>
&nbsp;
<span class="co1">###change title for your report###</span>
<span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span><span class="re0">$Script</span>:Title <span class="sy0">=</span> <span class="st0">'System Center 2012 R2 Configuration Manager Documentation Script for {0}'</span> <span class="kw4">-f</span> <span class="re0">$CompanyName</span>;
&nbsp;
<span class="co1">###REPLACE AFTER THIS SECTION WITH YOUR SCRIPT###</span>
&nbsp;
<span class="kw3">Function</span> Read<span class="sy0">-</span>ScheduleToken <span class="br0">&#123;</span>
&nbsp;
  <span class="re0">$SMS_ScheduleMethods</span> <span class="sy0">=</span> <span class="st0">'SMS_ScheduleMethods'</span>
  <span class="re0">$class_SMS_ScheduleMethods</span> <span class="sy0">=</span> <span class="br0">&#91;</span><span class="re3">wmiclass</span><span class="br0">&#93;</span><span class="st0">''</span>
  <span class="re0">$class_SMS_ScheduleMethods</span>.psbase.Path <span class="sy0">=</span><span class="st0">&quot;ROOT\SMS\Site_$($SiteCode):$($SMS_ScheduleMethods)&quot;</span>
&nbsp;
  <span class="re0">$script</span>:ScheduleString <span class="sy0">=</span> <span class="re0">$class_SMS_ScheduleMethods</span>.ReadFromString<span class="br0">&#40;</span><span class="re0">$ServiceWindow</span>.ServiceWindowSchedules<span class="br0">&#41;</span>
  <span class="kw3">return</span> <span class="re0">$ScheduleString</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw3">Function</span> Convert<span class="sy0">-</span>WeekDay <span class="br0">&#123;</span>
  <span class="br0">&#91;</span>CmdletBinding<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#93;</span>
  <span class="kw3">param</span> <span class="br0">&#40;</span>
    <span class="br0">&#91;</span>parameter<span class="br0">&#40;</span>Mandatory<span class="sy0">=</span><span class="re0">$true</span><span class="sy0">,</span> ValueFromPipeline<span class="sy0">=</span><span class="re0">$true</span><span class="br0">&#41;</span><span class="br0">&#93;</span>
    <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span><span class="re0">$Day</span>
  <span class="br0">&#41;</span>
  <span class="co1">### day of week</span>
  <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$Day</span><span class="br0">&#41;</span>
  <span class="br0">&#123;</span>
    <span class="nu0">1</span> <span class="br0">&#123;</span><span class="re0">$weekday</span> <span class="sy0">=</span> <span class="st0">'Sunday'</span><span class="br0">&#125;</span>
    <span class="nu0">2</span> <span class="br0">&#123;</span><span class="re0">$weekday</span> <span class="sy0">=</span> <span class="st0">'Monday'</span><span class="br0">&#125;</span>
    <span class="nu0">3</span> <span class="br0">&#123;</span><span class="re0">$weekday</span> <span class="sy0">=</span> <span class="st0">'Tuesday'</span><span class="br0">&#125;</span>
    <span class="nu0">4</span> <span class="br0">&#123;</span><span class="re0">$weekday</span> <span class="sy0">=</span> <span class="st0">'Wednesday'</span><span class="br0">&#125;</span>
    <span class="nu0">5</span> <span class="br0">&#123;</span><span class="re0">$weekday</span> <span class="sy0">=</span> <span class="st0">'Thursday'</span><span class="br0">&#125;</span>
    <span class="nu0">6</span> <span class="br0">&#123;</span><span class="re0">$weekday</span> <span class="sy0">=</span> <span class="st0">'Friday'</span><span class="br0">&#125;</span>
    <span class="nu0">7</span> <span class="br0">&#123;</span><span class="re0">$weekday</span> <span class="sy0">=</span> <span class="st0">'Saturday'</span><span class="br0">&#125;</span>
  <span class="br0">&#125;</span>
  <span class="kw3">return</span> <span class="re0">$weekday</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw3">Function</span> Convert<span class="sy0">-</span>Time <span class="br0">&#123;</span>
  <span class="kw3">param</span> <span class="br0">&#40;</span>
    <span class="br0">&#91;</span><span class="re3">int</span><span class="br0">&#93;</span><span class="re0">$time</span>
  <span class="br0">&#41;</span>
  <span class="re0">$min</span> <span class="sy0">=</span> <span class="re0">$time</span> <span class="sy0">%</span> <span class="nu0">60</span>
  <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$min</span> <span class="kw4">-le</span> <span class="nu0">9</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><span class="re0">$min</span> <span class="sy0">=</span> <span class="st0">&quot;0$($min)&quot;</span> <span class="br0">&#125;</span>
  <span class="re0">$hrs</span> <span class="sy0">=</span> <span class="br0">&#91;</span>Math<span class="br0">&#93;</span>::Truncate<span class="br0">&#40;</span><span class="re0">$time</span><span class="sy0">/</span><span class="nu0">60</span><span class="br0">&#41;</span>
&nbsp;
  <span class="re0">$NewTime</span> <span class="sy0">=</span> <span class="st0">&quot;$($hrs):$($min)&quot;</span>
  <span class="kw3">return</span> <span class="re0">$NewTime</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw3">Function</span> Get<span class="sy0">-</span>SiteCode
<span class="br0">&#123;</span>
  <span class="re0">$wqlQuery</span> <span class="sy0">=</span> <span class="st0">'SELECT * FROM SMS_ProviderLocation'</span>
  <span class="re0">$a</span> <span class="sy0">=</span> <span class="kw1">Get-WmiObject</span> <span class="kw5">-Query</span> <span class="re0">$wqlQuery</span> <span class="kw5">-Namespace</span> <span class="st0">'root\sms'</span> <span class="kw5">-ComputerName</span> <span class="re0">$SMSProvider</span>
  <span class="re0">$a</span> <span class="sy0">|</span> <span class="kw1">ForEach-Object</span> <span class="br0">&#123;</span>
    <span class="kw3">if</span><span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a>.ProviderForLocalSite<span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
      <span class="re0">$script</span>:SiteCode <span class="sy0">=</span> <a href="about:blank"><span class="kw6">$_</span></a>.SiteCode
    <span class="br0">&#125;</span>
  <span class="br0">&#125;</span>
  <span class="kw3">return</span> <span class="re0">$SiteCode</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw3">function</span> Get<span class="sy0">-</span>ExecuteWqlQuery
<span class="br0">&#123;</span>
  <span class="kw3">param</span>
  <span class="br0">&#40;</span>
    <span class="br0">&#91;</span>System.Object<span class="br0">&#93;</span>
    <span class="re0">$siteServerName</span><span class="sy0">,</span>
&nbsp;
    <span class="br0">&#91;</span>System.Object<span class="br0">&#93;</span>
    <span class="re0">$query</span>
  <span class="br0">&#41;</span>
&nbsp;
  <span class="re0">$returnValue</span> <span class="sy0">=</span> <span class="re0">$null</span>
  <span class="re0">$connectionManager</span> <span class="sy0">=</span> <span class="kw1">New-Object</span> Microsoft.ConfigurationManagement.ManagementProvider.WqlQueryEngine.WqlConnectionManager
&nbsp;
  <span class="kw3">if</span><span class="br0">&#40;</span><span class="re0">$connectionManager</span>.Connect<span class="br0">&#40;</span><span class="re0">$siteServerName</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
  <span class="br0">&#123;</span>
    <span class="re0">$result</span> <span class="sy0">=</span> <span class="re0">$connectionManager</span>.QueryProcessor.ExecuteQuery<span class="br0">&#40;</span><span class="re0">$query</span><span class="br0">&#41;</span>
&nbsp;
    <span class="kw3">foreach</span><span class="br0">&#40;</span><span class="re0">$i</span> <span class="kw3">in</span> <span class="re0">$result</span>.GetEnumerator<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
      <span class="re0">$returnValue</span> <span class="sy0">=</span> <span class="re0">$i</span>
      <span class="kw3">break</span>
    <span class="br0">&#125;</span>
&nbsp;
    <span class="re0">$connectionManager</span>.Dispose<span class="br0">&#40;</span><span class="br0">&#41;</span> 
  <span class="br0">&#125;</span>
&nbsp;
  <span class="re0">$returnValue</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw3">function</span> Get<span class="sy0">-</span>ApplicationObjectFromServer
<span class="br0">&#123;</span>
  <span class="kw3">param</span>
  <span class="br0">&#40;</span>
    <span class="br0">&#91;</span>System.Object<span class="br0">&#93;</span>
    <span class="re0">$appName</span><span class="sy0">,</span>
&nbsp;
    <span class="br0">&#91;</span>System.Object<span class="br0">&#93;</span>
    <span class="re0">$siteServerName</span>
  <span class="br0">&#41;</span>
&nbsp;
  <span class="re0">$resultObject</span> <span class="sy0">=</span> Get<span class="sy0">-</span>ExecuteWqlQuery <span class="re0">$siteServerName</span> <span class="st0">'select thissitecode from sms_identification'</span> 
  <span class="re0">$siteCode</span> <span class="sy0">=</span> <span class="re0">$resultObject</span><span class="br0">&#91;</span><span class="st0">'thissitecode'</span><span class="br0">&#93;</span>.StringValue
&nbsp;
  <span class="re0">$path</span> <span class="sy0">=</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::Format<span class="br0">&#40;</span><span class="st0">'\\{0}\ROOT\sms\site_{1}'</span><span class="sy0">,</span> <span class="re0">$siteServerName</span><span class="sy0">,</span> <span class="re0">$siteCode</span><span class="br0">&#41;</span>
  <span class="re0">$scope</span> <span class="sy0">=</span> <span class="kw1">New-Object</span> System.Management.ManagementScope <span class="kw5">-ArgumentList</span> <span class="re0">$path</span>
&nbsp;
  <span class="re0">$query</span> <span class="sy0">=</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::Format<span class="br0">&#40;</span><span class="st0">&quot;select * from sms_application where LocalizedDisplayName='{0}' AND ISLatest='true'&quot;</span><span class="sy0">,</span> <span class="re0">$appName</span>.Trim<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
&nbsp;
  <span class="re0">$oQuery</span> <span class="sy0">=</span> <span class="kw1">New-Object</span> System.Management.ObjectQuery <span class="kw5">-ArgumentList</span> <span class="re0">$query</span>
  <span class="re0">$obectSearcher</span> <span class="sy0">=</span> <span class="kw1">New-Object</span> System.Management.ManagementObjectSearcher <span class="kw5">-ArgumentList</span> <span class="re0">$scope</span><span class="sy0">,</span><span class="re0">$oQuery</span>
  <span class="re0">$applicationFoundInCollection</span> <span class="sy0">=</span> <span class="re0">$obectSearcher</span>.Get<span class="br0">&#40;</span><span class="br0">&#41;</span>    
  <span class="re0">$applicationFoundInCollectionEnumerator</span> <span class="sy0">=</span> <span class="re0">$applicationFoundInCollection</span>.GetEnumerator<span class="br0">&#40;</span><span class="br0">&#41;</span>
&nbsp;
  <span class="kw3">if</span><span class="br0">&#40;</span><span class="re0">$applicationFoundInCollectionEnumerator</span>.MoveNext<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
  <span class="br0">&#123;</span>
    <span class="re0">$returnValue</span> <span class="sy0">=</span> <span class="re0">$applicationFoundInCollectionEnumerator</span>.Current
    <span class="re0">$getResult</span> <span class="sy0">=</span> <span class="re0">$returnValue</span>.Get<span class="br0">&#40;</span><span class="br0">&#41;</span>        
    <span class="re0">$sdmPackageXml</span> <span class="sy0">=</span> <span class="re0">$returnValue</span>.Properties<span class="br0">&#91;</span><span class="st0">'SDMPackageXML'</span><span class="br0">&#93;</span>.Value.ToString<span class="br0">&#40;</span><span class="br0">&#41;</span>
    <span class="br0">&#91;</span>Microsoft.ConfigurationManagement.ApplicationManagement.Serialization.SccmSerializer<span class="br0">&#93;</span>::DeserializeFromString<span class="br0">&#40;</span><span class="re0">$sdmPackageXml</span><span class="br0">&#41;</span>
  <span class="br0">&#125;</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="kw3">function</span> Load<span class="sy0">-</span>ConfigMgrAssemblies<span class="br0">&#40;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
&nbsp;
  <span class="re0">$AdminConsoleDirectory</span> <span class="sy0">=</span> <span class="kw1">Split-Path</span> <span class="re0">$env</span>:SMS_ADMIN_UI_PATH <span class="kw5">-Parent</span>
  <span class="re0">$filesToLoad</span> <span class="sy0">=</span> <span class="st0">'Microsoft.ConfigurationManagement.ApplicationManagement.dll'</span><span class="sy0">,</span><span class="st0">'AdminUI.WqlQueryEngine.dll'</span><span class="sy0">,</span> <span class="st0">'AdminUI.DcmObjectWrapper.dll'</span> 
&nbsp;
  <span class="kw1">Set-Location</span> <span class="re0">$AdminConsoleDirectory</span>
  <span class="br0">&#91;</span>System.IO.Directory<span class="br0">&#93;</span>::SetCurrentDirectory<span class="br0">&#40;</span><span class="re0">$AdminConsoleDirectory</span><span class="br0">&#41;</span>
&nbsp;
  <span class="kw3">foreach</span><span class="br0">&#40;</span><span class="re0">$fileName</span> <span class="kw3">in</span> <span class="re0">$filesToLoad</span><span class="br0">&#41;</span>
  <span class="br0">&#123;</span>
    <span class="re0">$fullAssemblyName</span> <span class="sy0">=</span> <span class="br0">&#91;</span>System.IO.Path<span class="br0">&#93;</span>::Combine<span class="br0">&#40;</span><span class="re0">$AdminConsoleDirectory</span><span class="sy0">,</span> <span class="re0">$fileName</span><span class="br0">&#41;</span>
    <span class="kw3">if</span><span class="br0">&#40;</span><span class="br0">&#91;</span>System.IO.File<span class="br0">&#93;</span>::Exists<span class="br0">&#40;</span><span class="re0">$fullAssemblyName</span> <span class="br0">&#41;</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>   
      <span class="re0">$FileLoaded</span> <span class="sy0">=</span> <span class="br0">&#91;</span>Reflection.Assembly<span class="br0">&#93;</span>::<span class="re5">LoadFrom</span><span class="br0">&#40;</span><span class="re0">$fullAssemblyName</span> <span class="br0">&#41;</span>
    <span class="br0">&#125;</span>
    <span class="kw3">else</span>
    <span class="br0">&#123;</span>
      <span class="kw1">Write-Output</span> <span class="br0">&#40;</span><span class="br0">&#91;</span>System.String<span class="br0">&#93;</span>::Format<span class="br0">&#40;</span><span class="st0">'File not found {0}'</span><span class="sy0">,</span><span class="re0">$fileName</span> <span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw5">-backgroundcolor</span> <span class="st0">'red'</span>
    <span class="br0">&#125;</span>
  <span class="br0">&#125;</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="re0">$SiteCode</span> <span class="sy0">=</span> Get<span class="sy0">-</span>SiteCode
&nbsp;
<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Start writing report data&quot;</span>
&nbsp;
<span class="re0">$LocationBeforeExecution</span> <span class="sy0">=</span> <span class="kw1">Get-Location</span>
&nbsp;
<span class="re0">$Script</span>:selection.InsertNewPage<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="sy0">|</span> <span class="kw1">Out-Null</span>
&nbsp;
<span class="co1">#Import the CM12 Powershell cmdlets</span>
<span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#40;</span><span class="kw1">Test-Path</span> <span class="kw5">-Path</span> <span class="re0">$SiteCode</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
  <span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date):   CM12 module has not been imported yet, will import it now.&quot;</span>
  Import<span class="sy0">-</span>Module <span class="br0">&#40;</span><span class="re0">$env</span>:SMS_ADMIN_UI_PATH.Substring<span class="br0">&#40;</span><span class="nu0">0</span><span class="sy0">,</span><span class="re0">$env</span>:SMS_ADMIN_UI_PATH.Length – <span class="nu0">5</span><span class="br0">&#41;</span> <span class="sy0">+</span> <span class="st0">'\ConfigurationManager.psd1'</span><span class="br0">&#41;</span> <span class="sy0">|</span> <span class="kw1">Out-Null</span>
<span class="br0">&#125;</span>
<span class="co1">#CM12 cmdlets need to be run from the CM12 drive</span>
<span class="kw1">Set-Location</span> <span class="st0">&quot;$($SiteCode):&quot;</span> <span class="sy0">|</span> <span class="kw1">Out-Null</span>
<span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#40;</span><span class="kw1">Get-PSDrive</span> <span class="kw5">-Name</span> <span class="re0">$SiteCode</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
  <span class="kw1">Write-Error</span> <span class="st0">&quot;There was a problem loading the Configuration Manager powershell module and accessing the site's PSDrive.&quot;</span>
  exit <span class="nu0">1</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="co1">#### Administration</span>
<span class="co1">#### Site Configuration</span>
&nbsp;
WriteWordLine <span class="nu0">1</span> <span class="nu0">0</span> <span class="st0">'Summary of all Sites in this Hierarchy'</span>
<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date):   Getting Site Information&quot;</span>
<span class="re0">$CMSites</span> <span class="sy0">=</span> Get<span class="sy0">-</span>CMSite
&nbsp;
<span class="re0">$CAS</span>                    <span class="sy0">=</span> <span class="re0">$CMSites</span> <span class="sy0">|</span> <span class="kw1">Where-Object</span> <span class="br0">&#123;</span><a href="about:blank"><span class="kw6">$_</span></a>.<span class="kw2">Type</span> <span class="kw4">-eq</span> <span class="nu0">4</span><span class="br0">&#125;</span>
<span class="re0">$ChildPrimarySites</span>      <span class="sy0">=</span> <span class="re0">$CMSites</span> <span class="sy0">|</span> <span class="kw1">Where-Object</span> <span class="br0">&#123;</span><a href="about:blank"><span class="kw6">$_</span></a>.<span class="kw2">Type</span> <span class="kw4">-eq</span> <span class="nu0">3</span><span class="br0">&#125;</span>
<span class="re0">$StandAlonePrimarySite</span>  <span class="sy0">=</span> <span class="re0">$CMSites</span> <span class="sy0">|</span> <span class="kw1">Where-Object</span> <span class="br0">&#123;</span><a href="about:blank"><span class="kw6">$_</span></a>.<span class="kw2">Type</span> <span class="kw4">-eq</span> <span class="nu0">2</span><span class="br0">&#125;</span>
<span class="re0">$SecondarySites</span>         <span class="sy0">=</span> <span class="re0">$CMSites</span> <span class="sy0">|</span> <span class="kw1">Where-Object</span> <span class="br0">&#123;</span><a href="about:blank"><span class="kw6">$_</span></a>.<span class="kw2">Type</span> <span class="kw4">-eq</span> <span class="nu0">1</span><span class="br0">&#125;</span>
&nbsp;
<span class="co1">#region CAS</span>
<span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$CAS</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
  WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">'The following Central Administration Site is installed:'</span>
  <span class="re0">$CAS</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#123;</span><span class="st0">'Site Name'</span> <span class="sy0">=</span> <span class="re0">$CAS</span>.SiteName; <span class="st0">'Site Code'</span> <span class="sy0">=</span> <span class="re0">$CAS</span>.SiteCode; Version <span class="sy0">=</span> <span class="re0">$CAS</span>.Version <span class="br0">&#125;</span>;
&nbsp;
  <span class="re0">$Table</span> <span class="sy0">=</span> AddWordTable <span class="sy0">-</span>Hashtable <span class="re0">$CAS</span> <span class="kw5">-Format</span> <span class="sy0">-</span><span class="nu0">155</span> <span class="sy0">-</span>AutoFit <span class="re0">$wdAutoFitFixed</span>;
&nbsp;
  <span class="co1">## Set first column format</span>
  SetWordCellFormat <span class="sy0">-</span>Collection <span class="re0">$Table</span>.Rows.Item<span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>.Cells <span class="sy0">-</span>Bold <span class="kw5">-BackgroundColor</span> <span class="re0">$wdColorGray15</span>;
&nbsp;
  <span class="co1">## IB - set column widths without recursion</span>
  <span class="re0">$Table</span>.Columns.Item<span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>.Width <span class="sy0">=</span> <span class="nu0">100</span>;
  <span class="re0">$Table</span>.Columns.Item<span class="br0">&#40;</span><span class="nu0">2</span><span class="br0">&#41;</span>.Width <span class="sy0">=</span> <span class="nu0">170</span>;
&nbsp;
  <span class="re0">$Table</span>.Rows.SetLeftIndent<span class="br0">&#40;</span><span class="re0">$Indent1TabStops</span><span class="sy0">,</span><span class="re0">$wdAdjustProportional</span><span class="br0">&#41;</span>
  <span class="re0">$Table</span>.AutoFitBehavior<span class="br0">&#40;</span><span class="re0">$wdAutoFitFixed</span><span class="br0">&#41;</span>
&nbsp;
  FindWordDocumentEnd
  <span class="re0">$Table</span> <span class="sy0">=</span> <span class="re0">$Null</span>
<span class="br0">&#125;</span>
<span class="kw3">else</span> <span class="br0">&#123;</span>
    WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">'No'</span> <span class="kw5">-nonewline</span>
    WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">' CAS'</span> <span class="sy0">-</span>boldface <span class="re0">$true</span> <span class="kw5">-nonewline</span>
    WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">' detected. Continue with Primary Sites.'</span>
<span class="br0">&#125;</span>
<span class="co1">#endregion CAS</span>
&nbsp;
<span class="co1">#region Child Primary Sites</span>
<span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$ChildPrimarySites</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
  <span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date):   Enumerating all child Primary Site.&quot;</span>
  WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">'The following child Primary Sites are installed:'</span>
  <span class="re0">$StandAlonePrimarySite</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#123;</span><span class="st0">'Site Name'</span> <span class="sy0">=</span> <span class="re0">$ChildPrimarySites</span>.SiteName; <span class="st0">'Site Code'</span> <span class="sy0">=</span> <span class="re0">$ChildPrimarySites</span>.SiteCode; Version <span class="sy0">=</span> <span class="re0">$ChildPrimarySites</span>.Version <span class="br0">&#125;</span>;
&nbsp;
  <span class="re0">$Table</span> <span class="sy0">=</span> AddWordTable <span class="sy0">-</span>Hashtable <span class="re0">$ChildPrimarySites</span> <span class="kw5">-Format</span> <span class="sy0">-</span><span class="nu0">155</span> <span class="sy0">-</span>AutoFit <span class="re0">$wdAutoFitFixed</span>;
&nbsp;
  <span class="co1">## Set first column format</span>
  SetWordCellFormat <span class="sy0">-</span>Collection <span class="re0">$Table</span>.Rows.Item<span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>.Cells <span class="sy0">-</span>Bold <span class="kw5">-BackgroundColor</span> <span class="re0">$wdColorGray15</span>;
&nbsp;
  <span class="co1">## IB - set column widths without recursion</span>
  <span class="re0">$Table</span>.Columns.Item<span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>.Width <span class="sy0">=</span> <span class="nu0">100</span>;
  <span class="re0">$Table</span>.Columns.Item<span class="br0">&#40;</span><span class="nu0">2</span><span class="br0">&#41;</span>.Width <span class="sy0">=</span> <span class="nu0">170</span>;
&nbsp;
  <span class="re0">$Table</span>.Rows.SetLeftIndent<span class="br0">&#40;</span><span class="re0">$Indent1TabStops</span><span class="sy0">,</span><span class="re0">$wdAdjustProportional</span><span class="br0">&#41;</span>
  <span class="re0">$Table</span>.AutoFitBehavior<span class="br0">&#40;</span><span class="re0">$wdAutoFitFixed</span><span class="br0">&#41;</span>
&nbsp;
  FindWordDocumentEnd
  <span class="re0">$Table</span> <span class="sy0">=</span> <span class="re0">$Null</span>
<span class="br0">&#125;</span>
<span class="co1">#endregion Child Primary Sites</span>
&nbsp;
<span class="co1">#region Standalone Primary</span>
<span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$StandAlonePrimarySite</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
  <span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date):   Enumerating a standalone Primary Site.&quot;</span>
  WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">'The following Primary Site is installed:'</span>
  <span class="re0">$SiteCULevel</span> <span class="sy0">=</span> <span class="br0">&#40;</span>Invoke<span class="sy0">-</span>Command <span class="kw5">-ComputerName</span> $<span class="br0">&#40;</span>Get<span class="sy0">-</span>CMSiteRole <span class="sy0">-</span>RoleName <span class="st0">'SMS Site Server'</span><span class="br0">&#41;</span>.NALPath.tostring<span class="br0">&#40;</span><span class="br0">&#41;</span>.split<span class="br0">&#40;</span><span class="st0">'\\'</span><span class="br0">&#41;</span><span class="br0">&#91;</span><span class="nu0">2</span><span class="br0">&#93;</span> <span class="sy0">-</span>ScriptBlock <span class="br0">&#123;</span><span class="kw1">Get-ItemProperty</span> <span class="kw5">-Path</span> registry::hklm\software\microsoft\sms\setup <span class="sy0">|</span> <span class="kw1">Select-Object</span> CULevel<span class="br0">&#125;</span> <span class="kw5">-ErrorAction</span> SilentlyContinue <span class="br0">&#41;</span>.CULevel
  <span class="re0">$StandAlonePrimarySite</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#123;</span><span class="st0">'Site Name'</span> <span class="sy0">=</span> <span class="re0">$StandAlonePrimarySite</span>.SiteName; <span class="st0">'Site Code'</span> <span class="sy0">=</span> <span class="re0">$StandAlonePrimarySite</span>.SiteCode; Version <span class="sy0">=</span> <span class="re0">$StandAlonePrimarySite</span>.Version; <span class="st0">'CU Installed'</span> <span class="sy0">=</span> <span class="re0">$SiteCULevel</span> <span class="br0">&#125;</span>;
&nbsp;
  <span class="re0">$Table</span> <span class="sy0">=</span> AddWordTable <span class="sy0">-</span>Hashtable <span class="re0">$StandAlonePrimarySite</span> <span class="kw5">-Format</span> <span class="sy0">-</span><span class="nu0">155</span> <span class="sy0">-</span>AutoFit <span class="re0">$wdAutoFitFixed</span>;
&nbsp;
  <span class="co1">## Set first column format</span>
  SetWordCellFormat <span class="sy0">-</span>Collection <span class="re0">$Table</span>.Rows.Item<span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>.Cells <span class="sy0">-</span>Bold <span class="kw5">-BackgroundColor</span> <span class="re0">$wdColorGray15</span>;
&nbsp;
  <span class="co1">## IB - set column widths without recursion</span>
  <span class="re0">$Table</span>.Columns.Item<span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>.Width <span class="sy0">=</span> <span class="nu0">100</span>;
  <span class="re0">$Table</span>.Columns.Item<span class="br0">&#40;</span><span class="nu0">2</span><span class="br0">&#41;</span>.Width <span class="sy0">=</span> <span class="nu0">170</span>;
&nbsp;
  <span class="re0">$Table</span>.Rows.SetLeftIndent<span class="br0">&#40;</span><span class="re0">$Indent1TabStops</span><span class="sy0">,</span><span class="re0">$wdAdjustProportional</span><span class="br0">&#41;</span>
  <span class="re0">$Table</span>.AutoFitBehavior<span class="br0">&#40;</span><span class="re0">$wdAutoFitFixed</span><span class="br0">&#41;</span>
&nbsp;
  FindWordDocumentEnd
  <span class="re0">$Table</span> <span class="sy0">=</span> <span class="re0">$Null</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="co1">#endregion Standalone Primary</span>
&nbsp;
<span class="co1">#region Secondary Sites</span>
<span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$SecondarySites</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
  <span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date):   Enumerating all secondary sites.&quot;</span>
  WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">'The following Secondary Sites are installed:'</span>
  <span class="re0">$SecondarySites</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#123;</span><span class="st0">'Site Name'</span> <span class="sy0">=</span> <span class="re0">$SecondarySites</span>.SiteName; <span class="st0">'Site Code'</span> <span class="sy0">=</span> <span class="re0">$SecondarySites</span>.SiteCode; Version <span class="sy0">=</span> <span class="re0">$SecondarySites</span>.Version <span class="br0">&#125;</span>;
&nbsp;
  <span class="re0">$Table</span> <span class="sy0">=</span> AddWordTable <span class="sy0">-</span>Hashtable <span class="re0">$SecondarySites</span> <span class="kw5">-Format</span> <span class="sy0">-</span><span class="nu0">155</span> <span class="sy0">-</span>AutoFit <span class="re0">$wdAutoFitFixed</span>;
&nbsp;
  <span class="co1">## Set first column format</span>
  SetWordCellFormat <span class="sy0">-</span>Collection <span class="re0">$Table</span>.Rows.Item<span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>.Cells <span class="sy0">-</span>Bold <span class="kw5">-BackgroundColor</span> <span class="re0">$wdColorGray15</span>;
&nbsp;
  <span class="co1">## IB - set column widths without recursion</span>
  <span class="re0">$Table</span>.Columns.Item<span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>.Width <span class="sy0">=</span> <span class="nu0">100</span>;
  <span class="re0">$Table</span>.Columns.Item<span class="br0">&#40;</span><span class="nu0">2</span><span class="br0">&#41;</span>.Width <span class="sy0">=</span> <span class="nu0">170</span>;
&nbsp;
  <span class="re0">$Table</span>.Rows.SetLeftIndent<span class="br0">&#40;</span><span class="re0">$Indent1TabStops</span><span class="sy0">,</span><span class="re0">$wdAdjustProportional</span><span class="br0">&#41;</span>
  <span class="re0">$Table</span>.AutoFitBehavior<span class="br0">&#40;</span><span class="re0">$wdAutoFitFixed</span><span class="br0">&#41;</span>
&nbsp;
  FindWordDocumentEnd
  <span class="re0">$Table</span> <span class="sy0">=</span> <span class="re0">$Null</span>
<span class="br0">&#125;</span>
<span class="co1">#endregion Secondary Sites</span>
&nbsp;
<span class="co1">#region Site Configuration report</span>
&nbsp;
<span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$CMSite</span> <span class="kw3">in</span> <span class="re0">$CMSites</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>  
  <span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date):   Checking each site's configuration.&quot;</span>
  WriteWordLine <span class="nu0">1</span> <span class="nu0">0</span> <span class="st0">&quot;Configuration Summary for Site $($CMSite.SiteCode)&quot;</span>
  WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>   
&nbsp;
  <span class="re0">$SiteRoleWordTable</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#40;</span><span class="br0">&#41;</span>  
  <span class="re0">$SiteRoles</span> <span class="sy0">=</span> Get<span class="sy0">-</span>CMSiteRole <span class="sy0">-</span>SiteCode <span class="re0">$CMSite</span>.SiteCode <span class="sy0">|</span> <span class="kw1">Select-Object</span> <span class="kw5">-Property</span> NALPath<span class="sy0">,</span> rolename
&nbsp;
  WriteWordLine <span class="nu0">2</span> <span class="nu0">0</span> <span class="st0">'Site Roles'</span>
  WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">'The following Site Roles are installed in this site:'</span>
  <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$SiteRole</span> <span class="kw3">in</span> <span class="re0">$SiteRoles</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#40;</span><span class="br0">&#40;</span><span class="re0">$SiteRole</span>.rolename <span class="kw4">-eq</span> <span class="st0">'SMS Component Server'</span><span class="br0">&#41;</span> <span class="kw4">-or</span> <span class="br0">&#40;</span><span class="re0">$SiteRole</span>.rolename <span class="kw4">-eq</span> <span class="st0">'SMS Site System'</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="re0">$SiteRoleRowHash</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#123;</span><span class="st0">'Server Name'</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="re0">$SiteRole</span>.NALPath<span class="br0">&#41;</span>.ToString<span class="br0">&#40;</span><span class="br0">&#41;</span>.Split<span class="br0">&#40;</span><span class="st0">'\\'</span><span class="br0">&#41;</span><span class="br0">&#91;</span><span class="nu0">2</span><span class="br0">&#93;</span>; <span class="st0">'Role'</span> <span class="sy0">=</span> <span class="re0">$SiteRole</span>.RoleName<span class="br0">&#125;</span>
        <span class="re0">$SiteRoleWordTable</span> <span class="sy0">+=</span> <span class="re0">$SiteRoleRowHash</span>
    <span class="br0">&#125;</span>
  <span class="br0">&#125;</span>
&nbsp;
  <span class="re0">$Table</span> <span class="sy0">=</span> AddWordTable <span class="sy0">-</span>Hashtable <span class="re0">$SiteRoleWordTable</span> <span class="kw5">-Format</span> <span class="sy0">-</span><span class="nu0">155</span> <span class="sy0">-</span>AutoFit <span class="re0">$wdAutoFitContent</span>
&nbsp;
  <span class="co1">## Set first column format</span>
  SetWordCellFormat <span class="sy0">-</span>Collection <span class="re0">$Table</span>.Rows.Item<span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>.Cells <span class="sy0">-</span>Bold <span class="kw5">-BackgroundColor</span> <span class="re0">$wdColorGray1</span> <span class="sy0">-</span>Underline <span class="sy0">-</span>Italic
&nbsp;
  FindWordDocumentEnd
  <span class="re0">$Table</span> <span class="sy0">=</span> <span class="re0">$Null</span>
&nbsp;
  <span class="re0">$SiteMaintenanceTaskWordTable</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#40;</span><span class="br0">&#41;</span>
  <span class="re0">$SiteMaintenanceTasks</span> <span class="sy0">=</span> Get<span class="sy0">-</span>CMSiteMaintenanceTask <span class="sy0">-</span>SiteCode <span class="re0">$CMSite</span>.SiteCode
  WriteWordLine <span class="nu0">2</span> <span class="nu0">0</span> <span class="st0">&quot;Site Maintenance Tasks for Site $($CMSite.SiteCode)&quot;</span>
&nbsp;
  <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$SiteMaintenanceTask</span> <span class="kw3">in</span> <span class="re0">$SiteMaintenanceTasks</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="re0">$SiteMaintenanceTaskRowHash</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#123;</span><span class="st0">'Task Name'</span> <span class="sy0">=</span> <span class="re0">$SiteMaintenanceTask</span>.TaskName; Enabled <span class="sy0">=</span> <span class="re0">$SiteMaintenanceTask</span>.Enabled<span class="br0">&#125;</span>;
    <span class="re0">$SiteMaintenanceTaskWordTable</span> <span class="sy0">+=</span> <span class="re0">$SiteMaintenanceTaskRowHash</span>;
  <span class="br0">&#125;</span>
&nbsp;
  <span class="re0">$Table</span> <span class="sy0">=</span> AddWordTable <span class="sy0">-</span>Hashtable <span class="re0">$SiteMaintenanceTaskWordTable</span> <span class="kw5">-Format</span> <span class="sy0">-</span><span class="nu0">155</span> <span class="sy0">-</span>AutoFit <span class="re0">$wdAutoFitContent</span>;
&nbsp;
  <span class="co1">## Set first column format</span>
  SetWordCellFormat <span class="sy0">-</span>Collection <span class="re0">$Table</span>.Rows.Item<span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>.Cells <span class="sy0">-</span>Bold <span class="kw5">-BackgroundColor</span> <span class="re0">$wdColorGray15</span>;
  <span class="coMULTI">&lt;#
  ## IB - set column widths without recursion
  $Table.Columns.Item(1).Width = 100;
  $Table.Columns.Item(2).Width = 170;
&nbsp;
  $Table.Rows.SetLeftIndent($Indent1TabStops,$wdAdjustProportional)
  $Table.AutoFitBehavior($wdAutoFitFixed)
  #&gt;</span>
  FindWordDocumentEnd
  <span class="re0">$Table</span> <span class="sy0">=</span> <span class="re0">$Null</span>
&nbsp;
  <span class="re0">$CMManagementPoints</span> <span class="sy0">=</span> Get<span class="sy0">-</span>CMManagementPoint <span class="sy0">-</span>SiteCode <span class="re0">$CMSite</span>.SiteCode
  WriteWordLine <span class="nu0">2</span> <span class="nu0">1</span> <span class="st0">&quot;Summary of Management Points for Site $($CMSite.SiteCode)&quot;</span>
  <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$CMManagementPoint</span> <span class="kw3">in</span> <span class="re0">$CMManagementPoints</span><span class="br0">&#41;</span>
  <span class="br0">&#123;</span>
    <span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date):   Management Point: $($CMManagementPoint)&quot;</span>
    <span class="re0">$CMMPServerName</span> <span class="sy0">=</span> <span class="re0">$CMManagementPoint</span>.NetworkOSPath.Split<span class="br0">&#40;</span><span class="st0">'\\'</span><span class="br0">&#41;</span><span class="br0">&#91;</span><span class="nu0">2</span><span class="br0">&#93;</span>
    WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">&quot;$($CMMPServerName)&quot;</span>
  <span class="br0">&#125;</span>
&nbsp;
  WriteWordLine <span class="nu0">2</span> <span class="nu0">1</span> <span class="st0">&quot;Summary of Distribution Points for Site $($CMSite.SiteCode)&quot;</span>
  <span class="re0">$CMDistributionPoints</span> <span class="sy0">=</span> Get<span class="sy0">-</span>CMDistributionPoint <span class="sy0">-</span>SiteCode <span class="re0">$CMSite</span>.SiteCode
&nbsp;
  <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$CMDistributionPoint</span> <span class="kw3">in</span> <span class="re0">$CMDistributionPoints</span><span class="br0">&#41;</span>
  <span class="br0">&#123;</span>
    <span class="re0">$CMDPServerName</span> <span class="sy0">=</span> <span class="re0">$CMDistributionPoint</span>.NetworkOSPath.Split<span class="br0">&#40;</span><span class="st0">'\\'</span><span class="br0">&#41;</span><span class="br0">&#91;</span><span class="nu0">2</span><span class="br0">&#93;</span>
    <span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date):   Found DP: $($CMDPServerName)&quot;</span>
    WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">&quot;$($CMDPServerName)&quot;</span> <span class="sy0">-</span>boldface <span class="re0">$true</span>
    <span class="kw1">Write-Verbose</span> <span class="st0">&quot;Trying to ping $($CMDPServerName)&quot;</span>
    <span class="re0">$PingResult</span> <span class="sy0">=</span> Test<span class="sy0">-</span>NetConnection <span class="kw5">-ComputerName</span> <span class="re0">$CMDPServerName</span>
    <span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#40;</span><span class="re0">$PingResult</span>.PingSucceeded<span class="br0">&#41;</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
      WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;The Distribution Point $($CMDPServerName) is not reachable. Check connectivity.&quot;</span>
    <span class="br0">&#125;</span>
    <span class="kw3">else</span>
    <span class="br0">&#123;</span>
      WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Disk information:'</span>
      <span class="re0">$CMDPDrives</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="kw1">Get-WmiObject</span> <span class="kw5">-Class</span> SMS_DistributionPointDriveInfo <span class="kw5">-Namespace</span> root\sms\site_<span class="re0">$SiteCode</span> <span class="kw5">-ComputerName</span> <span class="re0">$SMSProvider</span><span class="br0">&#41;</span>.<span class="kw3">Where</span><span class="br0">&#40;</span><span class="br0">&#123;</span><span class="re0">$PSItem</span>.NALPath <span class="kw4">-like</span> <span class="st0">&quot;*$CMDPServerName*&quot;</span><span class="br0">&#125;</span><span class="br0">&#41;</span>
      <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$CMDPDrive</span> <span class="kw3">in</span> <span class="re0">$CMDPDrives</span><span class="br0">&#41;</span>
      <span class="br0">&#123;</span>
        WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Partition $($CMDPDrive.Drive):&quot;</span> <span class="sy0">-</span>boldface <span class="re0">$true</span>
        <span class="re0">$Size</span> <span class="sy0">=</span> <span class="st0">''</span>
        <span class="re0">$Size</span> <span class="sy0">=</span> <span class="re0">$CMDPDrive</span>.BytesTotal <span class="sy0">/</span> <span class="nu0">1024</span> <span class="sy0">/</span> <span class="nu0">1024</span>
        <span class="re0">$Freesize</span> <span class="sy0">=</span> <span class="st0">''</span>
        <span class="re0">$Freesize</span> <span class="sy0">=</span> <span class="re0">$CMDPDrive</span>.BytesFree <span class="sy0">/</span> <span class="nu0">1024</span> <span class="sy0">/</span> <span class="nu0">1024</span>
&nbsp;
        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;$([MATH]::Round($Size,2)) GB Size in total&quot;</span>
        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;$([MATH]::Round($Freesize,2)) GB Free Space&quot;</span>
        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Still $($CMDPDrive.PercentFree) percent free.&quot;</span>
        WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
      <span class="br0">&#125;</span>
&nbsp;
      WriteWordLine <span class="sy0">-</span>style <span class="nu0">0</span> <span class="sy0">-</span>tabs <span class="nu0">2</span> <span class="kw5">-value</span> <span class="st0">'Hardware Info:'</span> <span class="sy0">-</span>boldface <span class="re0">$true</span>
      try <span class="br0">&#123;</span>
          <span class="re0">$Capacity</span> <span class="sy0">=</span> <span class="nu0">0</span>
          <span class="kw1">Get-WmiObject</span> <span class="kw5">-Class</span> win32_physicalmemory <span class="kw5">-ComputerName</span> <span class="re0">$CMDPServerName</span> <span class="sy0">|</span> <span class="kw1">ForEach-Object</span> <span class="br0">&#123;</span><span class="br0">&#91;</span>int64<span class="br0">&#93;</span><span class="re0">$Capacity</span> <span class="sy0">=</span> <span class="re0">$Capacity</span> <span class="sy0">+</span> <span class="br0">&#91;</span>int64<span class="br0">&#93;</span><a href="about:blank"><span class="kw6">$_</span></a>.Capacity<span class="br0">&#125;</span>
          <span class="re0">$TotalMemory</span> <span class="sy0">=</span> <span class="re0">$Capacity</span> <span class="sy0">/</span> <span class="nu0">1024</span> <span class="sy0">/</span> <span class="nu0">1024</span> <span class="sy0">/</span> <span class="nu0">1024</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;This server has a total of $($TotalMemory) GB RAM.&quot;</span>
      <span class="br0">&#125;</span>
      catch <span class="br0">&#123;</span>
        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Failed to access server $CMDPServerName.&quot;</span> 
        <span class="br0">&#125;</span>
    <span class="br0">&#125;</span>
&nbsp;
    <span class="re0">$DPInfo</span> <span class="sy0">=</span> <span class="re0">$CMDistributionPoint</span>.Props
    <span class="re0">$IsPXE</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="re0">$DPInfo</span>.<span class="kw3">Where</span><span class="br0">&#40;</span><span class="br0">&#123;</span><a href="about:blank"><span class="kw6">$_</span></a>.PropertyName <span class="kw4">-eq</span> <span class="st0">'IsPXE'</span><span class="br0">&#125;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>.Value
    <span class="re0">$UnknownMachines</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="re0">$DPInfo</span>.<span class="kw3">Where</span><span class="br0">&#40;</span><span class="br0">&#123;</span><a href="about:blank"><span class="kw6">$_</span></a>.PropertyName <span class="kw4">-eq</span> <span class="st0">'SupportUnknownMachines'</span><span class="br0">&#125;</span><span class="br0">&#41;</span><span class="br0">&#41;</span>.Value
    <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$IsPXE</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
      <span class="nu0">1</span> 
      <span class="br0">&#123;</span>
        WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'PXE Enabled'</span>
        <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$UnknownMachines</span><span class="br0">&#41;</span>
        <span class="br0">&#123;</span>
          <span class="nu0">1</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Supports unknown machines: true'</span> <span class="br0">&#125;</span>
          <span class="nu0">0</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Supports unknown machines: false'</span> <span class="br0">&#125;</span>
        <span class="br0">&#125;</span>
      <span class="br0">&#125;</span>
      <span class="nu0">0</span>
      <span class="br0">&#123;</span>
        WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'PXE disabled'</span>
      <span class="br0">&#125;</span>
    <span class="br0">&#125;</span>
&nbsp;
    <span class="re0">$DPGroupMembers</span> <span class="sy0">=</span> <span class="re0">$Null</span>
    <span class="re0">$DPGroupIDs</span> <span class="sy0">=</span> <span class="re0">$Null</span>
    <span class="re0">$DPGroupMembers</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="kw1">Get-WmiObject</span> <span class="kw5">-class</span> SMS_DPGroupMembers <span class="kw5">-Namespace</span> root\sms\site_<span class="re0">$SiteCode</span> <span class="kw5">-ComputerName</span> <span class="re0">$SMSProvider</span><span class="br0">&#41;</span>.<span class="kw3">Where</span><span class="br0">&#40;</span><span class="br0">&#123;</span><a href="about:blank"><span class="kw6">$_</span></a>.DPNALPath <span class="kw4">-ilike</span> <span class="st0">&quot;*$($CMDPServerName)*&quot;</span><span class="br0">&#125;</span><span class="br0">&#41;</span>;
    <span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$DPGroupMembers</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
      <span class="re0">$DPGroupIDs</span> <span class="sy0">=</span> <span class="re0">$DPGroupMembers</span>.GroupID
    <span class="br0">&#125;</span>
&nbsp;
    <span class="co1">#enumerating DP Group Membership</span>
    <span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$DPGroupIDs</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
      WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">'This Distribution Point is a member of the following DP Groups:'</span>
      <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$DPGroupID</span> <span class="kw3">in</span> <span class="re0">$DPGroupIDs</span><span class="br0">&#41;</span>
      <span class="br0">&#123;</span>
        <span class="re0">$DPGroupName</span> <span class="sy0">=</span> <span class="br0">&#40;</span>Get<span class="sy0">-</span>CMDistributionPointGroup <span class="kw5">-Id</span> <span class="st0">&quot;$($DPGroupID)&quot;</span><span class="br0">&#41;</span>.Name
        WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;$($DPGroupName)&quot;</span>
      <span class="br0">&#125;</span>
    <span class="br0">&#125;</span>
    <span class="kw3">else</span>
    <span class="br0">&#123;</span>
      WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">'This Distribution Point is not a member of any DP Group.'</span>
    <span class="br0">&#125;</span>
  <span class="br0">&#125;</span>
  <span class="co1">#enumerating Software Update Points</span>
  <span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date):   Enumerating all Software Update Points&quot;</span>
  WriteWordLine <span class="nu0">2</span> <span class="nu0">1</span> <span class="st0">&quot;Summary of Software Update Point Servers for Site $($CMSite.SiteCode)&quot;</span>
  <span class="re0">$CMSUPs</span> <span class="sy0">=</span> <span class="kw1">Get-WmiObject</span> <span class="kw5">-Class</span> sms_sci_sysresuse <span class="kw5">-Namespace</span> root\sms\site_$<span class="br0">&#40;</span><span class="re0">$CMSite</span>.SiteCode<span class="br0">&#41;</span> <span class="kw5">-ComputerName</span> <span class="re0">$CMMPServerName</span> <span class="sy0">|</span> <span class="kw1">Where-Object</span> <span class="br0">&#123;</span><a href="about:blank"><span class="kw6">$_</span></a>.rolename <span class="kw4">-eq</span> <span class="st0">'SMS Software Update Point'</span><span class="br0">&#125;</span>
  <span class="co1">#$CMSUPs = (Get-CMSoftwareUpdatePoint).Where({$_.SiteCode -eq &quot;$($CMSite.SiteCode)&quot;})</span>
  <span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$CMSUPs</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
  <span class="br0">&#123;</span>
    <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$CMSUP</span> <span class="kw3">in</span> <span class="re0">$CMSUPs</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
      <span class="re0">$SUPHashTable</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
      <span class="re0">$CMSUPServerName</span> <span class="sy0">=</span> <span class="re0">$CMSUP</span>.NetworkOSPath.split<span class="br0">&#40;</span><span class="st0">'\\'</span><span class="br0">&#41;</span><span class="br0">&#91;</span><span class="nu0">2</span><span class="br0">&#93;</span>
      <span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date):   Found SUP: $($CMSUPServerName)&quot;</span>
      WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">&quot;$($CMSUPServerName)&quot;</span>
      <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$SUPProp</span> <span class="kw3">in</span> <span class="re0">$CMSUP</span>.Props<span class="br0">&#41;</span> <span class="br0">&#123;</span>
        <span class="re0">$SUPHash</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#123;</span>Value2 <span class="sy0">=</span> <span class="re0">$SUPProp</span>.Value2; Value1 <span class="sy0">=</span> <span class="re0">$SUPProp</span>.Value1; Value <span class="sy0">=</span> <span class="re0">$SUPProp</span>.Value; <span class="st0">'Property Name'</span> <span class="sy0">=</span> <span class="re0">$SUPProp</span>.PropertyName<span class="br0">&#125;</span>;
        <span class="re0">$SUPHashTable</span> <span class="sy0">+=</span> <span class="re0">$SUPHash</span>;
      <span class="br0">&#125;</span>
      <span class="re0">$Table</span> <span class="sy0">=</span> AddWordTable <span class="sy0">-</span>Hashtable <span class="re0">$SUPHashTable</span> <span class="kw5">-Format</span> <span class="sy0">-</span><span class="nu0">155</span> <span class="sy0">-</span>AutoFit <span class="re0">$wdAutoFitFixed</span>;
&nbsp;
      <span class="co1">## Set first column format</span>
      SetWordCellFormat <span class="sy0">-</span>Collection <span class="re0">$Table</span>.Rows.Item<span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>.Cells <span class="sy0">-</span>Bold <span class="kw5">-BackgroundColor</span> <span class="re0">$wdColorGray15</span>;
&nbsp;
      <span class="co1">## IB - set column widths without recursion</span>
      <span class="re0">$Table</span>.Columns.Item<span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>.Width <span class="sy0">=</span> <span class="nu0">100</span>;
      <span class="re0">$Table</span>.Columns.Item<span class="br0">&#40;</span><span class="nu0">2</span><span class="br0">&#41;</span>.Width <span class="sy0">=</span> <span class="nu0">170</span>;
&nbsp;
      <span class="re0">$Table</span>.Rows.SetLeftIndent<span class="br0">&#40;</span><span class="re0">$Indent1TabStops</span><span class="sy0">,</span><span class="re0">$wdAdjustProportional</span><span class="br0">&#41;</span>
      <span class="re0">$Table</span>.AutoFitBehavior<span class="br0">&#40;</span><span class="re0">$wdAutoFitFixed</span><span class="br0">&#41;</span>
&nbsp;
      FindWordDocumentEnd
      <span class="re0">$Table</span> <span class="sy0">=</span> <span class="re0">$Null</span>
    <span class="br0">&#125;</span>
  <span class="br0">&#125;</span>
  <span class="kw3">else</span>
  <span class="br0">&#123;</span>
    WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">'This site has no Software Update Points installed.'</span>
  <span class="br0">&#125;</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="co1">##### Hierarchy wide configuration</span>
WriteWordLine <span class="nu0">1</span> <span class="nu0">0</span> <span class="st0">'Summary of Hierarchy Wide Configuration'</span>
&nbsp;
<span class="co1">#region enumerating Boundaries</span>
<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Enumerating all Site Boundaries&quot;</span>
WriteWordLine <span class="nu0">2</span> <span class="nu0">0</span> <span class="st0">'Summary of Site Boundaries'</span>
&nbsp;
<span class="re0">$Boundaries</span> <span class="sy0">=</span> Get<span class="sy0">-</span>CMBoundary
    <span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$Boundaries</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
  <span class="re0">$SubnetHashTable</span>  <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
  <span class="re0">$ADHashTable</span>      <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
  <span class="re0">$IPv6HashTable</span>    <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
  <span class="re0">$IPRangeHashTable</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
  <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$Boundary</span> <span class="kw3">in</span> <span class="re0">$Boundaries</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>       
    <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$Boundary</span>.BoundaryType <span class="kw4">-eq</span> <span class="nu0">0</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
      <span class="re0">$BoundaryType</span> <span class="sy0">=</span> <span class="st0">'IP Subnet'</span>;
      <span class="re0">$NamesOfBoundarySiteSystems</span> <span class="sy0">=</span> <span class="re0">$Null</span>
      <span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$Boundary</span>.SiteSystems<span class="br0">&#41;</span><span class="br0">&#41;</span>
      <span class="br0">&#123;</span>
        <span class="kw1">ForEach-Object</span> <span class="kw5">-Begin</span> <span class="br0">&#123;</span><span class="re0">$BoundarySiteSystems</span><span class="sy0">=</span> <span class="re0">$Boundary</span>.SiteSystems<span class="br0">&#125;</span> <span class="kw5">-Process</span> <span class="br0">&#123;</span><span class="re0">$NamesOfBoundarySiteSystems</span> <span class="sy0">+=</span> <span class="re0">$BoundarySiteSystems</span>.split<span class="br0">&#40;</span><span class="st0">','</span><span class="br0">&#41;</span><span class="br0">&#125;</span> <span class="kw5">-End</span> <span class="br0">&#123;</span><span class="re0">$NamesOfBoundarySiteSystems</span><span class="br0">&#125;</span> <span class="sy0">|</span> <span class="kw1">Out-Null</span>
      <span class="br0">&#125;</span>
      <span class="kw3">else</span> 
      <span class="br0">&#123;</span>
        <span class="re0">$NamesOfBoundarySiteSystems</span> <span class="sy0">=</span> <span class="st0">'n/a'</span>
      <span class="br0">&#125;</span> 
      <span class="re0">$SubnetHash</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#123;</span><span class="st0">'Boundary Type'</span> <span class="sy0">=</span> <span class="re0">$BoundaryType</span>; 
                    <span class="st0">'Default Site Code'</span> <span class="sy0">=</span> <span class="st0">&quot;$($Boundary.DefaultSiteCode)&quot;</span>
                    <span class="st0">'Associated Site Systems'</span> <span class="sy0">=</span> <span class="st0">&quot;$NamesOfBoundarySiteSystems&quot;</span>
                    Description <span class="sy0">=</span> <span class="re0">$Boundary</span>.DisplayName;
                    Value <span class="sy0">=</span> <span class="re0">$Boundary</span>.Value;
                    <span class="br0">&#125;</span>
      <span class="re0">$SubnetHashTable</span> <span class="sy0">+=</span> <span class="re0">$SubnetHash</span>;
    <span class="br0">&#125;</span>
    <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Boundary</span>.BoundaryType <span class="kw4">-eq</span> <span class="nu0">1</span><span class="br0">&#41;</span> <span class="br0">&#123;</span> 
      <span class="re0">$BoundaryType</span> <span class="sy0">=</span> <span class="st0">'Active Directory Site'</span>;
      <span class="re0">$NamesOfBoundarySiteSystems</span> <span class="sy0">=</span> <span class="re0">$Null</span>
      <span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$Boundary</span>.SiteSystems<span class="br0">&#41;</span><span class="br0">&#41;</span>
      <span class="br0">&#123;</span>
        <span class="kw1">ForEach-Object</span> <span class="kw5">-Begin</span> <span class="br0">&#123;</span><span class="re0">$BoundarySiteSystems</span><span class="sy0">=</span> <span class="re0">$Boundary</span>.SiteSystems<span class="br0">&#125;</span> <span class="kw5">-Process</span> <span class="br0">&#123;</span><span class="re0">$NamesOfBoundarySiteSystems</span> <span class="sy0">+=</span> <span class="re0">$BoundarySiteSystems</span>.split<span class="br0">&#40;</span><span class="st0">','</span><span class="br0">&#41;</span><span class="br0">&#125;</span> <span class="kw5">-End</span> <span class="br0">&#123;</span><span class="re0">$NamesOfBoundarySiteSystems</span><span class="br0">&#125;</span> <span class="sy0">|</span> <span class="kw1">Out-Null</span>
      <span class="br0">&#125;</span>
      <span class="kw3">else</span> 
      <span class="br0">&#123;</span>
        <span class="re0">$NamesOfBoundarySiteSystems</span> <span class="sy0">=</span> <span class="st0">'n/a'</span>
      <span class="br0">&#125;</span> 
      <span class="re0">$ADHash</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#123;</span><span class="st0">'Boundary Type'</span> <span class="sy0">=</span> <span class="re0">$BoundaryType</span>; 
                    <span class="st0">'Default Site Code'</span> <span class="sy0">=</span> <span class="st0">&quot;$($Boundary.DefaultSiteCode)&quot;</span>
                    <span class="st0">'Associated Site Systems'</span> <span class="sy0">=</span> <span class="st0">&quot;$NamesOfBoundarySiteSystems&quot;</span>;
                    Description <span class="sy0">=</span> <span class="re0">$Boundary</span>.DisplayName;
                    Value <span class="sy0">=</span> <span class="re0">$Boundary</span>.Value;
                    <span class="br0">&#125;</span>
      <span class="re0">$ADHashTable</span> <span class="sy0">+=</span> <span class="re0">$ADHash</span>;
    <span class="br0">&#125;</span>
    <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Boundary</span>.BoundaryType <span class="kw4">-eq</span> <span class="nu0">2</span><span class="br0">&#41;</span> <span class="br0">&#123;</span> 
      <span class="re0">$BoundaryType</span> <span class="sy0">=</span> <span class="st0">'IPv6 Prefix'</span>;
      <span class="re0">$NamesOfBoundarySiteSystems</span> <span class="sy0">=</span> <span class="re0">$Null</span>
      <span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$Boundary</span>.SiteSystems<span class="br0">&#41;</span><span class="br0">&#41;</span>
      <span class="br0">&#123;</span>
        <span class="kw1">ForEach-Object</span> <span class="kw5">-Begin</span> <span class="br0">&#123;</span><span class="re0">$BoundarySiteSystems</span><span class="sy0">=</span> <span class="re0">$Boundary</span>.SiteSystems<span class="br0">&#125;</span> <span class="kw5">-Process</span> <span class="br0">&#123;</span><span class="re0">$NamesOfBoundarySiteSystems</span> <span class="sy0">+=</span> <span class="re0">$BoundarySiteSystems</span>.split<span class="br0">&#40;</span><span class="st0">','</span><span class="br0">&#41;</span><span class="br0">&#125;</span> <span class="kw5">-End</span> <span class="br0">&#123;</span><span class="re0">$NamesOfBoundarySiteSystems</span><span class="br0">&#125;</span> <span class="sy0">|</span> <span class="kw1">Out-Null</span>
      <span class="br0">&#125;</span>
      <span class="kw3">else</span> 
      <span class="br0">&#123;</span>
        <span class="re0">$NamesOfBoundarySiteSystems</span> <span class="sy0">=</span> <span class="st0">'n/a'</span>
      <span class="br0">&#125;</span> 
      <span class="re0">$IPv6Hash</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#123;</span><span class="st0">'Boundary Type'</span> <span class="sy0">=</span> <span class="re0">$BoundaryType</span>; 
                    <span class="st0">'Default Site Code'</span> <span class="sy0">=</span> <span class="st0">&quot;$($Boundary.DefaultSiteCode)&quot;</span>
                    <span class="st0">'Associated Site Systems'</span> <span class="sy0">=</span> <span class="st0">&quot;$NamesOfBoundarySiteSystems&quot;</span>;
                    Description <span class="sy0">=</span> <span class="re0">$Boundary</span>.DisplayName;
                    Value <span class="sy0">=</span> <span class="re0">$Boundary</span>.Value;
                    <span class="br0">&#125;</span>
      <span class="re0">$IPv6HashTable</span> <span class="sy0">+=</span> <span class="re0">$IPv6Hash</span>;
    <span class="br0">&#125;</span>
    <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Boundary</span>.BoundaryType <span class="kw4">-eq</span> <span class="nu0">3</span><span class="br0">&#41;</span> 
    <span class="br0">&#123;</span> 
      <span class="re0">$BoundaryType</span> <span class="sy0">=</span> <span class="st0">'IP Range'</span>;
      <span class="re0">$NamesOfBoundarySiteSystems</span> <span class="sy0">=</span> <span class="re0">$Null</span>
      <span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$Boundary</span>.SiteSystems<span class="br0">&#41;</span><span class="br0">&#41;</span>
      <span class="br0">&#123;</span>
        <span class="kw1">ForEach-Object</span> <span class="kw5">-Begin</span> <span class="br0">&#123;</span><span class="re0">$BoundarySiteSystems</span><span class="sy0">=</span> <span class="re0">$Boundary</span>.SiteSystems<span class="br0">&#125;</span> <span class="kw5">-Process</span> <span class="br0">&#123;</span><span class="re0">$NamesOfBoundarySiteSystems</span> <span class="sy0">+=</span> <span class="re0">$BoundarySiteSystems</span>.split<span class="br0">&#40;</span><span class="st0">','</span><span class="br0">&#41;</span><span class="br0">&#125;</span> <span class="kw5">-End</span> <span class="br0">&#123;</span><span class="re0">$NamesOfBoundarySiteSystems</span><span class="br0">&#125;</span> <span class="sy0">|</span> <span class="kw1">Out-Null</span>
      <span class="br0">&#125;</span>
      <span class="kw3">else</span> 
      <span class="br0">&#123;</span>
        <span class="re0">$NamesOfBoundarySiteSystems</span> <span class="sy0">=</span> <span class="st0">'n/a'</span>
      <span class="br0">&#125;</span> 
      <span class="re0">$IPRangeHash</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#123;</span><span class="st0">'Boundary Type'</span> <span class="sy0">=</span> <span class="re0">$BoundaryType</span>
                    <span class="st0">'Default Site Code'</span> <span class="sy0">=</span> <span class="st0">&quot;$($Boundary.DefaultSiteCode)&quot;</span>
                    <span class="st0">'Associated Site Systems'</span> <span class="sy0">=</span> <span class="st0">&quot;$NamesOfBoundarySiteSystems&quot;</span>
                    Description <span class="sy0">=</span> <span class="re0">$Boundary</span>.DisplayName
                    Value <span class="sy0">=</span> <span class="re0">$Boundary</span>.Value
                    <span class="br0">&#125;</span>
      <span class="re0">$IPRangeHashTable</span> <span class="sy0">+=</span> <span class="re0">$IPRangeHash</span>
    <span class="br0">&#125;</span>
  <span class="br0">&#125;</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="co1">#region IPv6 Boundaries Table</span>
      <span class="re0">$Table</span> <span class="sy0">=</span> AddWordTable <span class="sy0">-</span>Hashtable <span class="re0">$IPv6HashTable</span> <span class="kw5">-Format</span> <span class="sy0">-</span><span class="nu0">155</span> <span class="sy0">-</span>AutoFit <span class="re0">$wdAutoFitContent</span>;
&nbsp;
      <span class="co1">## Set first column format</span>
      SetWordCellFormat <span class="sy0">-</span>Collection <span class="re0">$Table</span>.Rows.Item<span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>.Cells <span class="sy0">-</span>Bold <span class="kw5">-BackgroundColor</span> <span class="re0">$wdColorGray1</span>
      <span class="re0">$Table</span>.Rows.SetLeftIndent<span class="br0">&#40;</span><span class="re0">$Indent1TabStops</span><span class="sy0">,</span><span class="re0">$wdAdjustProportional</span><span class="br0">&#41;</span> 
      FindWordDocumentEnd
      <span class="re0">$Table</span> <span class="sy0">=</span> <span class="re0">$Null</span>
<span class="co1">#endregion IPv6 Boundaries Table</span>
WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
&nbsp;
<span class="co1">#region IP Subnet Boundaries Table</span>
      <span class="re0">$Table</span> <span class="sy0">=</span> AddWordTable <span class="sy0">-</span>Hashtable <span class="re0">$SubnetHashTable</span> <span class="kw5">-Format</span> <span class="sy0">-</span><span class="nu0">155</span> <span class="sy0">-</span>AutoFit <span class="re0">$wdAutoFitContent</span>
&nbsp;
      <span class="co1">## Set first column format</span>
      SetWordCellFormat <span class="sy0">-</span>Collection <span class="re0">$Table</span>.Rows.Item<span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>.Cells <span class="sy0">-</span>Bold <span class="kw5">-BackgroundColor</span> <span class="re0">$wdColorGray15</span>
      <span class="re0">$Table</span>.Rows.SetLeftIndent<span class="br0">&#40;</span><span class="re0">$Indent1TabStops</span><span class="sy0">,</span><span class="re0">$wdAdjustProportional</span><span class="br0">&#41;</span> 
      FindWordDocumentEnd
      <span class="re0">$Table</span> <span class="sy0">=</span> <span class="re0">$Null</span>
<span class="co1">#endregion IP Subnet Boundaries Table</span>
&nbsp;
WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
&nbsp;
<span class="co1">#region IP Range Boundaries Table</span>
      <span class="re0">$Table</span> <span class="sy0">=</span> AddWordTable <span class="sy0">-</span>Hashtable <span class="re0">$IPRangeHashTable</span> <span class="kw5">-Format</span> <span class="sy0">-</span><span class="nu0">155</span> <span class="sy0">-</span>AutoFit <span class="re0">$wdAutoFitContent</span> ;
&nbsp;
      <span class="co1">## Set first column format</span>
      SetWordCellFormat <span class="sy0">-</span>Collection <span class="re0">$Table</span>.Rows.Item<span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>.Cells <span class="sy0">-</span>Bold <span class="kw5">-BackgroundColor</span> <span class="re0">$wdColorGray15</span>;
      <span class="re0">$Table</span>.Rows.SetLeftIndent<span class="br0">&#40;</span><span class="re0">$Indent1TabStops</span><span class="sy0">,</span><span class="re0">$wdAdjustProportional</span><span class="br0">&#41;</span> 
      FindWordDocumentEnd
      <span class="re0">$Table</span> <span class="sy0">=</span> <span class="re0">$Null</span>
<span class="co1">#endregion IP Range Boundaries Table</span>
&nbsp;
WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
&nbsp;
<span class="co1">#region AD Site Boundaries Table</span>
      <span class="re0">$Table</span> <span class="sy0">=</span> AddWordTable <span class="sy0">-</span>Hashtable <span class="re0">$ADHashTable</span> <span class="kw5">-Format</span> <span class="sy0">-</span><span class="nu0">155</span> <span class="sy0">-</span>AutoFit <span class="re0">$wdAutoFitContent</span>;
&nbsp;
      <span class="co1">## Set first column format</span>
      SetWordCellFormat <span class="sy0">-</span>Collection <span class="re0">$Table</span>.Rows.Item<span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>.Cells <span class="sy0">-</span>Bold <span class="kw5">-BackgroundColor</span> <span class="re0">$wdColorGray15</span>;
      <span class="re0">$Table</span>.Rows.SetLeftIndent<span class="br0">&#40;</span><span class="re0">$Indent1TabStops</span><span class="sy0">,</span><span class="re0">$wdAdjustProportional</span><span class="br0">&#41;</span> 
&nbsp;
      FindWordDocumentEnd
      <span class="re0">$Table</span> <span class="sy0">=</span> <span class="re0">$Null</span>
<span class="co1">#endregion AD Site Boundaries Table</span>
&nbsp;
WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
&nbsp;
<span class="co1">#endregion enumerating Boundaries</span>
&nbsp;
<span class="co1">#region enumerating all Boundary Groups and their members</span>
<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date):   Enumerating all Boundary Groups and their members&quot;</span>
&nbsp;
<span class="re0">$BoundaryGroups</span> <span class="sy0">=</span> Get<span class="sy0">-</span>CMBoundaryGroup
WriteWordLine <span class="nu0">2</span> <span class="nu0">0</span> <span class="st0">'Summary of Site Boundary Groups'</span>
&nbsp;
<span class="re0">$BoundaryGroupHashTable</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
<span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$BoundaryGroups</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
  <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$BoundaryGroup</span> <span class="kw3">in</span> <span class="re0">$BoundaryGroups</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="re0">$MemberNames</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
    <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$BoundaryGroup</span>.SiteSystemCount <span class="kw4">-gt</span> <span class="nu0">0</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
      <span class="re0">$MemberIDs</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="kw1">Get-WmiObject</span> <span class="kw5">-Class</span> SMS_BoundaryGroupMembers <span class="kw5">-Namespace</span> root\sms\site_<span class="re0">$SiteCode</span> <span class="kw5">-ComputerName</span> <span class="re0">$SMSProvider</span> <span class="sy0">|</span> <span class="kw1">Where-Object</span> <span class="kw5">-FilterScript</span> <span class="br0">&#123;</span><a href="about:blank"><span class="kw6">$_</span></a>.GroupID <span class="kw4">-eq</span> <span class="st0">&quot;$($BoundaryGroup.GroupID)&quot;</span><span class="br0">&#125;</span><span class="br0">&#41;</span>.BoundaryID
      <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$MemberID</span> <span class="kw3">in</span> <span class="re0">$MemberIDs</span><span class="br0">&#41;</span>
      <span class="br0">&#123;</span>
        <span class="re0">$MemberName</span> <span class="sy0">=</span> <span class="br0">&#40;</span>Get<span class="sy0">-</span>CMBoundary <span class="kw5">-Id</span> <span class="re0">$MemberID</span><span class="br0">&#41;</span>.DisplayName
        <span class="re0">$MemberNames</span> <span class="sy0">+=</span> <span class="st0">&quot;$MemberName (ID: $MemberID); &quot;</span>
        <span class="kw1">Write-Verbose</span> <span class="st0">&quot;Member names: $($MemberName)&quot;</span>
      <span class="br0">&#125;</span>
    <span class="br0">&#125;</span>
    <span class="kw3">else</span>
    <span class="br0">&#123;</span>
      <span class="re0">$MemberNames</span> <span class="sy0">+=</span> <span class="st0">'There are no Site Systems associated to this Boundary Group.'</span>
      <span class="kw1">Write-Verbose</span> <span class="st0">'There are no Site Systems associated to this Boundary Group.'</span>
    <span class="br0">&#125;</span>
    <span class="re0">$BoundaryGroupRow</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#123;</span>Name <span class="sy0">=</span> <span class="re0">$BoundaryGroup</span>.Name; Description <span class="sy0">=</span> <span class="re0">$BoundaryGroup</span>.Description; <span class="st0">'Boundary members'</span> <span class="sy0">=</span> <span class="st0">&quot;$MemberNames&quot;</span><span class="br0">&#125;</span>;
    <span class="re0">$BoundaryGroupHashTable</span> <span class="sy0">+=</span> <span class="re0">$BoundaryGroupRow</span>;
  <span class="br0">&#125;</span>
&nbsp;
  <span class="re0">$Table</span> <span class="sy0">=</span> AddWordTable <span class="sy0">-</span>Hashtable <span class="re0">$BoundaryGroupHashTable</span> <span class="kw5">-Format</span> <span class="sy0">-</span><span class="nu0">155</span> <span class="sy0">-</span>AutoFit <span class="re0">$wdAutoFitContent</span>
  <span class="co1">#-Columns Name, Description, 'Boundary Members' -Headers Name, Description, 'Boundary Members'</span>
  <span class="co1">## Set first column format</span>
  SetWordCellFormat <span class="sy0">-</span>Collection <span class="re0">$Table</span>.Rows.Item<span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>.Cells <span class="sy0">-</span>Bold <span class="kw5">-BackgroundColor</span> <span class="re0">$wdColorGray15</span>
&nbsp;
  FindWordDocumentEnd
  <span class="re0">$Table</span> <span class="sy0">=</span> <span class="re0">$Null</span>
<span class="br0">&#125;</span>
<span class="kw3">else</span>
<span class="br0">&#123;</span>
  WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">'There are no Boundary Groups configured. It is mandatory to configure a Boundary Group in order for CM12 to work properly.'</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="co1">#endregion enumerating all Boundary Groups and their members</span>
&nbsp;
<span class="co1">#region enumerating Client Policies</span>
<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date):   Enumerating all Client/Device Settings&quot;</span>
WriteWordLine <span class="nu0">2</span> <span class="nu0">0</span> <span class="st0">'Summary of Custom Client Device Settings'</span>
&nbsp;
<span class="re0">$AllClientSettings</span> <span class="sy0">=</span> Get<span class="sy0">-</span>CMClientSetting <span class="sy0">|</span> <span class="kw1">Where-Object</span> <span class="kw5">-FilterScript</span> <span class="br0">&#123;</span><a href="about:blank"><span class="kw6">$_</span></a>.SettingsID <span class="kw4">-ne</span> <span class="st0">'0'</span><span class="br0">&#125;</span>
<span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$ClientSetting</span> <span class="kw3">in</span> <span class="re0">$AllClientSettings</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
  WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">&quot;Client Settings Name: $($ClientSetting.Name)&quot;</span> <span class="sy0">-</span>bold
  WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Client Settings Description: $($ClientSetting.Description)&quot;</span>
  WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Client Settings ID: $($ClientSetting.SettingsID)&quot;</span>
  WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Client Settings Priority: $($ClientSetting.Priority)&quot;</span>
  <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$ClientSetting</span>.<span class="kw2">Type</span> <span class="kw4">-eq</span> <span class="st0">'1'</span><span class="br0">&#41;</span>
  <span class="br0">&#123;</span>
    WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'This is a custom client Device Setting.'</span>
  <span class="br0">&#125;</span>
  <span class="kw3">else</span>
  <span class="br0">&#123;</span>
    WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'This is a custom client User Setting.'</span>
  <span class="br0">&#125;</span>
  WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">'Configurations'</span>
  <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span> <span class="kw3">in</span> <span class="re0">$ClientSetting</span>.AgentConfigurations<span class="br0">&#41;</span>
  <span class="br0">&#123;</span>
    try
    <span class="br0">&#123;</span>
      <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.AgentID<span class="br0">&#41;</span>
      <span class="br0">&#123;</span>
        <span class="nu0">1</span>
        <span class="br0">&#123;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Compliance Settings'</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Enable compliance evaluation on clients: $($AgentConfig.Enabled)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Enable user data and profiles: $($AgentConfig.EnableUserStateManagement)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'---------------------'</span>
        <span class="br0">&#125;</span>
        <span class="nu0">2</span>
        <span class="br0">&#123;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Software Inventory'</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Enable software inventory on clients: $($AgentConfig.Enabled)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Schedule software inventory and file collection: '</span> <span class="kw5">-nonewline</span>
          <span class="re0">$Schedule</span> <span class="sy0">=</span> Convert<span class="sy0">-</span>CMSchedule <span class="sy0">-</span>ScheduleString <span class="re0">$AgentConfig</span>.Schedule
          <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.DaySpan <span class="kw4">-gt</span> <span class="nu0">0</span><span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">&quot; Occurs every $($Schedule.DaySpan) days effective $($Schedule.StartTime)&quot;</span>
          <span class="br0">&#125;</span>
          <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.HourSpan <span class="kw4">-gt</span> <span class="nu0">0</span><span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">&quot; Occurs every $($Schedule.HourSpan) hours effective $($Schedule.StartTime)&quot;</span>
          <span class="br0">&#125;</span>
          <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.MinuteSpan <span class="kw4">-gt</span> <span class="nu0">0</span><span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">&quot; Occurs every $($Schedule.MinuteSpan) minutes effective $($Schedule.StartTime)&quot;</span>
          <span class="br0">&#125;</span>
          <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.ForNumberOfWeeks<span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">&quot; Occurs every $($Schedule.ForNumberOfWeeks) weeks on $(Convert-WeekDay $Schedule.Day) effective $($Schedule.StartTime)&quot;</span>
          <span class="br0">&#125;</span>
          <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.ForNumberOfMonths<span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.MonthDay <span class="kw4">-gt</span> <span class="nu0">0</span><span class="br0">&#41;</span>
            <span class="br0">&#123;</span>
              WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">&quot; Occurs on day $($Schedule.MonthDay) of every $($Schedule.ForNumberOfMonths) months effective $($Schedule.StartTime)&quot;</span>
            <span class="br0">&#125;</span>
            <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.MonthDay <span class="kw4">-eq</span> <span class="nu0">0</span><span class="br0">&#41;</span>
            <span class="br0">&#123;</span>
              WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">&quot; Occurs the last day of every $($Schedule.ForNumberOfMonths) months effective $($Schedule.StartTime)&quot;</span>
            <span class="br0">&#125;</span>
            <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.WeekOrder <span class="kw4">-gt</span> <span class="nu0">0</span><span class="br0">&#41;</span>
            <span class="br0">&#123;</span>
              <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.WeekOrder<span class="br0">&#41;</span>
              <span class="br0">&#123;</span>
                <span class="nu0">0</span> <span class="br0">&#123;</span><span class="re0">$order</span> <span class="sy0">=</span> <span class="st0">'last'</span><span class="br0">&#125;</span>
                <span class="nu0">1</span> <span class="br0">&#123;</span><span class="re0">$order</span> <span class="sy0">=</span> <span class="st0">'first'</span><span class="br0">&#125;</span>
                <span class="nu0">2</span> <span class="br0">&#123;</span><span class="re0">$order</span> <span class="sy0">=</span> <span class="st0">'second'</span><span class="br0">&#125;</span>
                <span class="nu0">3</span> <span class="br0">&#123;</span><span class="re0">$order</span> <span class="sy0">=</span> <span class="st0">'third'</span><span class="br0">&#125;</span>
                <span class="nu0">4</span> <span class="br0">&#123;</span><span class="re0">$order</span> <span class="sy0">=</span> <span class="st0">'fourth'</span><span class="br0">&#125;</span>
              <span class="br0">&#125;</span>
              WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">&quot; Occurs the $($order) $(Convert-WeekDay $Schedule.Day) of every $($Schedule.ForNumberOfMonths) months effective $($Schedule.StartTime)&quot;</span>
            <span class="br0">&#125;</span>
          <span class="br0">&#125;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Inventory reporting detail: '</span> <span class="kw5">-nonewline</span>
          <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.ReportOptions<span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            <span class="nu0">1</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Product only'</span> <span class="br0">&#125;</span>
            <span class="nu0">2</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'File only'</span> <span class="br0">&#125;</span>
            <span class="nu0">7</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Full details'</span> <span class="br0">&#125;</span>
          <span class="br0">&#125;</span>
&nbsp;
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Inventory these file types: '</span>
          <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.InventoriableTypes<span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;$($AgentConfig.InventoriableTypes)&quot;</span>
          <span class="br0">&#125;</span>
          <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.Path<span class="br0">&#41;</span>
          <span class="br0">&#123;</span>                               
            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;$($AgentConfig.Path)&quot;</span>
          <span class="br0">&#125;</span>
          <span class="kw3">if</span> <span class="br0">&#40;</span><span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.InventoriableTypes<span class="br0">&#41;</span> <span class="kw4">-and</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.ExcludeWindirAndSubfolders <span class="kw4">-eq</span> <span class="st0">'true'</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">'Exclude WinDir and Subfolders'</span>
          <span class="br0">&#125;</span>
          <span class="kw3">else</span> 
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">'Do not exclude WinDir and Subfolders'</span>
          <span class="br0">&#125;</span>
&nbsp;
          WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'---------------------'</span>
        <span class="br0">&#125;</span>
        <span class="nu0">3</span>
        <span class="br0">&#123;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Remote Tools'</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Enable Remote Control on clients: '</span> <span class="kw5">-nonewline</span>
          <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.FirewallExceptionProfiles<span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            <span class="nu0">0</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Disabled'</span> <span class="br0">&#125;</span>
            <span class="nu0">8</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Enabled: No Firewall Profile.'</span> <span class="br0">&#125;</span>
            <span class="nu0">9</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Enabled: Public.'</span> <span class="br0">&#125;</span>
            <span class="nu0">10</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Enabled: Private.'</span> <span class="br0">&#125;</span>
            <span class="nu0">11</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Enabled: Private, Public.'</span> <span class="br0">&#125;</span>
            <span class="nu0">12</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Enabled: Domain.'</span> <span class="br0">&#125;</span>
            <span class="nu0">13</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Enabled: Domain, Public.'</span> <span class="br0">&#125;</span>
            <span class="nu0">14</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Enabled: Domain, Private.'</span> <span class="br0">&#125;</span>
            <span class="nu0">15</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Enabled: Domain, Private, Public.'</span> <span class="br0">&#125;</span>
          <span class="br0">&#125;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Users can change policy or notification settings in Software Center: $($AgentConfig.AllowClientChange)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Allow Remote Control of an unattended computer: $($AgentConfig.AllowRemCtrlToUnattended)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Prompt user for Remote Control permission: $($AgentConfig.PermissionRequired)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Grant Remote Control permission to local Administrators group: $($AgentConfig.AllowLocalAdminToDoRemoteControl)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Access level allowed: '</span> <span class="kw5">-nonewline</span>
          <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.AccessLevel<span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            <span class="nu0">0</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'No access'</span> <span class="br0">&#125;</span>
            <span class="nu0">1</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'View only'</span> <span class="br0">&#125;</span>
            <span class="nu0">2</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Full Control'</span> <span class="br0">&#125;</span>
          <span class="br0">&#125;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Permitted viewers of Remote Control and Remote Assistance:'</span>
          <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$Viewer</span> <span class="kw3">in</span> <span class="re0">$AgentConfig</span>.PermittedViewers<span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;$($Viewer)&quot;</span>
          <span class="br0">&#125;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Show session notification icon on taskbar: $($AgentConfig.RemCtrlTaskbarIcon)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Show session connection bar: $($AgentConfig.RemCtrlConnectionBar)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Play a sound on client: '</span> <span class="kw5">-nonewline</span>
          <span class="kw3">Switch</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.AudibleSignal<span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            <span class="nu0">0</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'None.'</span> <span class="br0">&#125;</span>
            <span class="nu0">1</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Beginning and end of session.'</span> <span class="br0">&#125;</span>
            <span class="nu0">2</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Repeatedly during session.'</span> <span class="br0">&#125;</span>
          <span class="br0">&#125;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Manage unsolicited Remote Assistance settings: $($AgentConfig.ManageRA)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Manage solicited Remote Assistance settings: $($AgentConfig.EnforceRAandTSSettings)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Level of access for Remote Assistance: '</span> <span class="kw5">-nonewline</span>
          <span class="kw3">if</span> <span class="br0">&#40;</span><span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.AllowRAUnsolicitedView <span class="kw4">-ne</span> <span class="st0">'True'</span><span class="br0">&#41;</span> <span class="kw4">-and</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.AllowRAUnsolicitedControl <span class="kw4">-ne</span> <span class="st0">'True'</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'None.'</span>
          <span class="br0">&#125;</span>
          <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.AllowRAUnsolicitedView <span class="kw4">-eq</span> <span class="st0">'True'</span><span class="br0">&#41;</span> <span class="kw4">-and</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.AllowRAUnsolicitedControl <span class="kw4">-ne</span> <span class="st0">'True'</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Remote viewing.'</span>
          <span class="br0">&#125;</span>
          <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.AllowRAUnsolicitedView <span class="kw4">-eq</span> <span class="st0">'True'</span><span class="br0">&#41;</span> <span class="kw4">-and</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.AllowRAUnsolicitedControl <span class="kw4">-eq</span> <span class="st0">'True'</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Full Control.'</span>
          <span class="br0">&#125;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Manage Remote Desktop settings: $($AgentConfig.ManageTS)&quot;</span>
          <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.ManageTS <span class="kw4">-eq</span> <span class="st0">'True'</span><span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Allow permitted viewers to connect by using Remote Desktop connection: $($AgentConfig.EnableTS)&quot;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Require network level authentication on computers that run Windows Vista operating system and later versions: $($AgentConfig.TSUserAuthentication)&quot;</span>
          <span class="br0">&#125;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'---------------------'</span>
        <span class="br0">&#125;</span>
        <span class="nu0">4</span>
        <span class="br0">&#123;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Computer Agent'</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Deployment deadline greater than 24 hours, remind user every (hours): $([string]($AgentConfig.ReminderInterval) / 60 / 60)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Deployment deadline less than 24 hours, remind user every (hours): $([string]($AgentConfig.DayReminderInterval) / 60 / 60)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Deployment deadline less than 1 hour, remind user every (minutes): $([string]($AgentConfig.HourReminderInterval) / 60)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Default application catalog website point: $($AgentConfig.PortalUrl)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Add default Application Catalog website to Internet Explorer trusted sites zone: $($AgentConfig.AddPortalToTrustedSiteList)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Allow Silverlight applications to run in elevated trust mode: $($AgentConfig.AllowPortalToHaveElevatedTrust)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Organization name displayed in Software Center: $($AgentConfig.BrandingTitle)&quot;</span>
          <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.InstallRestriction<span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            <span class="nu0">0</span> <span class="br0">&#123;</span> <span class="re0">$InstallRestriction</span> <span class="sy0">=</span> <span class="st0">'All Users'</span> <span class="br0">&#125;</span>
            <span class="nu0">1</span> <span class="br0">&#123;</span> <span class="re0">$InstallRestriction</span> <span class="sy0">=</span> <span class="st0">'Only Administrators'</span> <span class="br0">&#125;</span>
            <span class="nu0">3</span> <span class="br0">&#123;</span> <span class="re0">$InstallRestriction</span> <span class="sy0">=</span> <span class="st0">'Only Administrators and primary Users'</span><span class="br0">&#125;</span>
            <span class="nu0">4</span> <span class="br0">&#123;</span> <span class="re0">$InstallRestriction</span> <span class="sy0">=</span> <span class="st0">'No users'</span> <span class="br0">&#125;</span>
          <span class="br0">&#125;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Install Permissions: $($InstallRestriction)&quot;</span>
          <span class="kw3">Switch</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.SuspendBitLocker<span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            <span class="nu0">0</span> <span class="br0">&#123;</span> <span class="re0">$SuspendBitlocker</span> <span class="sy0">=</span> <span class="st0">'Never'</span> <span class="br0">&#125;</span>
            <span class="nu0">1</span> <span class="br0">&#123;</span> <span class="re0">$SuspendBitlocker</span> <span class="sy0">=</span> <span class="st0">'Always'</span> <span class="br0">&#125;</span>
          <span class="br0">&#125;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Suspend Bitlocker PIN entry on restart: $($SuspendBitlocker)&quot;</span>
          <span class="kw3">Switch</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.EnableThirdPartyOrchestration<span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            <span class="nu0">0</span> <span class="br0">&#123;</span> <span class="re0">$EnableThirdPartyTool</span> <span class="sy0">=</span> <span class="st0">'No'</span> <span class="br0">&#125;</span>
            <span class="nu0">1</span> <span class="br0">&#123;</span> <span class="re0">$EnableThirdPartyTool</span> <span class="sy0">=</span> <span class="st0">'Yes'</span> <span class="br0">&#125;</span>
          <span class="br0">&#125;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Additional software manages the deployment of applications and software updates: $($EnableThirdPartyTool)&quot;</span>
          <span class="kw3">Switch</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.PowerShellExecutionPolicy<span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            <span class="nu0">0</span> <span class="br0">&#123;</span> <span class="re0">$ExecutionPolicy</span> <span class="sy0">=</span> <span class="st0">'All signed'</span> <span class="br0">&#125;</span>
            <span class="nu0">1</span> <span class="br0">&#123;</span> <span class="re0">$ExecutionPolicy</span> <span class="sy0">=</span> <span class="st0">'Bypass'</span> <span class="br0">&#125;</span>
            <span class="nu0">2</span> <span class="br0">&#123;</span> <span class="re0">$ExecutionPolicy</span> <span class="sy0">=</span> <span class="st0">'Restricted'</span> <span class="br0">&#125;</span>
          <span class="br0">&#125;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Powershell execution policy: $($ExecutionPolicy)&quot;</span>
          <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.DisplayNewProgramNotification<span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            False <span class="br0">&#123;</span> <span class="re0">$DisplayNotifications</span> <span class="sy0">=</span> <span class="st0">'No'</span> <span class="br0">&#125;</span>
            True <span class="br0">&#123;</span> <span class="re0">$DisplayNotifications</span> <span class="sy0">=</span> <span class="st0">'Yes'</span> <span class="br0">&#125;</span>
          <span class="br0">&#125;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Show notifications for new deployments: $($DisplayNotifications)&quot;</span>
          <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.DisableGlobalRandomization<span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            False <span class="br0">&#123;</span> <span class="re0">$DisableGlobalRandomization</span> <span class="sy0">=</span> <span class="st0">'No'</span> <span class="br0">&#125;</span>
            True <span class="br0">&#123;</span> <span class="re0">$DisableGlobalRandomization</span> <span class="sy0">=</span> <span class="st0">'Yes'</span> <span class="br0">&#125;</span>
          <span class="br0">&#125;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Disable deadline randomization: $($DisableGlobalRandomization)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'---------------------'</span>
        <span class="br0">&#125;</span>
        <span class="nu0">5</span>
        <span class="br0">&#123;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Network Access Protection (NAP)'</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Enable Network Access Protection on clients: $($AgentConfig.Enabled)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Use UTC (Universal Time Coordinated) for evaluation time: $($AgentConfig.EffectiveTimeinUTC)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Require a new scan for each evaluation: $($AgentConfig.ForceScan)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'NAP re-evaluation schedule:'</span> <span class="kw5">-nonewline</span>
          <span class="re0">$Schedule</span> <span class="sy0">=</span> Convert<span class="sy0">-</span>CMSchedule <span class="sy0">-</span>ScheduleString <span class="re0">$AgentConfig</span>.ComputeComplianceSchedule
          <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.DaySpan <span class="kw4">-gt</span> <span class="nu0">0</span><span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">&quot; Occurs every $($Schedule.DaySpan) days effective $($Schedule.StartTime)&quot;</span>
          <span class="br0">&#125;</span>
          <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.HourSpan <span class="kw4">-gt</span> <span class="nu0">0</span><span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">&quot; Occurs every $($Schedule.HourSpan) hours effective $($Schedule.StartTime)&quot;</span>
          <span class="br0">&#125;</span>
          <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.MinuteSpan <span class="kw4">-gt</span> <span class="nu0">0</span><span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">&quot; Occurs every $($Schedule.MinuteSpan) minutes effective $($Schedule.StartTime)&quot;</span>
          <span class="br0">&#125;</span>
          <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.ForNumberOfWeeks<span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">&quot; Occurs every $($Schedule.ForNumberOfWeeks) weeks on $(Convert-WeekDay $Schedule.Day) effective $($Schedule.StartTime)&quot;</span>
          <span class="br0">&#125;</span>
          <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.ForNumberOfMonths<span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.MonthDay <span class="kw4">-gt</span> <span class="nu0">0</span><span class="br0">&#41;</span>
            <span class="br0">&#123;</span>
              WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">&quot; Occurs on day $($Schedule.MonthDay) of every $($Schedule.ForNumberOfMonths) months effective $($Schedule.StartTime)&quot;</span>
            <span class="br0">&#125;</span>
            <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.MonthDay <span class="kw4">-eq</span> <span class="nu0">0</span><span class="br0">&#41;</span>
            <span class="br0">&#123;</span>
              WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">&quot; Occurs the last day of every $($Schedule.ForNumberOfMonths) months effective $($Schedule.StartTime)&quot;</span>
            <span class="br0">&#125;</span>
            <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.WeekOrder <span class="kw4">-gt</span> <span class="nu0">0</span><span class="br0">&#41;</span>
            <span class="br0">&#123;</span>
              <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.WeekOrder<span class="br0">&#41;</span>
              <span class="br0">&#123;</span>
                <span class="nu0">0</span> <span class="br0">&#123;</span><span class="re0">$order</span> <span class="sy0">=</span> <span class="st0">'last'</span><span class="br0">&#125;</span>
                <span class="nu0">1</span> <span class="br0">&#123;</span><span class="re0">$order</span> <span class="sy0">=</span> <span class="st0">'first'</span><span class="br0">&#125;</span>
                <span class="nu0">2</span> <span class="br0">&#123;</span><span class="re0">$order</span> <span class="sy0">=</span> <span class="st0">'second'</span><span class="br0">&#125;</span>
                <span class="nu0">3</span> <span class="br0">&#123;</span><span class="re0">$order</span> <span class="sy0">=</span> <span class="st0">'third'</span><span class="br0">&#125;</span>
                <span class="nu0">4</span> <span class="br0">&#123;</span><span class="re0">$order</span> <span class="sy0">=</span> <span class="st0">'fourth'</span><span class="br0">&#125;</span>
              <span class="br0">&#125;</span>
              WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">&quot; Occurs the $($order) $(Convert-WeekDay $Schedule.Day) of every $($Schedule.ForNumberOfMonths) months effective $($Schedule.StartTime)&quot;</span>
            <span class="br0">&#125;</span>
          <span class="br0">&#125;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'---------------------'</span>
        <span class="br0">&#125;</span>
        <span class="nu0">8</span>
        <span class="br0">&#123;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Software Metering'</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Enable software metering on clients: $($AgentConfig.Enabled)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Schedule data collection: '</span> <span class="kw5">-nonewline</span>
          <span class="re0">$Schedule</span> <span class="sy0">=</span> Convert<span class="sy0">-</span>CMSchedule <span class="sy0">-</span>ScheduleString <span class="re0">$AgentConfig</span>.DataCollectionSchedule
          <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.DaySpan <span class="kw4">-gt</span> <span class="nu0">0</span><span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">&quot; Occurs every $($Schedule.DaySpan) days effective $($Schedule.StartTime)&quot;</span>
          <span class="br0">&#125;</span>
          <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.HourSpan <span class="kw4">-gt</span> <span class="nu0">0</span><span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">&quot; Occurs every $($Schedule.HourSpan) hours effective $($Schedule.StartTime)&quot;</span>
          <span class="br0">&#125;</span>
          <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.MinuteSpan <span class="kw4">-gt</span> <span class="nu0">0</span><span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">&quot; Occurs every $($Schedule.MinuteSpan) minutes effective $($Schedule.StartTime)&quot;</span>
          <span class="br0">&#125;</span>
          <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.ForNumberOfWeeks<span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">&quot; Occurs every $($Schedule.ForNumberOfWeeks) weeks on $(Convert-WeekDay $Schedule.Day) effective $($Schedule.StartTime)&quot;</span>
          <span class="br0">&#125;</span>
          <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.ForNumberOfMonths<span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.MonthDay <span class="kw4">-gt</span> <span class="nu0">0</span><span class="br0">&#41;</span>
            <span class="br0">&#123;</span>
              WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">&quot; Occurs on day $($Schedule.MonthDay) of every $($Schedule.ForNumberOfMonths) months effective $($Schedule.StartTime)&quot;</span>
            <span class="br0">&#125;</span>
            <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.MonthDay <span class="kw4">-eq</span> <span class="nu0">0</span><span class="br0">&#41;</span>
            <span class="br0">&#123;</span>
              WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">&quot; Occurs the last day of every $($Schedule.ForNumberOfMonths) months effective $($Schedule.StartTime)&quot;</span>
            <span class="br0">&#125;</span>
            <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.WeekOrder <span class="kw4">-gt</span> <span class="nu0">0</span><span class="br0">&#41;</span>
            <span class="br0">&#123;</span>
              <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.WeekOrder<span class="br0">&#41;</span>
              <span class="br0">&#123;</span>
                <span class="nu0">0</span> <span class="br0">&#123;</span><span class="re0">$order</span> <span class="sy0">=</span> <span class="st0">'last'</span><span class="br0">&#125;</span>
                <span class="nu0">1</span> <span class="br0">&#123;</span><span class="re0">$order</span> <span class="sy0">=</span> <span class="st0">'first'</span><span class="br0">&#125;</span>
                <span class="nu0">2</span> <span class="br0">&#123;</span><span class="re0">$order</span> <span class="sy0">=</span> <span class="st0">'second'</span><span class="br0">&#125;</span>
                <span class="nu0">3</span> <span class="br0">&#123;</span><span class="re0">$order</span> <span class="sy0">=</span> <span class="st0">'third'</span><span class="br0">&#125;</span>
                <span class="nu0">4</span> <span class="br0">&#123;</span><span class="re0">$order</span> <span class="sy0">=</span> <span class="st0">'fourth'</span><span class="br0">&#125;</span>
              <span class="br0">&#125;</span>
              WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">&quot; Occurs the $($order) $(Convert-WeekDay $Schedule.Day) of every $($Schedule.ForNumberOfMonths) months effective $($Schedule.StartTime)&quot;</span>
            <span class="br0">&#125;</span>
          <span class="br0">&#125;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'---------------------'</span>
        <span class="br0">&#125;</span>
        <span class="nu0">9</span>
        <span class="br0">&#123;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Software Updates'</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Enable software updates on clients: $($AgentConfig.Enabled)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Software Update scan schedule: '</span> <span class="kw5">-nonewline</span>
          <span class="re0">$Schedule</span> <span class="sy0">=</span> Convert<span class="sy0">-</span>CMSchedule <span class="sy0">-</span>ScheduleString <span class="re0">$AgentConfig</span>.ScanSchedule
          <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.DaySpan <span class="kw4">-gt</span> <span class="nu0">0</span><span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">&quot; Occurs every $($Schedule.DaySpan) days effective $($Schedule.StartTime)&quot;</span>
          <span class="br0">&#125;</span>
          <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.HourSpan <span class="kw4">-gt</span> <span class="nu0">0</span><span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">&quot; Occurs every $($Schedule.HourSpan) hours effective $($Schedule.StartTime)&quot;</span>
          <span class="br0">&#125;</span>
          <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.MinuteSpan <span class="kw4">-gt</span> <span class="nu0">0</span><span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">&quot; Occurs every $($Schedule.MinuteSpan) minutes effective $($Schedule.StartTime)&quot;</span>
          <span class="br0">&#125;</span>
          <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.ForNumberOfWeeks<span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">&quot; Occurs every $($Schedule.ForNumberOfWeeks) weeks on $(Convert-WeekDay $Schedule.Day) effective $($Schedule.StartTime)&quot;</span>
          <span class="br0">&#125;</span>
          <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.ForNumberOfMonths<span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.MonthDay <span class="kw4">-gt</span> <span class="nu0">0</span><span class="br0">&#41;</span>
            <span class="br0">&#123;</span>
              WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">&quot; Occurs on day $($Schedule.MonthDay) of every $($Schedule.ForNumberOfMonths) months effective $($Schedule.StartTime)&quot;</span>
            <span class="br0">&#125;</span>
            <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.MonthDay <span class="kw4">-eq</span> <span class="nu0">0</span><span class="br0">&#41;</span>
            <span class="br0">&#123;</span>
              WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">&quot; Occurs the last day of every $($Schedule.ForNumberOfMonths) months effective $($Schedule.StartTime)&quot;</span>
            <span class="br0">&#125;</span>
            <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.WeekOrder <span class="kw4">-gt</span> <span class="nu0">0</span><span class="br0">&#41;</span>
            <span class="br0">&#123;</span>
              <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.WeekOrder<span class="br0">&#41;</span>
              <span class="br0">&#123;</span>
                <span class="nu0">0</span> <span class="br0">&#123;</span><span class="re0">$order</span> <span class="sy0">=</span> <span class="st0">'last'</span><span class="br0">&#125;</span>
                <span class="nu0">1</span> <span class="br0">&#123;</span><span class="re0">$order</span> <span class="sy0">=</span> <span class="st0">'first'</span><span class="br0">&#125;</span>
                <span class="nu0">2</span> <span class="br0">&#123;</span><span class="re0">$order</span> <span class="sy0">=</span> <span class="st0">'second'</span><span class="br0">&#125;</span>
                <span class="nu0">3</span> <span class="br0">&#123;</span><span class="re0">$order</span> <span class="sy0">=</span> <span class="st0">'third'</span><span class="br0">&#125;</span>
                <span class="nu0">4</span> <span class="br0">&#123;</span><span class="re0">$order</span> <span class="sy0">=</span> <span class="st0">'fourth'</span><span class="br0">&#125;</span>
              <span class="br0">&#125;</span>
              WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">&quot; Occurs the $($order) $(Convert-WeekDay $Schedule.Day) of every $($Schedule.ForNumberOfMonths) months effective $($Schedule.StartTime)&quot;</span>
            <span class="br0">&#125;</span>
          <span class="br0">&#125;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Schedule deployment re-evaluation: '</span> <span class="kw5">-nonewline</span>
          <span class="re0">$Schedule</span> <span class="sy0">=</span> Convert<span class="sy0">-</span>CMSchedule <span class="sy0">-</span>ScheduleString <span class="re0">$AgentConfig</span>.EvaluationSchedule
          <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.DaySpan <span class="kw4">-gt</span> <span class="nu0">0</span><span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">&quot; Occurs every $($Schedule.DaySpan) days effective $($Schedule.StartTime)&quot;</span>
          <span class="br0">&#125;</span>
          <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.HourSpan <span class="kw4">-gt</span> <span class="nu0">0</span><span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">&quot; Occurs every $($Schedule.HourSpan) hours effective $($Schedule.StartTime)&quot;</span>
          <span class="br0">&#125;</span>
          <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.MinuteSpan <span class="kw4">-gt</span> <span class="nu0">0</span><span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">&quot; Occurs every $($Schedule.MinuteSpan) minutes effective $($Schedule.StartTime)&quot;</span>
          <span class="br0">&#125;</span>
          <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.ForNumberOfWeeks<span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">&quot; Occurs every $($Schedule.ForNumberOfWeeks) weeks on $(Convert-WeekDay $Schedule.Day) effective $($Schedule.StartTime)&quot;</span>
          <span class="br0">&#125;</span>
          <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.ForNumberOfMonths<span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.MonthDay <span class="kw4">-gt</span> <span class="nu0">0</span><span class="br0">&#41;</span>
            <span class="br0">&#123;</span>
              WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">&quot; Occurs on day $($Schedule.MonthDay) of every $($Schedule.ForNumberOfMonths) months effective $($Schedule.StartTime)&quot;</span>
            <span class="br0">&#125;</span>
            <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.MonthDay <span class="kw4">-eq</span> <span class="nu0">0</span><span class="br0">&#41;</span>
            <span class="br0">&#123;</span>
              WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">&quot; Occurs the last day of every $($Schedule.ForNumberOfMonths) months effective $($Schedule.StartTime)&quot;</span>
            <span class="br0">&#125;</span>
            <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.WeekOrder <span class="kw4">-gt</span> <span class="nu0">0</span><span class="br0">&#41;</span>
            <span class="br0">&#123;</span>
              <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.WeekOrder<span class="br0">&#41;</span>
              <span class="br0">&#123;</span>
                <span class="nu0">0</span> <span class="br0">&#123;</span><span class="re0">$order</span> <span class="sy0">=</span> <span class="st0">'last'</span><span class="br0">&#125;</span>
                <span class="nu0">1</span> <span class="br0">&#123;</span><span class="re0">$order</span> <span class="sy0">=</span> <span class="st0">'first'</span><span class="br0">&#125;</span>
                <span class="nu0">2</span> <span class="br0">&#123;</span><span class="re0">$order</span> <span class="sy0">=</span> <span class="st0">'second'</span><span class="br0">&#125;</span>
                <span class="nu0">3</span> <span class="br0">&#123;</span><span class="re0">$order</span> <span class="sy0">=</span> <span class="st0">'third'</span><span class="br0">&#125;</span>
                <span class="nu0">4</span> <span class="br0">&#123;</span><span class="re0">$order</span> <span class="sy0">=</span> <span class="st0">'fourth'</span><span class="br0">&#125;</span>
              <span class="br0">&#125;</span>
              WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">&quot; Occurs the $($order) $(Convert-WeekDay $Schedule.Day) of every $($Schedule.ForNumberOfMonths) months effective $($Schedule.StartTime)&quot;</span>
            <span class="br0">&#125;</span>
          <span class="br0">&#125;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'When any software update deployment deadline is reached, install all other software update deployments with deadline coming within a specified period of time: '</span> <span class="kw5">-nonewline</span>
          <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.AssignmentBatchingTimeout <span class="kw4">-eq</span> <span class="st0">'0'</span><span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'No.'</span>
          <span class="br0">&#125;</span>
          <span class="kw3">else</span> 
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Yes.'</span>    
            WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Period of time for which all pending deployments with deadline in this time will also be installed: '</span> <span class="kw5">-nonewline</span>
            <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.AssignmentBatchingTimeout <span class="kw4">-le</span> <span class="st0">'82800'</span><span class="br0">&#41;</span>
            <span class="br0">&#123;</span>
              <span class="re0">$hours</span> <span class="sy0">=</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span><span class="re0">$AgentConfig</span>.AssignmentBatchingTimeout <span class="sy0">/</span> <span class="nu0">60</span> <span class="sy0">/</span> <span class="nu0">60</span> 
              WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">&quot;$($hours) hours&quot;</span>
            <span class="br0">&#125;</span>
            <span class="kw3">else</span> 
            <span class="br0">&#123;</span>
              <span class="re0">$days</span> <span class="sy0">=</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span><span class="re0">$AgentConfig</span>.AssignmentBatchingTimeout <span class="sy0">/</span> <span class="nu0">60</span> <span class="sy0">/</span> <span class="nu0">60</span> <span class="sy0">/</span> <span class="nu0">24</span>
              WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">&quot;$($days) days&quot;</span>
            <span class="br0">&#125;</span>
          <span class="br0">&#125;</span>
&nbsp;
          WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'---------------------'</span>
        <span class="br0">&#125;</span>
        <span class="nu0">10</span>
        <span class="br0">&#123;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'User and Device Affinity'</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;User device affinity usage threshold (minutes): $($AgentConfig.ConsoleMinutes)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;User device affinity usage threshold (days): $($AgentConfig.IntervalDays)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Automatically configure user device affinity from usage data: '</span> <span class="kw5">-nonewline</span> 
          <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.AutoApproveAffinity <span class="kw4">-eq</span> <span class="st0">'0'</span><span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'No'</span>
          <span class="br0">&#125;</span>
          <span class="kw3">else</span>
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Yes'</span>
          <span class="br0">&#125;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'---------------------'</span>
        <span class="br0">&#125;</span>
        <span class="nu0">11</span>
        <span class="br0">&#123;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Background Intelligent Transfer'</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Limit the maximum network bandwidth for BITS background transfers: $($AgentConfig.EnableBitsMaxBandwidth)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Throttling window start time: $($AgentConfig.MaxBandwidthValidFrom)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Throttling window end time: $($AgentConfig.MaxBandwidthValidTo)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Maximum transfer rate during throttling window (kbps): $($AgentConfig.MaxTransferRateOnSchedule)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Allow BITS downloads outside the throttling window: $($AgentConfig.EnableDownloadOffSchedule)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Maximum transfer rate outside the throttling window (Kbps): $($AgentConfig.MaxTransferRateOffSchedule)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'---------------------'</span>
        <span class="br0">&#125;</span>
        <span class="nu0">12</span>
        <span class="br0">&#123;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Enrollment'</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Allow users to enroll mobile devices and Mac computers: '</span> <span class="kw5">-nonewline</span>
          <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.EnableDeviceEnrollment <span class="kw4">-eq</span> <span class="st0">'0'</span><span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'No'</span>
          <span class="br0">&#125;</span>
          <span class="kw3">else</span>
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Yes'</span>
          <span class="br0">&#125;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'---------------------'</span>
        <span class="br0">&#125;</span>
        <span class="nu0">13</span>
        <span class="br0">&#123;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Client Policy'</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Client policy polling interval (minutes): $($AgentConfig.PolicyRequestAssignmentTimeout)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Enable user policy on clients: $($AgentConfig.PolicyEnableUserPolicyPolling)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Enable user policy requests from Internet clients: $($AgentConfig.PolicyEnableUserPolicyOnInternet)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'---------------------'</span>
        <span class="br0">&#125;</span>
        <span class="nu0">15</span>
        <span class="br0">&#123;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Hardware Inventory'</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Enable hardware inventory on clients: $($AgentConfig.Enabled)&quot;</span>
          <span class="re0">$Schedule</span> <span class="sy0">=</span> Convert<span class="sy0">-</span>CMSchedule <span class="sy0">-</span>ScheduleString <span class="re0">$AgentConfig</span>.Schedule
          <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.DaySpan <span class="kw4">-gt</span> <span class="nu0">0</span><span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Hardware inventory schedule: Occurs every $($Schedule.DaySpan) days effective $($Schedule.StartTime)&quot;</span>
          <span class="br0">&#125;</span>
          <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.HourSpan <span class="kw4">-gt</span> <span class="nu0">0</span><span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Hardware inventory schedule: Occurs every $($Schedule.HourSpan) hours effective $($Schedule.StartTime)&quot;</span>
          <span class="br0">&#125;</span>
          <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.MinuteSpan <span class="kw4">-gt</span> <span class="nu0">0</span><span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Hardware inventory schedule: Occurs every $($Schedule.MinuteSpan) minutes effective $($Schedule.StartTime)&quot;</span>
          <span class="br0">&#125;</span>
          <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.ForNumberOfWeeks<span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Hardware inventory schedule: Occurs every $($Schedule.ForNumberOfWeeks) weeks on $(Convert-WeekDay $Schedule.Day) effective $($Schedule.StartTime)&quot;</span>
          <span class="br0">&#125;</span>
          <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.ForNumberOfMonths<span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.MonthDay <span class="kw4">-gt</span> <span class="nu0">0</span><span class="br0">&#41;</span>
            <span class="br0">&#123;</span>
              WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Hardware inventory schedule: Occurs on day $($Schedule.MonthDay) of every $($Schedule.ForNumberOfMonths) months effective $($Schedule.StartTime)&quot;</span>
            <span class="br0">&#125;</span>
            <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.MonthDay <span class="kw4">-eq</span> <span class="nu0">0</span><span class="br0">&#41;</span>
            <span class="br0">&#123;</span>
              WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Hardware inventory schedule: Occurs on last day of every $($Schedule.ForNumberOfMonths) months effective $($Schedule.StartTime)&quot;</span>
            <span class="br0">&#125;</span>
            <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.WeekOrder <span class="kw4">-gt</span> <span class="nu0">0</span><span class="br0">&#41;</span>
            <span class="br0">&#123;</span>
              <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.WeekOrder<span class="br0">&#41;</span>
              <span class="br0">&#123;</span>
                <span class="nu0">0</span> <span class="br0">&#123;</span><span class="re0">$order</span> <span class="sy0">=</span> <span class="st0">'last'</span><span class="br0">&#125;</span>
                <span class="nu0">1</span> <span class="br0">&#123;</span><span class="re0">$order</span> <span class="sy0">=</span> <span class="st0">'first'</span><span class="br0">&#125;</span>
                <span class="nu0">2</span> <span class="br0">&#123;</span><span class="re0">$order</span> <span class="sy0">=</span> <span class="st0">'second'</span><span class="br0">&#125;</span>
                <span class="nu0">3</span> <span class="br0">&#123;</span><span class="re0">$order</span> <span class="sy0">=</span> <span class="st0">'third'</span><span class="br0">&#125;</span>
                <span class="nu0">4</span> <span class="br0">&#123;</span><span class="re0">$order</span> <span class="sy0">=</span> <span class="st0">'fourth'</span><span class="br0">&#125;</span>
              <span class="br0">&#125;</span>
              WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Hardware inventory schedule: Occurs the $($order) $(Convert-WeekDay $Schedule.Day) of every $($Schedule.ForNumberOfMonths) months effective $($Schedule.StartTime)&quot;</span>
            <span class="br0">&#125;</span>
          <span class="br0">&#125;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'---------------------'</span>
        <span class="br0">&#125;</span>
        <span class="nu0">16</span> 
        <span class="br0">&#123;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'State Messaging'</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;State message reporting cycle (minutes): $($AgentConfig.BulkSendInterval)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'---------------------'</span>
        <span class="br0">&#125;</span>
        <span class="nu0">17</span>
        <span class="br0">&#123;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Software Deployment'</span>
          <span class="re0">$Schedule</span> <span class="sy0">=</span> Convert<span class="sy0">-</span>CMSchedule <span class="sy0">-</span>ScheduleString <span class="re0">$AgentConfig</span>.EvaluationSchedule
          <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.DaySpan <span class="kw4">-gt</span> <span class="nu0">0</span><span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Schedule re-evaluation for deployments: Occurs every $($Schedule.DaySpan) days effective $($Schedule.StartTime)&quot;</span>
          <span class="br0">&#125;</span>
          <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.HourSpan <span class="kw4">-gt</span> <span class="nu0">0</span><span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Schedule re-evaluation for deployments: Occurs every $($Schedule.HourSpan) hours effective $($Schedule.StartTime)&quot;</span>
          <span class="br0">&#125;</span>
          <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.MinuteSpan <span class="kw4">-gt</span> <span class="nu0">0</span><span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Schedule re-evaluation for deployments: Occurs every $($Schedule.MinuteSpan) minutes effective $($Schedule.StartTime)&quot;</span>
          <span class="br0">&#125;</span>
          <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.ForNumberOfWeeks<span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Schedule re-evaluation for deployments: Occurs every $($Schedule.ForNumberOfWeeks) weeks on $(Convert-WeekDay $Schedule.Day) effective $($Schedule.StartTime)&quot;</span>
          <span class="br0">&#125;</span>
          <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.ForNumberOfMonths<span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.MonthDay <span class="kw4">-gt</span> <span class="nu0">0</span><span class="br0">&#41;</span>
            <span class="br0">&#123;</span>
              WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Schedule re-evaluation for deployments: Occurs on day $($Schedule.MonthDay) of every $($Schedule.ForNumberOfMonths) months effective $($Schedule.StartTime)&quot;</span>
            <span class="br0">&#125;</span>
            <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.MonthDay <span class="kw4">-eq</span> <span class="nu0">0</span><span class="br0">&#41;</span>
            <span class="br0">&#123;</span>
              WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Schedule re-evaluation for deployments: Occurs on last day of every $($Schedule.ForNumberOfMonths) months effective $($Schedule.StartTime)&quot;</span>
            <span class="br0">&#125;</span>
            <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.WeekOrder <span class="kw4">-gt</span> <span class="nu0">0</span><span class="br0">&#41;</span>
            <span class="br0">&#123;</span>
              <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$Schedule</span>.WeekOrder<span class="br0">&#41;</span>
              <span class="br0">&#123;</span>
                <span class="nu0">0</span> <span class="br0">&#123;</span><span class="re0">$order</span> <span class="sy0">=</span> <span class="st0">'last'</span><span class="br0">&#125;</span>
                <span class="nu0">1</span> <span class="br0">&#123;</span><span class="re0">$order</span> <span class="sy0">=</span> <span class="st0">'first'</span><span class="br0">&#125;</span>
                <span class="nu0">2</span> <span class="br0">&#123;</span><span class="re0">$order</span> <span class="sy0">=</span> <span class="st0">'second'</span><span class="br0">&#125;</span>
                <span class="nu0">3</span> <span class="br0">&#123;</span><span class="re0">$order</span> <span class="sy0">=</span> <span class="st0">'third'</span><span class="br0">&#125;</span>
                <span class="nu0">4</span> <span class="br0">&#123;</span><span class="re0">$order</span> <span class="sy0">=</span> <span class="st0">'fourth'</span><span class="br0">&#125;</span>
              <span class="br0">&#125;</span>
              WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Schedule re-evaluation for deployments: Occurs the $($order) $(Convert-WeekDay $Schedule.Day) of every $($Schedule.ForNumberOfMonths) months effective $($Schedule.StartTime)&quot;</span>
            <span class="br0">&#125;</span>
          <span class="br0">&#125;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'---------------------'</span>
        <span class="br0">&#125;</span>
        <span class="nu0">18</span>
        <span class="br0">&#123;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Power Management'</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Allow power management of clients: $($AgentConfig.Enabled)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Allow users to exclude their device from power management: $($AgentConfig.AllowUserToOptOutFromPowerPlan)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Enable wake-up proxy: $($AgentConfig.EnableWakeupProxy)&quot;</span>
          <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.EnableWakeupProxy <span class="kw4">-eq</span> <span class="st0">'True'</span><span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Wake-up proxy port number (UDP): $($AgentConfig.Port)&quot;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Wake On LAN port number (UDP): $($AgentConfig.WolPort)&quot;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Windows Firewall exception for wake-up proxy: '</span> <span class="kw5">-nonewline</span>
            <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.WakeupProxyFirewallFlags<span class="br0">&#41;</span>
            <span class="br0">&#123;</span>
              <span class="nu0">0</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'disabled'</span> <span class="br0">&#125;</span>
              <span class="nu0">9</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Enabled: Public.'</span> <span class="br0">&#125;</span>
              <span class="nu0">10</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Enabled: Private.'</span> <span class="br0">&#125;</span>
              <span class="nu0">11</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Enabled: Private, Public.'</span> <span class="br0">&#125;</span>
              <span class="nu0">12</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Enabled: Domain.'</span> <span class="br0">&#125;</span>
              <span class="nu0">13</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Enabled: Domain, Public.'</span> <span class="br0">&#125;</span>
              <span class="nu0">14</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Enabled: Domain, Private.'</span> <span class="br0">&#125;</span>
              <span class="nu0">15</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Enabled: Domain, Private, Public.'</span> <span class="br0">&#125;</span>
            <span class="br0">&#125;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;IPv6 prefixes if required for DirectAccess or other intervening network devices. Use a comma to specifiy multiple entries: $($AgentConfig.WakeupProxyDirectAccessPrefixList)&quot;</span>
          <span class="br0">&#125;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'---------------------'</span>
        <span class="br0">&#125;</span>
        <span class="nu0">20</span>
        <span class="br0">&#123;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Endpoint Protection'</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Manage Endpoint Protection client on client computers: $($AgentConfig.EnableEP)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Install Endpoint Protection client on client computers: $($AgentConfig.InstallSCEPClient)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Automatically remove previously installed antimalware software before Endpoint Protection is installed: $($AgentConfig.Remove3rdParty)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Allow Endpoint Protection client installation and restarts outside maintenance windows. Maintenance windows must be at least 30 minutes long for client installation: $($AgentConfig.OverrideMaintenanceWindow)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;For Windows Embedded devices with write filters, commit Endpoint Protection client installation (requires restart): $($AgentConfig.PersistInstallation)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Suppress any required computer restarts after the Endpoint Protection client is installed: $($AgentConfig.SuppressReboot)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Allowed period of time users can postpone a required restart to complete the Endpoint Protection installation (hours): $($AgentConfig.ForceRebootPeriod)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Disable alternate sources (such as Microsoft Windows Update, Microsoft Windows Server Update Services, or UNC shares) for the initial definition update on client computers: $($AgentConfig.DisableFirstSignatureUpdate)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'---------------------'</span>
        <span class="br0">&#125;</span>
        <span class="nu0">21</span>
        <span class="br0">&#123;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Computer Restart'</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Display a temporary notification to the user that indicates the interval before the user is logged of or the computer restarts (minutes): $($AgentConfig.RebootLogoffNotificationCountdownDuration)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Display a dialog box that the user cannot close, which displays the countdown interval before the user is logged of or the computer restarts (minutes): $([string]$AgentConfig.RebootLogoffNotificationFinalWindow / 60)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'---------------------'</span>
        <span class="br0">&#125;</span>
        <span class="nu0">22</span>
        <span class="br0">&#123;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Cloud Services'</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Allow access to Cloud Distribution Point: $($AgentConfig.AllowCloudDP)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'---------------------'</span>
        <span class="br0">&#125;</span>
        <span class="nu0">23</span>
        <span class="br0">&#123;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Metered Internet Connections'</span>
          <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.MeteredNetworkUsage<span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            <span class="nu0">1</span> <span class="br0">&#123;</span> <span class="re0">$Usage</span> <span class="sy0">=</span> <span class="st0">'Allow'</span> <span class="br0">&#125;</span>
            <span class="nu0">2</span> <span class="br0">&#123;</span> <span class="re0">$Usage</span> <span class="sy0">=</span> <span class="st0">'Limit'</span> <span class="br0">&#125;</span>
            <span class="nu0">4</span> <span class="br0">&#123;</span> <span class="re0">$Usage</span> <span class="sy0">=</span> <span class="st0">'Block'</span> <span class="br0">&#125;</span>
          <span class="br0">&#125;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Specifiy how clients communicate on metered network connections: $($Usage)&quot;</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
        <span class="br0">&#125;</span>
&nbsp;
      <span class="br0">&#125;</span>
    <span class="br0">&#125;</span>
    catch <span class="br0">&#91;</span>System.Management.Automation.PropertyNotFoundException<span class="br0">&#93;</span> 
    <span class="br0">&#123;</span>
      WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
    <span class="br0">&#125;</span>
  <span class="br0">&#125;</span>
<span class="br0">&#125;</span>
<span class="co1">#endregion enumerating Client Policies</span>
&nbsp;
<span class="co1">#region Security</span>
&nbsp;
<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date):   Collecting all administrative users&quot;</span>
WriteWordLine <span class="nu0">2</span> <span class="nu0">0</span> <span class="st0">'Administrative Users'</span>
<span class="re0">$Admins</span> <span class="sy0">=</span> Get<span class="sy0">-</span>CMAdministrativeUser
&nbsp;
WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">'Enumerating administrative users:'</span>
&nbsp;
<span class="re0">$AdminHashArray</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
<span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$Admin</span> <span class="kw3">in</span> <span class="re0">$Admins</span><span class="br0">&#41;</span> 
<span class="br0">&#123;</span>
  <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$Admin</span>.AccountType<span class="br0">&#41;</span>
  <span class="br0">&#123;</span>
    <span class="nu0">0</span> <span class="br0">&#123;</span> <span class="re0">$AccountType</span> <span class="sy0">=</span> <span class="st0">'User'</span> <span class="br0">&#125;</span>
    <span class="nu0">1</span> <span class="br0">&#123;</span> <span class="re0">$AccountType</span> <span class="sy0">=</span> <span class="st0">'Group'</span> <span class="br0">&#125;</span>
    <span class="nu0">2</span> <span class="br0">&#123;</span> <span class="re0">$AccountType</span> <span class="sy0">=</span> <span class="st0">'Machine'</span> <span class="br0">&#125;</span> 
  <span class="br0">&#125;</span> 
&nbsp;
  <span class="re0">$AdminRow</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#123;</span>Name <span class="sy0">=</span> <span class="re0">$Admin</span>.LogonName; <span class="st0">'Account Type'</span> <span class="sy0">=</span> <span class="re0">$AccountType</span>; <span class="st0">'Security Roles'</span> <span class="sy0">=</span> <span class="st0">&quot;$($Admin.RoleNames)&quot;</span>; <span class="st0">'Security Scopes'</span> <span class="sy0">=</span> <span class="st0">&quot;$($Admin.CategoryNames)&quot;</span>; Collections <span class="sy0">=</span> <span class="st0">&quot;$($Admin.CollectionNames)&quot;</span>;<span class="br0">&#125;</span>
  <span class="re0">$AdminHashArray</span> <span class="sy0">+=</span> <span class="re0">$AdminRow</span>;
<span class="br0">&#125;</span>
&nbsp;
<span class="re0">$Table</span> <span class="sy0">=</span> AddWordTable <span class="sy0">-</span>Hashtable <span class="re0">$AdminHashArray</span> <span class="sy0">-</span>Columns Name<span class="sy0">,</span> <span class="st0">'Account Type'</span><span class="sy0">,</span> <span class="st0">'Security Roles'</span><span class="sy0">,</span> <span class="st0">'Security Scopes'</span><span class="sy0">,</span> Collections <span class="sy0">-</span>Headers Name<span class="sy0">,</span> <span class="st0">'Account Type'</span><span class="sy0">,</span> <span class="st0">'Security Roles'</span><span class="sy0">,</span> <span class="st0">'Security Scopes'</span><span class="sy0">,</span> Collections <span class="kw5">-Format</span> <span class="sy0">-</span><span class="nu0">155</span> <span class="sy0">-</span>AutoFit <span class="re0">$wdAutoFitContent</span>;
&nbsp;
<span class="co1">## Set first column format</span>
SetWordCellFormat <span class="sy0">-</span>Collection <span class="re0">$Table</span>.Rows.Item<span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>.Cells <span class="sy0">-</span>Bold <span class="kw5">-BackgroundColor</span> <span class="re0">$wdColorGray15</span>;
&nbsp;
&nbsp;
FindWordDocumentEnd
<span class="re0">$Table</span> <span class="sy0">=</span> <span class="re0">$Null</span>
&nbsp;
<span class="co1">#endregion Security</span>
&nbsp;
<span class="co1">#region enumerating all custom Security roles</span>
<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date):   enumerating all custom build security roles&quot;</span>
WriteWordLine <span class="nu0">2</span> <span class="nu0">0</span> <span class="st0">'Custom Security Roles'</span>
<span class="re0">$SecurityRoles</span> <span class="sy0">=</span> Get<span class="sy0">-</span>CMSecurityRole <span class="sy0">|</span> <span class="kw1">Where-Object</span> <span class="kw5">-FilterScript</span> <span class="br0">&#123;</span><span class="kw4">-not</span> <a href="about:blank"><span class="kw6">$_</span></a>.IsBuiltIn<span class="br0">&#125;</span>
<span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$SecurityRoles</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
  <span class="re0">$SRHashArray</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
  WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">'Enumerating all custom build security roles:'</span>
&nbsp;
  <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$SecurityRole</span> <span class="kw3">in</span> <span class="re0">$SecurityRoles</span><span class="br0">&#41;</span>
  <span class="br0">&#123;</span>
    <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$SecurityRole</span>.NumberOfAdmins <span class="kw4">-gt</span> <span class="nu0">0</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
      <span class="re0">$Members</span> <span class="sy0">=</span> $<span class="br0">&#40;</span>Get<span class="sy0">-</span>CMAdministrativeUser <span class="sy0">|</span> <span class="kw1">Where-Object</span> <span class="kw5">-FilterScript</span> <span class="br0">&#123;</span><a href="about:blank"><span class="kw6">$_</span></a>.Roles <span class="kw4">-ilike</span> <span class="st0">&quot;$($SecurityRole.RoleID)&quot;</span><span class="br0">&#125;</span><span class="br0">&#41;</span>.LogonName
    <span class="br0">&#125;</span>
    <span class="re0">$SRRow</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#123;</span>Name <span class="sy0">=</span> <span class="re0">$SecurityRole</span>.RoleName; Description <span class="sy0">=</span> <span class="re0">$SecurityRole</span>.RoleDescription; <span class="st0">'Copied From'</span> <span class="sy0">=</span> $<span class="br0">&#40;</span><span class="br0">&#40;</span>Get<span class="sy0">-</span>CMSecurityRole <span class="kw5">-Id</span> <span class="re0">$SecurityRole</span>.CopiedFromID<span class="br0">&#41;</span>.RoleName<span class="br0">&#41;</span>; Members <span class="sy0">=</span> <span class="st0">&quot;$Members&quot;</span>; <span class="st0">'Role ID'</span> <span class="sy0">=</span> <span class="re0">$SecurityRole</span>.RoleID;<span class="br0">&#125;</span>
    <span class="re0">$SRHashArray</span> <span class="sy0">+=</span> <span class="re0">$SRRow</span>;
  <span class="br0">&#125;</span>
&nbsp;
  <span class="re0">$Table</span> <span class="sy0">=</span> AddWordTable <span class="sy0">-</span>Hashtable <span class="re0">$SRHashArray</span> <span class="sy0">-</span>Columns Name<span class="sy0">,</span> Description<span class="sy0">,</span> <span class="st0">'Copied From'</span><span class="sy0">,</span> Members <span class="sy0">-</span>Headers Name<span class="sy0">,</span> Description<span class="sy0">,</span> <span class="st0">'Copied From'</span><span class="sy0">,</span> Members <span class="kw5">-Format</span> <span class="sy0">-</span><span class="nu0">155</span> <span class="sy0">-</span>AutoFit <span class="re0">$wdAutoFitContent</span>;
&nbsp;
  <span class="co1">## Set first column format</span>
  SetWordCellFormat <span class="sy0">-</span>Collection <span class="re0">$Table</span>.Rows.Item<span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>.Cells <span class="sy0">-</span>Bold <span class="kw5">-BackgroundColor</span> <span class="re0">$wdColorGray15</span>;
&nbsp;
  FindWordDocumentEnd
  <span class="re0">$Table</span> <span class="sy0">=</span> <span class="re0">$Null</span>
&nbsp;
<span class="br0">&#125;</span>
<span class="kw3">else</span>
<span class="br0">&#123;</span>
  WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">'There are no custom built security roles.'</span>
<span class="br0">&#125;</span>
&nbsp;
<span class="co1">#endregion enumerating all custom Security roles</span>
&nbsp;
<span class="co1">#region Used Accounts</span>
&nbsp;
<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date):   Enumerating all used accounts&quot;</span>
WriteWordLine <span class="nu0">2</span> <span class="nu0">0</span> <span class="st0">'Configured Accounts'</span>
<span class="re0">$Accounts</span> <span class="sy0">=</span> Get<span class="sy0">-</span>CMAccount
WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">'Enumerating all accounts used for specific tasks.'</span>
&nbsp;
<span class="re0">$AccountsHashArray</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
<span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$Account</span> <span class="kw3">in</span> <span class="re0">$Accounts</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
  <span class="re0">$AccountRow</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#123;</span><span class="st0">'User Name'</span><span class="sy0">=</span> <span class="re0">$Account</span>.UserName; <span class="st0">'Account Usage'</span> <span class="sy0">=</span> <span class="kw3">if</span> <span class="br0">&#40;</span><span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$Account</span>.AccountUsage<span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span><span class="st0">'not assigned'</span><span class="br0">&#125;</span> <span class="kw3">else</span> <span class="br0">&#123;</span><span class="st0">&quot;$($Account.AccountUsage)&quot;</span><span class="br0">&#125;</span>; <span class="st0">'Site Code'</span> <span class="sy0">=</span> <span class="re0">$Account</span>.SiteCode<span class="br0">&#125;</span>;
  <span class="re0">$AccountsHashArray</span> <span class="sy0">+=</span> <span class="re0">$AccountRow</span>;
<span class="br0">&#125;</span>
&nbsp;
<span class="re0">$Table</span> <span class="sy0">=</span> AddWordTable <span class="sy0">-</span>Hashtable <span class="re0">$AccountsHashArray</span> <span class="sy0">-</span>Columns <span class="st0">'User Name'</span><span class="sy0">,</span> <span class="st0">'Account Usage'</span><span class="sy0">,</span> <span class="st0">'Site Code'</span> <span class="sy0">-</span>Headers <span class="st0">'User Name'</span><span class="sy0">,</span> <span class="st0">'Account Usage'</span><span class="sy0">,</span> <span class="st0">'Site Code'</span> <span class="kw5">-Format</span> <span class="sy0">-</span><span class="nu0">155</span> <span class="sy0">-</span>AutoFit <span class="re0">$wdAutoFitContent</span>;
&nbsp;
<span class="co1">## Set first column format</span>
SetWordCellFormat <span class="sy0">-</span>Collection <span class="re0">$Table</span>.Rows.Item<span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>.Cells <span class="sy0">-</span>Bold <span class="kw5">-BackgroundColor</span> <span class="re0">$wdColorGray15</span>;
&nbsp;
FindWordDocumentEnd
<span class="re0">$Table</span> <span class="sy0">=</span> <span class="re0">$Null</span>
&nbsp;
<span class="co1">#endregion Used Accounts</span>
&nbsp;
<span class="co1">####</span>
<span class="co1">#region Assets and Compliance</span>
<span class="co1">####</span>
<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date):   Done with Administration, next Assets and Compliance&quot;</span>
WriteWordLine <span class="nu0">1</span> <span class="nu0">0</span> <span class="st0">'Assets and Compliance'</span>
&nbsp;
<span class="co1">#region enumerating all User Collections</span>
WriteWordLine <span class="nu0">2</span> <span class="nu0">0</span> <span class="st0">'Summary of User Collections'</span>
<span class="re0">$UserCollections</span> <span class="sy0">=</span> Get<span class="sy0">-</span>CMUserCollection
<span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$ListAllInformation</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
  <span class="re0">$UserCollHashArray</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
  <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$UserCollection</span> <span class="kw3">in</span> <span class="re0">$UserCollections</span><span class="br0">&#41;</span>
  <span class="br0">&#123;</span>
    <span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date):   Found User Collection: $($UserCollection.Name)&quot;</span>
&nbsp;
    <span class="re0">$UserCollRow</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#123;</span><span class="st0">'Collection Name'</span> <span class="sy0">=</span> <span class="re0">$UserCollection</span>.Name; <span class="st0">'Collection ID'</span> <span class="sy0">=</span> <span class="re0">$UserCollection</span>.CollectionID; <span class="st0">'Member Count'</span> <span class="sy0">=</span> <span class="re0">$UserCollection</span>.MemberCount; <span class="st0">'Limited To'</span> <span class="sy0">=</span> <span class="st0">&quot;$($UserCollection.LimitToCollectionName) / $($UserCollection.LimitToCollectionID)&quot;</span>;<span class="br0">&#125;</span>;
    <span class="re0">$UserCollHashArray</span> <span class="sy0">+=</span> <span class="re0">$UserCollRow</span>;
  <span class="br0">&#125;</span>
  <span class="re0">$Table</span> <span class="sy0">=</span> AddWordTable <span class="sy0">-</span>Hashtable <span class="re0">$UserCollHashArray</span> <span class="sy0">-</span>Columns <span class="st0">'Collection Name'</span><span class="sy0">,</span> <span class="st0">'Collection ID'</span><span class="sy0">,</span> <span class="st0">'Member Count'</span><span class="sy0">,</span> <span class="st0">'Limited To'</span> <span class="sy0">-</span>Headers <span class="st0">'Collection Name'</span><span class="sy0">,</span> <span class="st0">'Collection ID'</span><span class="sy0">,</span> <span class="st0">'Member Count'</span><span class="sy0">,</span> <span class="st0">'Limited To'</span> <span class="kw5">-Format</span> <span class="sy0">-</span><span class="nu0">155</span> <span class="sy0">-</span>AutoFit <span class="re0">$wdAutoFitContent</span>;
&nbsp;
  <span class="co1">## Set first column format</span>
  SetWordCellFormat <span class="sy0">-</span>Collection <span class="re0">$Table</span>.Rows.Item<span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>.Cells <span class="sy0">-</span>Bold <span class="kw5">-BackgroundColor</span> <span class="re0">$wdColorGray15</span>
&nbsp;
  FindWordDocumentEnd
  <span class="re0">$Table</span> <span class="sy0">=</span> <span class="re0">$Null</span>
<span class="br0">&#125;</span>
<span class="kw3">else</span>
<span class="br0">&#123;</span>
  WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">&quot;There are $($UserCollections.count) User Collections.&quot;</span> 
<span class="br0">&#125;</span>
&nbsp;
<span class="co1">#endregion enumerating all User Collections</span>
&nbsp;
<span class="co1">#region enumerating all Device Collections</span>
WriteWordLine <span class="nu0">2</span> <span class="nu0">0</span> <span class="st0">'Summary of Device Collections'</span>
<span class="re0">$DeviceCollections</span> <span class="sy0">=</span> Get<span class="sy0">-</span>CMDeviceCollection
<span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$ListAllInformation</span><span class="br0">&#41;</span>
<span class="br0">&#123;</span>
  <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$DeviceCollection</span> <span class="kw3">in</span> <span class="re0">$DeviceCollections</span><span class="br0">&#41;</span>
  <span class="br0">&#123;</span>
    <span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date):   Found Device Collection: $($DeviceCollection.Name)&quot;</span>
    WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">&quot;Collection Name: $($DeviceCollection.Name)&quot;</span> <span class="sy0">-</span>boldface <span class="re0">$true</span>
    WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">&quot;Collection ID: $($DeviceCollection.CollectionID)&quot;</span>
    WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">&quot;Total count of members: $($DeviceCollection.MemberCount)&quot;</span>
    WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">&quot;Limited to Device Collection: $($DeviceCollection.LimitToCollectionName) / $($DeviceCollection.LimitToCollectionID)&quot;</span>
    <span class="re0">$CollSettings</span> <span class="sy0">=</span> <span class="kw1">Get-WmiObject</span> <span class="kw5">-Class</span> SMS_CollectionSettings <span class="kw5">-Namespace</span> root\sms\site_<span class="re0">$SiteCode</span> <span class="kw5">-ComputerName</span> <span class="re0">$SMSProvider</span> <span class="sy0">|</span> <span class="kw1">Where-Object</span> <span class="br0">&#123;</span><a href="about:blank"><span class="kw6">$_</span></a>.CollectionID <span class="kw4">-eq</span> <span class="st0">&quot;$($DeviceCollection.CollectionID)&quot;</span><span class="br0">&#125;</span>
    <span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#91;</span><span class="re3">String</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$CollSettings</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
        <span class="br0">&#123;</span>
            <span class="re0">$CollSettings</span> <span class="sy0">=</span> <span class="br0">&#91;</span><span class="re3">wmi</span><span class="br0">&#93;</span><span class="re0">$CollSettings</span>.__PATH
            <span class="re0">$ServiceWindows</span> <span class="sy0">=</span> $<span class="br0">&#40;</span><span class="re0">$CollSettings</span>.ServiceWindows<span class="br0">&#41;</span>
            <span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$ServiceWindows</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
                <span class="br0">&#123;</span>
                    <span class="co1">#$ServiceWindows</span>
                    WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Checking Maintenance Windows on Collection:'</span> 
                    <span class="co1">#$ServiceWindows = [wmi]$ServiceWindows.__PATH</span>
&nbsp;
                    <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$ServiceWindow</span> <span class="kw3">in</span> <span class="re0">$ServiceWindows</span><span class="br0">&#41;</span>
                        <span class="br0">&#123;</span>
&nbsp;
                            <span class="re0">$ScheduleString</span> <span class="sy0">=</span> Read<span class="sy0">-</span>ScheduleToken
                            <span class="re0">$startTime</span> <span class="sy0">=</span> <span class="re0">$ScheduleString</span>.TokenData.starttime
                            <span class="re0">$startTime</span> <span class="sy0">=</span> Convert<span class="sy0">-</span>NormalDateToConfigMgrDate <span class="sy0">-</span>starttime <span class="re0">$startTime</span>
                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Maintenance window name: $($ServiceWindow.Name)&quot;</span>
                            <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$ServiceWindow</span>.ServiceWindowType<span class="br0">&#41;</span>
                                <span class="br0">&#123;</span>
                                    <span class="nu0">0</span> <span class="br0">&#123;</span>WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">'This is a Task Sequence maintenance window'</span><span class="br0">&#125;</span>
                                    <span class="nu0">1</span> <span class="br0">&#123;</span>WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">'This is a general maintenance window'</span><span class="br0">&#125;</span>                        
                                <span class="br0">&#125;</span>   
                            <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$ServiceWindow</span>.RecurrenceType<span class="br0">&#41;</span>
                                <span class="br0">&#123;</span>
                                    <span class="nu0">1</span> <span class="br0">&#123;</span>WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;This maintenance window occurs only once on $($startTime) and lasts for $($ScheduleString.TokenData.HourDuration) hour(s) and $($ScheduleString.TokenData.MinuteDuration) minute(s).&quot;</span><span class="br0">&#125;</span>
                                    <span class="nu0">2</span> 
                                        <span class="br0">&#123;</span>
                                            <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$ScheduleString</span>.TokenData.DaySpan <span class="kw4">-eq</span> <span class="st0">'1'</span><span class="br0">&#41;</span>
                                                <span class="br0">&#123;</span>
                                                    <span class="re0">$daily</span> <span class="sy0">=</span> <span class="st0">'daily'</span>
                                                <span class="br0">&#125;</span>
                                            <span class="kw3">else</span>
                                                <span class="br0">&#123;</span>
                                                    <span class="re0">$daily</span> <span class="sy0">=</span> <span class="st0">&quot;every $($ScheduleString.TokenData.DaySpan) days&quot;</span>
                                                <span class="br0">&#125;</span>
&nbsp;
                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;This maintenance window occurs $($daily).&quot;</span>
                                        <span class="br0">&#125;</span>
                                    <span class="nu0">3</span> 
                                        <span class="br0">&#123;</span>                                              
                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;This maintenance window occurs every $($ScheduleString.TokenData.ForNumberofWeeks) week(s) on $(Convert-WeekDay $ScheduleString.TokenData.Day) and lasts $($ScheduleString.TokenData.HourDuration) hour(s) and $($ScheduleString.TokenData.MinuteDuration) minute(s) starting on $($startTime).&quot;</span>
                                        <span class="br0">&#125;</span>
                                    <span class="nu0">4</span> 
                                        <span class="br0">&#123;</span>
                                            <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$ScheduleString</span>.TokenData.weekorder<span class="br0">&#41;</span>
                                                <span class="br0">&#123;</span>
                                                    <span class="nu0">0</span> <span class="br0">&#123;</span><span class="re0">$order</span> <span class="sy0">=</span> <span class="st0">'last'</span><span class="br0">&#125;</span>
                                                    <span class="nu0">1</span> <span class="br0">&#123;</span><span class="re0">$order</span> <span class="sy0">=</span> <span class="st0">'first'</span><span class="br0">&#125;</span>
                                                    <span class="nu0">2</span> <span class="br0">&#123;</span><span class="re0">$order</span> <span class="sy0">=</span> <span class="st0">'second'</span><span class="br0">&#125;</span>
                                                    <span class="nu0">3</span> <span class="br0">&#123;</span><span class="re0">$order</span> <span class="sy0">=</span> <span class="st0">'third'</span><span class="br0">&#125;</span>
                                                    <span class="nu0">4</span> <span class="br0">&#123;</span><span class="re0">$order</span> <span class="sy0">=</span> <span class="st0">'fourth'</span><span class="br0">&#125;</span>
                                                <span class="br0">&#125;</span>
                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;This maintenance window occurs every $($ScheduleString.TokenData.ForNumberofMonths) month(s) on every $($order) $(Convert-WeekDay $ScheduleString.TokenData.Day)&quot;</span>
                                        <span class="br0">&#125;</span>
&nbsp;
                                    <span class="nu0">5</span> 
                                        <span class="br0">&#123;</span>
                                            <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$ScheduleString</span>.TokenData.MonthDay <span class="kw4">-eq</span> <span class="st0">'0'</span><span class="br0">&#41;</span>
                                                <span class="br0">&#123;</span> 
                                                    <span class="re0">$DayOfMonth</span> <span class="sy0">=</span> <span class="st0">'the last day of the month'</span>
                                                <span class="br0">&#125;</span>
                                            <span class="kw3">else</span>
                                                <span class="br0">&#123;</span>
                                                    <span class="re0">$DayOfMonth</span> <span class="sy0">=</span> <span class="st0">&quot;day $($ScheduleString.TokenData.MonthDay)&quot;</span>
                                                <span class="br0">&#125;</span>
                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;This maintenance window occurs every $($ScheduleString.TokenData.ForNumberofMonths) month(s) on $($DayOfMonth).&quot;</span>
                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;It lasts $($ScheduleString.TokenData.HourDuration) hours and $($ScheduleString.TokenData.MinuteDuration) minutes.&quot;</span>
                                        <span class="br0">&#125;</span>
                                <span class="br0">&#125;</span>
                            <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$ServiceWindow</span>.IsEnabled<span class="br0">&#41;</span>
                                <span class="br0">&#123;</span>
                                    true <span class="br0">&#123;</span>WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">'The maintenance window is enabled'</span><span class="br0">&#125;</span>
                                    false <span class="br0">&#123;</span>WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">'The maintenance window is disabled'</span><span class="br0">&#125;</span>
                                <span class="br0">&#125;</span>
                        <span class="br0">&#125;</span>
                <span class="br0">&#125;</span>
            <span class="kw3">else</span>
                <span class="br0">&#123;</span>
                    WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'No maintenance windows configured on this collection.'</span>
                <span class="br0">&#125;</span>
        <span class="br0">&#125;</span>
        try <span class="br0">&#123;</span>
            <span class="re0">$CollVars</span> <span class="sy0">=</span> Get<span class="sy0">-</span>CMDeviceCollectionVariable <span class="sy0">-</span>CollectionId <span class="re0">$DeviceCollection</span>.CollectionID
            <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$CollVars</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
                <span class="re0">$CollVarsHashArray</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
                <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$CollVar</span> <span class="kw3">in</span> <span class="re0">$CollVars</span><span class="br0">&#41;</span>
                <span class="br0">&#123;</span>
                  <span class="re0">$CollVarRow</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#123;</span><span class="st0">'Variable Name'</span><span class="sy0">=</span> <span class="re0">$CollVar</span>.Name; <span class="st0">'Value'</span> <span class="sy0">=</span> <span class="re0">$CollVar</span>.Value; <span class="st0">'Hidden Value'</span> <span class="sy0">=</span> <span class="re0">$CollVar</span>.IsMasked<span class="br0">&#125;</span>;
                  <span class="re0">$CollVarsHashArray</span> <span class="sy0">+=</span> <span class="re0">$CollVarRow</span>;
                <span class="br0">&#125;</span>
&nbsp;
                <span class="re0">$Table</span> <span class="sy0">=</span> AddWordTable <span class="sy0">-</span>Hashtable <span class="re0">$CollVarsHashArray</span> <span class="sy0">-</span>Columns <span class="st0">'Variable Name'</span><span class="sy0">,</span> <span class="st0">'Value'</span><span class="sy0">,</span> <span class="st0">'Hidden Value'</span> <span class="sy0">-</span>Headers <span class="st0">'Variable Name'</span><span class="sy0">,</span> <span class="st0">'Value'</span><span class="sy0">,</span> <span class="st0">'Hidden Value'</span> <span class="kw5">-Format</span> <span class="sy0">-</span><span class="nu0">155</span> <span class="sy0">-</span>AutoFit <span class="re0">$wdAutoFitContent</span>
&nbsp;
                <span class="co1">## Set first column format</span>
                SetWordCellFormat <span class="sy0">-</span>Collection <span class="re0">$Table</span>.Rows.Item<span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>.Cells <span class="sy0">-</span>Bold <span class="kw5">-BackgroundColor</span> <span class="re0">$wdColorGray15</span>;
&nbsp;
                FindWordDocumentEnd
                <span class="re0">$Table</span> <span class="sy0">=</span> <span class="re0">$Null</span>
            <span class="br0">&#125;</span>
            <span class="kw3">else</span> <span class="br0">&#123;</span>
                WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">'Enumerating device collection variables: No device collection variables configured!'</span>
            <span class="br0">&#125;</span>
        <span class="br0">&#125;</span>
        catch <span class="br0">&#91;</span>System.Management.Automation.PropertyNotFoundException<span class="br0">&#93;</span> <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
        <span class="br0">&#125;</span>
        <span class="co1">### enumerating the Collection Membership Rules</span>
        <span class="re0">$QueryRules</span> <span class="sy0">=</span> <span class="re0">$Null</span>
        <span class="re0">$DirectRules</span> <span class="sy0">=</span> <span class="re0">$Null</span>
        <span class="re0">$IncludeRules</span> <span class="sy0">=</span> <span class="re0">$Null</span>
        <span class="re0">$CollectionRules</span> <span class="sy0">=</span> <span class="re0">$DeviceCollection</span>.CollectionRules <span class="co1">#just for Direct and Query</span>
&nbsp;
        <span class="re0">$Collection</span> <span class="sy0">=</span> <span class="kw1">Get-WmiObject</span> <span class="kw5">-Namespace</span> root\sms\site_<span class="re0">$SiteCode</span> <span class="kw5">-Query</span> <span class="st0">&quot;SELECT * FROM SMS_Collection WHERE CollectionID = '$($DeviceCollection.CollectionID)'&quot;</span> <span class="kw5">-ComputerName</span> <span class="re0">$SMSProvider</span>
        <span class="br0">&#91;</span><span class="re3">wmi</span><span class="br0">&#93;</span><span class="re0">$Collection</span> <span class="sy0">=</span> <span class="re0">$Collection</span>.__PATH
&nbsp;
        <span class="re0">$OtherCollectionRules</span> <span class="sy0">=</span> <span class="re0">$Collection</span>.CollectionRules
        try <span class="br0">&#123;</span>
            <span class="re0">$DirectRules</span> <span class="sy0">=</span> <span class="re0">$CollectionRules</span> <span class="sy0">|</span> <span class="kw3">where</span> <span class="br0">&#123;</span><a href="about:blank"><span class="kw6">$_</span></a>.ResourceID<span class="br0">&#125;</span> <span class="kw5">-ErrorAction</span> SilentlyContinue
        <span class="br0">&#125;</span>
        catch <span class="br0">&#91;</span>System.Management.Automation.PropertyNotFoundException<span class="br0">&#93;</span> <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
        <span class="br0">&#125;</span>
        try <span class="br0">&#123;</span>
            <span class="re0">$QueryRules</span> <span class="sy0">=</span> <span class="re0">$CollectionRules</span> <span class="sy0">|</span> <span class="kw3">where</span> <span class="br0">&#123;</span><a href="about:blank"><span class="kw6">$_</span></a>.QueryExpression<span class="br0">&#125;</span> <span class="kw5">-ErrorAction</span> SilentlyContinue                            
        <span class="br0">&#125;</span>
        catch <span class="br0">&#91;</span>System.Management.Automation.PropertyNotFoundException<span class="br0">&#93;</span> <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
        <span class="br0">&#125;</span>
        try <span class="br0">&#123;</span>
            <span class="re0">$IncludeRules</span> <span class="sy0">=</span> <span class="re0">$OtherCollectionRules</span> <span class="sy0">|</span> <span class="kw3">where</span> <span class="br0">&#123;</span><a href="about:blank"><span class="kw6">$_</span></a>.IncludeCollectionID<span class="br0">&#125;</span> <span class="kw5">-ErrorAction</span> SilentlyContinue
        <span class="br0">&#125;</span>
        catch <span class="br0">&#91;</span>System.Management.Automation.PropertyNotFoundException<span class="br0">&#93;</span> <span class="br0">&#123;</span>
                    WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
        <span class="br0">&#125;</span>
&nbsp;
        <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$QueryRules</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>            
            <span class="re0">$QueryRulesHashArray</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
            <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$QueryRule</span> <span class="kw3">in</span> <span class="re0">$QueryRules</span><span class="br0">&#41;</span>
            <span class="br0">&#123;</span>
                <span class="re0">$QueryRuleRow</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#123;</span><span class="st0">'Query Name'</span><span class="sy0">=</span> <span class="re0">$QueryRule</span>.RuleName; <span class="st0">'Query Expression'</span> <span class="sy0">=</span> <span class="re0">$QueryRule</span>.QueryExpression; <span class="st0">'Query ID'</span> <span class="sy0">=</span> <span class="re0">$QueryRule</span>.QueryId<span class="br0">&#125;</span>;
                <span class="re0">$QueryRulesHashArray</span> <span class="sy0">+=</span> <span class="re0">$QueryRuleRow</span>;
            <span class="br0">&#125;</span>
&nbsp;
            <span class="re0">$Table</span> <span class="sy0">=</span> AddWordTable <span class="sy0">-</span>Hashtable <span class="re0">$QueryRulesHashArray</span> <span class="sy0">-</span>Columns <span class="st0">'Query Name'</span><span class="sy0">,</span> <span class="st0">'Query Expression'</span><span class="sy0">,</span> <span class="st0">'Query ID'</span> <span class="sy0">-</span>Headers <span class="st0">'Query Name'</span><span class="sy0">,</span> <span class="st0">'Query Expression'</span><span class="sy0">,</span> <span class="st0">'Query ID'</span> <span class="kw5">-Format</span> <span class="sy0">-</span><span class="nu0">155</span> <span class="sy0">-</span>AutoFit <span class="re0">$wdAutoFitContent</span>;
&nbsp;
            <span class="co1">## Set first column format</span>
            SetWordCellFormat <span class="sy0">-</span>Collection <span class="re0">$Table</span>.Rows.Item<span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>.Cells <span class="sy0">-</span>Bold <span class="kw5">-BackgroundColor</span> <span class="re0">$wdColorGray15</span>;
&nbsp;
            FindWordDocumentEnd
            <span class="re0">$Table</span> <span class="sy0">=</span> <span class="re0">$Null</span>
        <span class="br0">&#125;</span>
        <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$DirectRules</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
            <span class="re0">$DirectRulesHashArray</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
            <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$DirectRule</span> <span class="kw3">in</span> <span class="re0">$DirectRules</span><span class="br0">&#41;</span>
            <span class="br0">&#123;</span>
                <span class="re0">$DirectRuleRow</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#123;</span><span class="st0">'Resource Name'</span><span class="sy0">=</span> <span class="re0">$DirectRule</span>.RuleName; <span class="st0">'Resource ID'</span> <span class="sy0">=</span> <span class="re0">$DirectRule</span>.ResourceId<span class="br0">&#125;</span>;
                <span class="re0">$DirectRulesHashArray</span> <span class="sy0">+=</span> <span class="re0">$DirectRuleRow</span>;
            <span class="br0">&#125;</span>
&nbsp;
            <span class="re0">$Table</span> <span class="sy0">=</span> AddWordTable <span class="sy0">-</span>Hashtable <span class="re0">$DirectRulesHashArray</span> <span class="sy0">-</span>Columns <span class="st0">'Resource Name'</span><span class="sy0">,</span> <span class="st0">'Resource ID'</span> <span class="sy0">-</span>Headers <span class="st0">'Resource Name'</span><span class="sy0">,</span> <span class="st0">'Resource ID'</span> <span class="kw5">-Format</span> <span class="sy0">-</span><span class="nu0">155</span> <span class="sy0">-</span>AutoFit <span class="re0">$wdAutoFitContent</span>;
&nbsp;
            <span class="co1">## Set first column format</span>
            SetWordCellFormat <span class="sy0">-</span>Collection <span class="re0">$Table</span>.Rows.Item<span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>.Cells <span class="sy0">-</span>Bold <span class="kw5">-BackgroundColor</span> <span class="re0">$wdColorGray15</span>;
&nbsp;
            FindWordDocumentEnd
            <span class="re0">$Table</span> <span class="sy0">=</span> <span class="re0">$Null</span>           
        <span class="br0">&#125;</span>
        <span class="kw3">else</span> <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">'Enumerating device collection membership rules: No device collection direct membership rules configured!'</span>
        <span class="br0">&#125;</span>
        <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$IncludeRules</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
            <span class="re0">$IncludeRulesHashArray</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
            <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$IncludeRule</span> <span class="kw3">in</span> <span class="re0">$IncludeRules</span><span class="br0">&#41;</span>
            <span class="br0">&#123;</span>
                <span class="re0">$IncludeRuleRow</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#123;</span><span class="st0">'Collection Name'</span><span class="sy0">=</span> <span class="re0">$IncludeRule</span>.RuleName; <span class="st0">'Collection ID'</span> <span class="sy0">=</span> <span class="re0">$IncludeRule</span>.IncludeCollectionId<span class="br0">&#125;</span>;
                <span class="re0">$IncludeRulesHashArray</span> <span class="sy0">+=</span> <span class="re0">$IncludeRuleRow</span>;
            <span class="br0">&#125;</span>
&nbsp;
            <span class="re0">$Table</span> <span class="sy0">=</span> AddWordTable <span class="sy0">-</span>Hashtable <span class="re0">$IncludeRulesHashArray</span> <span class="sy0">-</span>Columns <span class="st0">'Collection Name'</span><span class="sy0">,</span> <span class="st0">'Collection ID'</span> <span class="sy0">-</span>Headers <span class="st0">'Collection Name'</span><span class="sy0">,</span> <span class="st0">'Collection ID'</span> <span class="kw5">-Format</span> <span class="sy0">-</span><span class="nu0">155</span> <span class="sy0">-</span>AutoFit <span class="re0">$wdAutoFitContent</span>;
&nbsp;
            <span class="co1">## Set first column format</span>
            SetWordCellFormat <span class="sy0">-</span>Collection <span class="re0">$Table</span>.Rows.Item<span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>.Cells <span class="sy0">-</span>Bold <span class="kw5">-BackgroundColor</span> <span class="re0">$wdColorGray15</span>;
&nbsp;
            <span class="re0">$Table</span>.Rows.SetLeftIndent<span class="br0">&#40;</span><span class="re0">$Indent1TabStops</span><span class="sy0">,</span><span class="re0">$wdAdjustProportional</span><span class="br0">&#41;</span>
            <span class="re0">$Table</span>.AutoFitBehavior<span class="br0">&#40;</span><span class="re0">$wdAutoFitFixed</span><span class="br0">&#41;</span>
&nbsp;
            FindWordDocumentEnd
            <span class="re0">$Table</span> <span class="sy0">=</span> <span class="re0">$Null</span>  
        <span class="br0">&#125;</span>
        <span class="kw3">else</span> <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">'Enumerating device collection membership rules: No device collection Include Collection membership rules configured!'</span>
        <span class="br0">&#125;</span>
    <span class="co1">#move to the end of the current document</span>
	<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date):   move to the end of the current document&quot;</span>
	<span class="re0">$selection</span>.EndKey<span class="br0">&#40;</span><span class="re0">$wdStory</span><span class="sy0">,</span><span class="re0">$wdMove</span><span class="br0">&#41;</span> <span class="sy0">|</span> <span class="kw1">Out-Null</span>
	WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
    <span class="br0">&#125;</span>
    <span class="br0">&#125;</span>
&nbsp;
<span class="kw3">else</span> <span class="br0">&#123;</span>
    WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">&quot;There are $($DeviceCollections.count) Device collections.&quot;</span>
<span class="br0">&#125;</span>
&nbsp;
    <span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date):   Working on Compliance Settings&quot;</span>
    WriteWordLine <span class="nu0">2</span> <span class="nu0">0</span> <span class="st0">'Compliance Settings'</span>
    WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
    WriteWordLine <span class="nu0">3</span> <span class="nu0">0</span> <span class="st0">'Configuration Items'</span>
&nbsp;
    <span class="re0">$CIs</span> <span class="sy0">=</span> Get<span class="sy0">-</span>CMConfigurationItem
    WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">'Enumerating Configuration Items:'</span>
&nbsp;
  <span class="re0">$CIsHashArray</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
  <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$CI</span> <span class="kw3">in</span> <span class="re0">$CIs</span><span class="br0">&#41;</span>
  <span class="br0">&#123;</span>
    <span class="re0">$CIRow</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#123;</span><span class="st0">'Name'</span> <span class="sy0">=</span> <span class="re0">$CI</span>.LocalizedDisplayName; <span class="st0">'Last modified'</span> <span class="sy0">=</span> <span class="re0">$CI</span>.DateLastModified; <span class="st0">'Last modified by'</span> <span class="sy0">=</span> <span class="re0">$CI</span>.LastModifiedBy; <span class="st0">'CI ID'</span> <span class="sy0">=</span> <span class="re0">$CI</span>.CI_ID<span class="br0">&#125;</span>
    <span class="re0">$CIsHashArray</span> <span class="sy0">+=</span> <span class="re0">$CIRow</span>
  <span class="br0">&#125;</span>
  <span class="re0">$Table</span> <span class="sy0">=</span> AddWordTable <span class="sy0">-</span>Hashtable <span class="re0">$CIsHashArray</span> <span class="sy0">-</span>Columns <span class="st0">'Name'</span><span class="sy0">,</span> <span class="st0">'Last modified'</span><span class="sy0">,</span> <span class="st0">'Last modified by'</span><span class="sy0">,</span> <span class="st0">'CI ID'</span> <span class="sy0">-</span>Headers <span class="st0">'Name'</span><span class="sy0">,</span> <span class="st0">'Last modified'</span><span class="sy0">,</span> <span class="st0">'Last modified by'</span><span class="sy0">,</span> <span class="st0">'CI ID'</span> <span class="kw5">-Format</span> <span class="sy0">-</span><span class="nu0">155</span> <span class="sy0">-</span>AutoFit <span class="re0">$wdAutoFitContent</span>;
&nbsp;
  <span class="co1">## Set first column format</span>
  SetWordCellFormat <span class="sy0">-</span>Collection <span class="re0">$Table</span>.Rows.Item<span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>.Cells <span class="sy0">-</span>Bold <span class="kw5">-BackgroundColor</span> <span class="re0">$wdColorGray15</span>;
&nbsp;
  FindWordDocumentEnd
  <span class="re0">$Table</span> <span class="sy0">=</span> <span class="re0">$Null</span>
&nbsp;
    WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
&nbsp;
    WriteWordLine <span class="nu0">3</span> <span class="nu0">0</span> <span class="st0">'Configuration Baselines'</span>
    <span class="re0">$CBs</span> <span class="sy0">=</span> Get<span class="sy0">-</span>CMBaseline
&nbsp;
    <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$CBs</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
&nbsp;
      <span class="re0">$CBsHashArray</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
      <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$CB</span> <span class="kw3">in</span> <span class="re0">$CBs</span><span class="br0">&#41;</span>
      <span class="br0">&#123;</span>
        <span class="re0">$CBRow</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#123;</span><span class="st0">'Name'</span> <span class="sy0">=</span> <span class="re0">$CB</span>.LocalizedDisplayName; <span class="st0">'Last modified'</span> <span class="sy0">=</span> <span class="re0">$CB</span>.DateLastModified; <span class="st0">'Last modified by'</span> <span class="sy0">=</span> <span class="re0">$CB</span>.LastModifiedBy; <span class="st0">'CI ID'</span> <span class="sy0">=</span> <span class="re0">$CB</span>.CI_ID<span class="br0">&#125;</span>
        <span class="re0">$CBsHashArray</span> <span class="sy0">+=</span> <span class="re0">$CBRow</span>
      <span class="br0">&#125;</span>
      <span class="re0">$Table</span> <span class="sy0">=</span> AddWordTable <span class="sy0">-</span>Hashtable <span class="re0">$CBsHashArray</span> <span class="sy0">-</span>Columns <span class="st0">'Name'</span><span class="sy0">,</span> <span class="st0">'Last modified'</span><span class="sy0">,</span> <span class="st0">'Last modified by'</span><span class="sy0">,</span> <span class="st0">'CI ID'</span> <span class="sy0">-</span>Headers <span class="st0">'Name'</span><span class="sy0">,</span> <span class="st0">'Last modified'</span><span class="sy0">,</span> <span class="st0">'Last modified by'</span><span class="sy0">,</span> <span class="st0">'CI ID'</span> <span class="kw5">-Format</span> <span class="sy0">-</span><span class="nu0">155</span> <span class="sy0">-</span>AutoFit <span class="re0">$wdAutoFitContent</span>;
&nbsp;
      <span class="co1">## Set first column format</span>
      SetWordCellFormat <span class="sy0">-</span>Collection <span class="re0">$Table</span>.Rows.Item<span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>.Cells <span class="sy0">-</span>Bold <span class="kw5">-BackgroundColor</span> <span class="re0">$wdColorGray15</span>;
&nbsp;
      FindWordDocumentEnd
      <span class="re0">$Table</span> <span class="sy0">=</span> <span class="re0">$Null</span>
&nbsp;
      WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
&nbsp;
    <span class="br0">&#125;</span>
    <span class="kw3">else</span> <span class="br0">&#123;</span>
        WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">'There are no Configuration Baselines configured.'</span>
    <span class="br0">&#125;</span>
&nbsp;
    <span class="co1">### User Data and Profiles</span>
    <span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date):   Working on User Data and Profiles&quot;</span>
    WriteWordLine <span class="nu0">3</span> <span class="nu0">0</span> <span class="st0">'User Data and Profiles'</span>
    <span class="re0">$UserDataProfiles</span> <span class="sy0">=</span> Get<span class="sy0">-</span>CMUserDataAndProfileConfigurationItem
&nbsp;
    <span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$UserDataProfiles</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
      <span class="re0">$UserDataProfilesHashArray</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#40;</span><span class="br0">&#41;</span>;
&nbsp;
      <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$UDP</span> <span class="kw3">in</span> <span class="re0">$UserDataProfiles</span><span class="br0">&#41;</span>
      <span class="br0">&#123;</span>
        <span class="re0">$UDPRow</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#123;</span><span class="st0">'Name'</span> <span class="sy0">=</span> <span class="re0">$UDP</span>.LocalizedDisplayName; <span class="st0">'Last modified'</span> <span class="sy0">=</span> <span class="re0">$UDP</span>.DateLastModified; <span class="st0">'Last modified by'</span> <span class="sy0">=</span> <span class="re0">$UDP</span>.LastModifiedBy; <span class="st0">'CI ID'</span> <span class="sy0">=</span> <span class="re0">$UDP</span>.CI_ID<span class="br0">&#125;</span>
        <span class="re0">$UserDataProfilesHashArray</span> <span class="sy0">+=</span> <span class="re0">$UDPRow</span>
      <span class="br0">&#125;</span>
      <span class="re0">$Table</span> <span class="sy0">=</span> AddWordTable <span class="sy0">-</span>Hashtable <span class="re0">$UserDataProfilesHashArray</span> <span class="sy0">-</span>Columns <span class="st0">'Name'</span><span class="sy0">,</span> <span class="st0">'Last modified'</span><span class="sy0">,</span> <span class="st0">'Last modified by'</span><span class="sy0">,</span> <span class="st0">'CI ID'</span> <span class="sy0">-</span>Headers <span class="st0">'Name'</span><span class="sy0">,</span> <span class="st0">'Last modified'</span><span class="sy0">,</span> <span class="st0">'Last modified by'</span><span class="sy0">,</span> <span class="st0">'CI ID'</span> <span class="kw5">-Format</span> <span class="sy0">-</span><span class="nu0">155</span> <span class="sy0">-</span>AutoFit <span class="re0">$wdAutoFitContent</span>;
&nbsp;
      <span class="co1">## Set first column format</span>
      SetWordCellFormat <span class="sy0">-</span>Collection <span class="re0">$Table</span>.Rows.Item<span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>.Cells <span class="sy0">-</span>Bold <span class="kw5">-BackgroundColor</span> <span class="re0">$wdColorGray15</span>;
&nbsp;
      FindWordDocumentEnd
      <span class="re0">$Table</span> <span class="sy0">=</span> <span class="re0">$Null</span>
      WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
    <span class="br0">&#125;</span>
    <span class="kw3">else</span> <span class="br0">&#123;</span>
        WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">'There are no User Data and Profile configurations configured.'</span>
    <span class="br0">&#125;</span>
&nbsp;
        <span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date):   Working on Endpoint Protection&quot;</span>
        WriteWordLine <span class="nu0">2</span> <span class="nu0">0</span> <span class="st0">'Endpoint Protection'</span>
        <span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#40;</span>$<span class="br0">&#40;</span>Get<span class="sy0">-</span>CMEndpointProtectionPoint<span class="br0">&#41;</span> <span class="kw4">-eq</span> <span class="re0">$Null</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
            <span class="br0">&#123;</span>
                WriteWordLine <span class="nu0">3</span> <span class="nu0">0</span> <span class="st0">'Antimalware Policies'</span>
                <span class="re0">$AntiMalwarePolicies</span> <span class="sy0">=</span> Get<span class="sy0">-</span>CMAntimalwarePolicy
                <span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$AntiMalwarePolicies</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
                    <span class="br0">&#123;</span>
                        <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$AntiMalwarePolicy</span> <span class="kw3">in</span> <span class="re0">$AntiMalwarePolicies</span><span class="br0">&#41;</span>
                            <span class="br0">&#123;</span>
                                <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$AntiMalwarePolicy</span>.Name <span class="kw4">-eq</span> <span class="st0">'Default Client Antimalware Policy'</span><span class="br0">&#41;</span>
                                    <span class="br0">&#123;</span>
                                        <span class="re0">$AgentConfig</span> <span class="sy0">=</span> <span class="re0">$AntiMalwarePolicy</span>.AgentConfiguration
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">&quot;$($AntiMalwarePolicy.Name)&quot;</span> <span class="sy0">-</span>boldface <span class="re0">$true</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">&quot;Description: $($AntiMalwarePolicy.Description)&quot;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Scheduled Scans'</span> <span class="sy0">-</span>boldface <span class="re0">$true</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Run a scheduled scan on client computers: $($AgentConfig.EnableScheduledScan)&quot;</span>
                                        <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.EnableScheduledScan<span class="br0">&#41;</span>
                                            <span class="br0">&#123;</span>
                                                <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.ScheduledScanType<span class="br0">&#41;</span>
                                                    <span class="br0">&#123;</span>
                                                        <span class="nu0">1</span> <span class="br0">&#123;</span> <span class="re0">$ScheduledScanType</span> <span class="sy0">=</span> <span class="st0">'Quick Scan'</span> <span class="br0">&#125;</span>
                                                        <span class="nu0">2</span> <span class="br0">&#123;</span> <span class="re0">$ScheduledScanType</span> <span class="sy0">=</span> <span class="st0">'Full Scan'</span> <span class="br0">&#125;</span>
                                                    <span class="br0">&#125;</span>
                                                WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Scan type: $($ScheduledScanType)&quot;</span>
                                                WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Scan day: $(Convert-WeekDay $AgentConfig.ScheduledScanWeekDay)&quot;</span>
                                                WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Scan time: $(Convert-Time -time $AgentConfig.ScheduledScanTime)&quot;</span>
                                                WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Run a daily quick scan on client computers: $($AgentConfig.EnableQuickDailyScan)&quot;</span>
                                                WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Daily quick scan schedule time: $(Convert-Time -time $AgentConfig.ScheduledScanQuickTime)&quot;</span>
                                                WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Check for the latest definition updates before running a scan: $($AgentConfig.CheckLatestDefinition)&quot;</span>
                                                WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Start a scheduled scan only when the computer is idle: $($AgentConfig.ScanWhenClientNotInUse)&quot;</span>
                                                WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Force a scan of the selected scan type if client computer is offline during two or more scheduled scans: $($AgentConfig.EnableCatchupScan)&quot;</span>
                                                WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Limit CPU usage during scans to (%): $($AgentConfig.LimitCPUUsage)&quot;</span>
                                            <span class="br0">&#125;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Scan settings'</span> <span class="sy0">-</span>boldface <span class="re0">$true</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Scan email and email attachments: $($AgentConfig.ScanEmail)&quot;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Scan removable storage devices such as USB drives: $($AgentConfig.ScanRemovableStorage)&quot;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Scan network drives when running a full scan: $($AgentConfig.ScanNetworkDrives)&quot;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Scan archived files: $($AgentConfig.ScanArchivedFiles)&quot;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Allow users to configure CPU usage during scans: $($AgentConfig.AllowClientUserConfigLimitCPUUsage)&quot;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">'User control of scheduled scans: '</span> <span class="kw5">-nonewline</span>
                                        <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.ScheduledScanUserControl<span class="br0">&#41;</span>
                                            <span class="br0">&#123;</span>
                                                <span class="nu0">0</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'No control'</span> <span class="br0">&#125;</span>
                                                <span class="nu0">1</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Scan time only'</span> <span class="br0">&#125;</span>
                                                <span class="nu0">2</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Full control'</span> <span class="br0">&#125;</span>
                                            <span class="br0">&#125;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Default Actions'</span> <span class="sy0">-</span>boldface <span class="re0">$true</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">'Severe threats: '</span> <span class="kw5">-nonewline</span>
                                        <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.DefaultActionSevere<span class="br0">&#41;</span>
                                            <span class="br0">&#123;</span>
                                                <span class="nu0">0</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Recommended'</span> <span class="br0">&#125;</span>
                                                <span class="nu0">2</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Quarantine'</span> <span class="br0">&#125;</span>
                                                <span class="nu0">3</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Remove'</span> <span class="br0">&#125;</span>
                                                <span class="nu0">6</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Allow'</span> <span class="br0">&#125;</span>
                                            <span class="br0">&#125;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">'High threats: '</span> <span class="kw5">-nonewline</span>
                                        <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.DefaultActionSevere<span class="br0">&#41;</span>
                                            <span class="br0">&#123;</span>
                                                <span class="nu0">0</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Recommended'</span> <span class="br0">&#125;</span>
                                                <span class="nu0">2</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Quarantine'</span> <span class="br0">&#125;</span>
                                                <span class="nu0">3</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Remove'</span> <span class="br0">&#125;</span>
                                                <span class="nu0">6</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Allow'</span> <span class="br0">&#125;</span>
                                            <span class="br0">&#125;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">'Medium threats: '</span> <span class="kw5">-nonewline</span>
                                        <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.DefaultActionSevere<span class="br0">&#41;</span>
                                            <span class="br0">&#123;</span>
                                                <span class="nu0">0</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Recommended'</span> <span class="br0">&#125;</span>
                                                <span class="nu0">2</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Quarantine'</span> <span class="br0">&#125;</span>
                                                <span class="nu0">3</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Remove'</span> <span class="br0">&#125;</span>
                                                <span class="nu0">6</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Allow'</span> <span class="br0">&#125;</span>
                                            <span class="br0">&#125;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">'Low threats: '</span> <span class="kw5">-nonewline</span>
                                        <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.DefaultActionSevere<span class="br0">&#41;</span>
                                            <span class="br0">&#123;</span>
                                                <span class="nu0">0</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Recommended'</span> <span class="br0">&#125;</span>
                                                <span class="nu0">2</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Quarantine'</span> <span class="br0">&#125;</span>
                                                <span class="nu0">3</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Remove'</span> <span class="br0">&#125;</span>
                                                <span class="nu0">6</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Allow'</span> <span class="br0">&#125;</span>
                                            <span class="br0">&#125;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Real-time protection'</span> <span class="sy0">-</span>boldface <span class="re0">$true</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Enable real-time protection: $($AgentConfig.RealtimeProtectionOn)&quot;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Monitor file and program activity on your computer: $($AgentConfig.MonitorFileProgramActivity)&quot;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">'Scan system files: '</span> <span class="kw5">-nonewline</span>
                                        <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.RealtimeScanOption<span class="br0">&#41;</span>
                                            <span class="br0">&#123;</span>
                                                <span class="nu0">0</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Scan incoming and outgoing files'</span> <span class="br0">&#125;</span>
                                                <span class="nu0">1</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Scan incoming files only'</span> <span class="br0">&#125;</span>
                                                <span class="nu0">2</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Scan outgoing files only'</span> <span class="br0">&#125;</span>
                                            <span class="br0">&#125;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Exclusion settings'</span> <span class="sy0">-</span>boldface <span class="re0">$true</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">'Excluded files and folders: '</span>
                                        <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$ExcludedFileFolder</span> <span class="kw3">in</span> <span class="re0">$AgentConfig</span>.ExcludedFilePaths<span class="br0">&#41;</span>
                                            <span class="br0">&#123;</span>
                                                WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">&quot;$($ExcludedFileFolder)&quot;</span>
                                            <span class="br0">&#125;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">'Excluded file types: '</span>
                                        <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$ExcludedFileType</span> <span class="kw3">in</span> <span class="re0">$AgentConfig</span>.ExcludedFileTypes<span class="br0">&#41;</span>
                                            <span class="br0">&#123;</span>
                                                WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">&quot;$($ExcludedFileType)&quot;</span>
                                            <span class="br0">&#125;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">'Excluded processes: '</span>
                                        <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$ExcludedProcess</span> <span class="kw3">in</span> <span class="re0">$AgentConfig</span>.ExcludedProcesses<span class="br0">&#41;</span>
                                            <span class="br0">&#123;</span>
                                                WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">&quot;$($ExcludedProcess)&quot;</span>
                                            <span class="br0">&#125;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Advanced'</span> <span class="sy0">-</span>boldface <span class="re0">$true</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Create a system restore point before computers are cleaned: $($AgentConfig.CreateSystemRestorePointBeforeClean)&quot;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Disable the client user interface: $($AgentConfig.DisableClientUI)&quot;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Show notifications messages on the client computer when the user needs to run a full scan, update definitions, or run Windows Defender Offline: $($AgentConfig.ShowNotificationMessages)&quot;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Delete quarantined files after (days): $($AgentConfig.DeleteQuarantinedFilesPeriod)&quot;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Allow users to configure the setting for quarantined file deletion: $($AgentConfig.AllowUserConfigQuarantinedFileDeletionPeriod)&quot;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Allow users to exclude file and folders, file types and processes: $($AgentConfig.AllowUserAddExcludes)&quot;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Allow all users to view the full History results: $($AgentConfig.AllowUserViewHistory)&quot;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Enable reparse point scanning: $($AgentConfig.EnableReparsePointScanning)&quot;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Randomize scheduled scan and definition update start time (within 30 minutes): $($AgentConfig.RandomizeScheduledScanStartTime)&quot;</span>
&nbsp;
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Threat overrides'</span> <span class="sy0">-</span>boldface <span class="re0">$true</span>
                                        <span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.ThreatName<span class="br0">&#41;</span><span class="br0">&#41;</span>
                                            <span class="br0">&#123;</span>
                                                WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">'Threat name and override action: Threats specified.'</span>
                                            <span class="br0">&#125;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Microsoft Active Protection Service'</span> <span class="sy0">-</span>boldface <span class="re0">$true</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">'Microsoft Active Protection Service membership type: '</span> <span class="kw5">-nonewline</span>
                                        <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.JoinSpyNet<span class="br0">&#41;</span>
                                            <span class="br0">&#123;</span>
                                                <span class="nu0">0</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Do not join MAPS'</span> <span class="br0">&#125;</span>
                                                <span class="nu0">1</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Basic membership'</span> <span class="br0">&#125;</span>
                                                <span class="nu0">2</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Advanced membership'</span> <span class="br0">&#125;</span>
                                            <span class="br0">&#125;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Allow users to modify Microsoft Active Protection Service settings: $($AgentConfig.AllowUserChangeSpyNetSettings)&quot;</span>
&nbsp;
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Definition Updates'</span> <span class="sy0">-</span>boldface <span class="re0">$true</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Check for Endpoint Protection definitions at a specific interval (hours): (0 disable check on interval) $($AgentConfig.SignatureUpdateInterval)&quot;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Check for Endpoint Protection definitions daily at: (Only configurable if interval-based check is disabled) $(Convert-Time -time $AgentConfig.SignatureUpdateTime)&quot;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Force a definition update if the client computer is offline for more than two consecutive scheduled updates: $($AgentConfig.EnableSignatureUpdateCatchupInterval)&quot;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">'Set sources and order for Endpoint Protection definition updates: '</span>
                                        <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$Fallback</span> <span class="kw3">in</span> <span class="re0">$AgentConfig</span>.FallbackOrder<span class="br0">&#41;</span>
                                            <span class="br0">&#123;</span>
                                                WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;$($Fallback)&quot;</span>
                                            <span class="br0">&#125;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;If Configuration Manager is used as a source for definition updates, clients will only update from alternative sources if definition is older than (hours): $($AgentConfig.AuGracePeriod / 60)&quot;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">'If UNC file shares are selected as a definition update source, specify the UNC paths:'</span> 
                                        <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$UNCShare</span> <span class="kw3">in</span> <span class="re0">$AgentConfig</span>.DefinitionUpdateFileSharesSources<span class="br0">&#41;</span>
                                            <span class="br0">&#123;</span>
                                                WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">&quot;$($UNCShare)&quot;</span>
                                            <span class="br0">&#125;</span>
                                    <span class="br0">&#125;</span>
                            <span class="kw3">else</span>
                                <span class="br0">&#123;</span>
                                    <span class="re0">$AgentConfig_custom</span> <span class="sy0">=</span> <span class="re0">$AntiMalwarePolicy</span>.AgentConfigurations
                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">&quot;$($AntiMalwarePolicy.Name)&quot;</span> <span class="sy0">-</span>boldface <span class="re0">$true</span>
                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">&quot;Description: $($AntiMalwarePolicy.Description)&quot;</span>
                                    <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$Agentconfig</span> <span class="kw3">in</span> <span class="re0">$AgentConfig_custom</span><span class="br0">&#41;</span>
                                        <span class="br0">&#123;</span>
                                            <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.AgentID<span class="br0">&#41;</span>
                                                <span class="br0">&#123;</span>
                                                    <span class="nu0">201</span> 
                                                        <span class="br0">&#123;</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Scheduled Scans'</span> <span class="sy0">-</span>boldface <span class="re0">$true</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Run a scheduled scan on client computers: $($AgentConfig.EnableScheduledScan)&quot;</span>
                                                            <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.EnableScheduledScan<span class="br0">&#41;</span>
                                                                <span class="br0">&#123;</span>
                                                                    <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.ScheduledScanType<span class="br0">&#41;</span>
                                                                        <span class="br0">&#123;</span>
                                                                            <span class="nu0">1</span> <span class="br0">&#123;</span> <span class="re0">$ScheduledScanType</span> <span class="sy0">=</span> <span class="st0">'Quick Scan'</span> <span class="br0">&#125;</span>
                                                                            <span class="nu0">2</span> <span class="br0">&#123;</span> <span class="re0">$ScheduledScanType</span> <span class="sy0">=</span> <span class="st0">'Full Scan'</span> <span class="br0">&#125;</span>
                                                                        <span class="br0">&#125;</span>
                                                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Scan type: $($ScheduledScanType)&quot;</span>
                                                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Scan day: $(Convert-WeekDay $AgentConfig.ScheduledScanWeekDay)&quot;</span>
                                                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Scan time: $(Convert-Time -time $AgentConfig.ScheduledScanTime)&quot;</span>
                                                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Run a daily quick scan on client computers: $($AgentConfig.EnableQuickDailyScan)&quot;</span>
                                                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Daily quick scan schedule time: $(Convert-Time -time $AgentConfig.ScheduledScanQuickTime)&quot;</span>
                                                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Check for the latest definition updates before running a scan: $($AgentConfig.CheckLatestDefinition)&quot;</span>
                                                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Start a scheduled scan only when the computer is idle: $($AgentConfig.ScanWhenClientNotInUse)&quot;</span>
                                                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Force a scan of the selected scan type if client computer is offline during two or more scheduled scans: $($AgentConfig.EnableCatchupScan)&quot;</span>
                                                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Limit CPU usage during scans to (%): $($AgentConfig.LimitCPUUsage)&quot;</span>
                                                                <span class="br0">&#125;</span>
                                                        <span class="br0">&#125;</span>
                                                    <span class="nu0">202</span>
                                                        <span class="br0">&#123;</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Default Actions'</span> <span class="sy0">-</span>boldface <span class="re0">$true</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">'Severe threats: '</span> <span class="kw5">-nonewline</span>
                                                            <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.DefaultActionSevere<span class="br0">&#41;</span>
                                                                <span class="br0">&#123;</span>
                                                                    <span class="nu0">0</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Recommended'</span> <span class="br0">&#125;</span>
                                                                    <span class="nu0">2</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Quarantine'</span> <span class="br0">&#125;</span>
                                                                    <span class="nu0">3</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Remove'</span> <span class="br0">&#125;</span>
                                                                    <span class="nu0">6</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Allow'</span> <span class="br0">&#125;</span>
                                                                <span class="br0">&#125;</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">'High threats: '</span> <span class="kw5">-nonewline</span>
                                                            <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.DefaultActionSevere<span class="br0">&#41;</span>
                                                                <span class="br0">&#123;</span>
                                                                    <span class="nu0">0</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Recommended'</span> <span class="br0">&#125;</span>
                                                                    <span class="nu0">2</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Quarantine'</span> <span class="br0">&#125;</span>
                                                                    <span class="nu0">3</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Remove'</span> <span class="br0">&#125;</span>
                                                                    <span class="nu0">6</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Allow'</span> <span class="br0">&#125;</span>
                                                                <span class="br0">&#125;</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">'Medium threats: '</span> <span class="kw5">-nonewline</span>
                                                            <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.DefaultActionSevere<span class="br0">&#41;</span>
                                                                <span class="br0">&#123;</span>
                                                                    <span class="nu0">0</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Recommended'</span> <span class="br0">&#125;</span>
                                                                    <span class="nu0">2</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Quarantine'</span> <span class="br0">&#125;</span>
                                                                    <span class="nu0">3</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Remove'</span> <span class="br0">&#125;</span>
                                                                    <span class="nu0">6</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Allow'</span> <span class="br0">&#125;</span>
                                                                <span class="br0">&#125;</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">'Low threats: '</span> <span class="kw5">-nonewline</span>
                                                            <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.DefaultActionSevere<span class="br0">&#41;</span>
                                                                <span class="br0">&#123;</span>
                                                                    <span class="nu0">0</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Recommended'</span> <span class="br0">&#125;</span>
                                                                    <span class="nu0">2</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Quarantine'</span> <span class="br0">&#125;</span>
                                                                    <span class="nu0">3</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Remove'</span> <span class="br0">&#125;</span>
                                                                    <span class="nu0">6</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Allow'</span> <span class="br0">&#125;</span>
                                                                <span class="br0">&#125;</span>                                           
                                                        <span class="br0">&#125;</span>
                                                    <span class="nu0">203</span>
                                                        <span class="br0">&#123;</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Exclusion settings'</span> <span class="sy0">-</span>boldface <span class="re0">$true</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">'Excluded files and folders: '</span>
                                                            <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$ExcludedFileFolder</span> <span class="kw3">in</span> <span class="re0">$AgentConfig</span>.ExcludedFilePaths<span class="br0">&#41;</span>
                                                                <span class="br0">&#123;</span>
                                                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">&quot;$($ExcludedFileFolder)&quot;</span>
                                                                <span class="br0">&#125;</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">'Excluded file types: '</span>
                                                            <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$ExcludedFileType</span> <span class="kw3">in</span> <span class="re0">$AgentConfig</span>.ExcludedFileTypes<span class="br0">&#41;</span>
                                                                <span class="br0">&#123;</span>
                                                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">&quot;$($ExcludedFileType)&quot;</span>
                                                                <span class="br0">&#125;</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">'Excluded processes: '</span>
                                                            <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$ExcludedProcess</span> <span class="kw3">in</span> <span class="re0">$AgentConfig</span>.ExcludedProcesses<span class="br0">&#41;</span>
                                                                <span class="br0">&#123;</span>
                                                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">&quot;$($ExcludedProcess)&quot;</span>
                                                                <span class="br0">&#125;</span>                                            
                                                        <span class="br0">&#125;</span>
                                                    <span class="nu0">204</span>
                                                        <span class="br0">&#123;</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Real-time protection'</span> <span class="sy0">-</span>boldface <span class="re0">$true</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Enable real-time protection: $($AgentConfig.RealtimeProtectionOn)&quot;</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Monitor file and program activity on your computer: $($AgentConfig.MonitorFileProgramActivity)&quot;</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">'Scan system files: '</span> <span class="kw5">-nonewline</span>
                                                            <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.RealtimeScanOption<span class="br0">&#41;</span>
                                                                <span class="br0">&#123;</span>
                                                                    <span class="nu0">0</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Scan incoming and outgoing files'</span> <span class="br0">&#125;</span>
                                                                    <span class="nu0">1</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Scan incoming files only'</span> <span class="br0">&#125;</span>
                                                                    <span class="nu0">2</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Scan outgoing files only'</span> <span class="br0">&#125;</span>
                                                                <span class="br0">&#125;</span>                                            
                                                        <span class="br0">&#125;</span>
                                                    <span class="nu0">205</span>
                                                        <span class="br0">&#123;</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Advanced'</span> <span class="sy0">-</span>boldface <span class="re0">$true</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Create a system restore point before computers are cleaned: $($AgentConfig.CreateSystemRestorePointBeforeClean)&quot;</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Disable the client user interface: $($AgentConfig.DisableClientUI)&quot;</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Show notifications messages on the client computer when the user needs to run a full scan, update definitions, or run Windows Defender Offline: $($AgentConfig.ShowNotificationMessages)&quot;</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Delete quarantined files after (days): $($AgentConfig.DeleteQuarantinedFilesPeriod)&quot;</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Allow users to configure the setting for quarantined file deletion: $($AgentConfig.AllowUserConfigQuarantinedFileDeletionPeriod)&quot;</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Allow users to exclude file and folders, file types and processes: $($AgentConfig.AllowUserAddExcludes)&quot;</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Allow all users to view the full History results: $($AgentConfig.AllowUserViewHistory)&quot;</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Enable reparse point scanning: $($AgentConfig.EnableReparsePointScanning)&quot;</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Randomize scheduled scan and definition update start time (within 30 minutes): $($AgentConfig.RandomizeScheduledScanStartTime)&quot;</span>                                            
                                                        <span class="br0">&#125;</span>
                                                    <span class="nu0">206</span>
                                                        <span class="br0">&#123;</span>
&nbsp;
                                                        <span class="br0">&#125;</span>
                                                    <span class="nu0">207</span>
                                                        <span class="br0">&#123;</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Microsoft Active Protection Service'</span> <span class="sy0">-</span>boldface <span class="re0">$true</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">'Microsoft Active Protection Service membership type: '</span> <span class="kw5">-nonewline</span>
                                                            <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.JoinSpyNet<span class="br0">&#41;</span>
                                                                <span class="br0">&#123;</span>
                                                                    <span class="nu0">0</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Do not join MAPS'</span> <span class="br0">&#125;</span>
                                                                    <span class="nu0">1</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Basic membership'</span> <span class="br0">&#125;</span>
                                                                    <span class="nu0">2</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Advanced membership'</span> <span class="br0">&#125;</span>
                                                                <span class="br0">&#125;</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Allow users to modify Microsoft Active Protection Service settings: $($AgentConfig.AllowUserChangeSpyNetSettings)&quot;</span>                                            
                                                        <span class="br0">&#125;</span>
                                                    <span class="nu0">208</span>
                                                        <span class="br0">&#123;</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Definition Updates'</span> <span class="sy0">-</span>boldface <span class="re0">$true</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Check for Endpoint Protection definitions at a specific interval (hours): (0 disable check on interval) $($AgentConfig.SignatureUpdateInterval)&quot;</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Check for Endpoint Protection definitions daily at: (Only configurable if interval-based check is disabled) $(Convert-Time -time $AgentConfig.SignatureUpdateTime)&quot;</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Force a definition update if the client computer is offline for more than two consecutive scheduled updates: $($AgentConfig.EnableSignatureUpdateCatchupInterval)&quot;</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">'Set sources and order for Endpoint Protection definition updates: '</span>
                                                            <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$Fallback</span> <span class="kw3">in</span> <span class="re0">$AgentConfig</span>.FallbackOrder<span class="br0">&#41;</span>
                                                                <span class="br0">&#123;</span>
                                                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">&quot;$($Fallback)&quot;</span>
                                                                <span class="br0">&#125;</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;If Configuration Manager is used as a source for definition updates, clients will only update from alternative sources if definition is older than (hours): $($AgentConfig.AuGracePeriod / 60)&quot;</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">'If UNC file shares are selected as a definition update source, specify the UNC paths:'</span> 
                                                            <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$UNCShare</span> <span class="kw3">in</span> <span class="re0">$AgentConfig</span>.DefinitionUpdateFileSharesSources<span class="br0">&#41;</span>
                                                                <span class="br0">&#123;</span>
                                                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">&quot;$($UNCShare)&quot;</span>
                                                                <span class="br0">&#125;</span>
                                                        <span class="br0">&#125;</span>
                                                    <span class="nu0">209</span>
                                                        <span class="br0">&#123;</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Scan settings'</span> <span class="sy0">-</span>boldface <span class="re0">$true</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Scan email and email attachments: $($AgentConfig.ScanEmail)&quot;</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Scan removable storage devices such as USB drives: $($AgentConfig.ScanRemovableStorage)&quot;</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Scan network drives when running a full scan: $($AgentConfig.ScanNetworkDrives)&quot;</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Scan archived files: $($AgentConfig.ScanArchivedFiles)&quot;</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Allow users to configure CPU usage during scans: $($AgentConfig.AllowClientUserConfigLimitCPUUsage)&quot;</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">'User control of scheduled scans: '</span> <span class="kw5">-nonewline</span>
                                                            <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$AgentConfig</span>.ScheduledScanUserControl<span class="br0">&#41;</span>
                                                                <span class="br0">&#123;</span>
                                                                    <span class="nu0">0</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'No control'</span> <span class="br0">&#125;</span>
                                                                    <span class="nu0">1</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Scan time only'</span> <span class="br0">&#125;</span>
                                                                    <span class="nu0">2</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'Full control'</span> <span class="br0">&#125;</span>
                                                                <span class="br0">&#125;</span>
                                                        <span class="br0">&#125;</span>
                                                <span class="br0">&#125;</span>
                                        <span class="br0">&#125;</span>
                                <span class="br0">&#125;</span>
                        <span class="br0">&#125;</span>
                    <span class="br0">&#125;</span>
                <span class="kw3">else</span>
                    <span class="br0">&#123;</span>
                        WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">'There are no Anti Malware Policies configured.'</span>
                    <span class="br0">&#125;</span>
            <span class="br0">&#125;</span>
        <span class="kw3">else</span>
            <span class="br0">&#123;</span>
                WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">'There is no Endpoint Protection Point enabled.'</span>
            <span class="br0">&#125;</span>
&nbsp;
        WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
&nbsp;
        <span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date):   Working on Windows Firewall Policies&quot;</span>
        WriteWordLine <span class="nu0">3</span> <span class="nu0">0</span> <span class="st0">'Windows Firewall Policies'</span>
&nbsp;
        <span class="re0">$FirewallPolicies</span> <span class="sy0">=</span> Get<span class="sy0">-</span>CMWindowsFirewallPolicy
        <span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$FirewallPolicies</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
&nbsp;
          <span class="re0">$FirewallPolsHashArray</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#40;</span><span class="br0">&#41;</span>
&nbsp;
          <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$FWP</span> <span class="kw3">in</span> <span class="re0">$FirewallPolicies</span><span class="br0">&#41;</span>
          <span class="br0">&#123;</span>
            <span class="re0">$FWPRow</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#123;</span><span class="st0">'Name'</span> <span class="sy0">=</span> <span class="re0">$FWP</span>.LocalizedDisplayName; <span class="st0">'Last modified'</span> <span class="sy0">=</span> <span class="re0">$FWP</span>.DateLastModified; <span class="st0">'Last modified by'</span> <span class="sy0">=</span> <span class="re0">$FWP</span>.LastModifiedBy; <span class="st0">'CI ID'</span> <span class="sy0">=</span> <span class="re0">$FWP</span>.CI_ID<span class="br0">&#125;</span>
            <span class="re0">$FirewallPolsHashArray</span> <span class="sy0">+=</span> <span class="re0">$FWPRow</span>
          <span class="br0">&#125;</span>
          <span class="re0">$Table</span> <span class="sy0">=</span> AddWordTable <span class="sy0">-</span>Hashtable <span class="re0">$FirewallPolsHashArray</span> <span class="sy0">-</span>Columns <span class="st0">'Name'</span><span class="sy0">,</span> <span class="st0">'Last modified'</span><span class="sy0">,</span> <span class="st0">'Last modified by'</span><span class="sy0">,</span> <span class="st0">'CI ID'</span> <span class="sy0">-</span>Headers <span class="st0">'Name'</span><span class="sy0">,</span> <span class="st0">'Last modified'</span><span class="sy0">,</span> <span class="st0">'Last modified by'</span><span class="sy0">,</span> <span class="st0">'CI ID'</span> <span class="kw5">-Format</span> <span class="sy0">-</span><span class="nu0">155</span> <span class="sy0">-</span>AutoFit <span class="re0">$wdAutoFitFixed</span>;
&nbsp;
          <span class="co1">## Set first column format</span>
          SetWordCellFormat <span class="sy0">-</span>Collection <span class="re0">$Table</span>.Rows.Item<span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>.Cells <span class="sy0">-</span>Bold <span class="kw5">-BackgroundColor</span> <span class="re0">$wdColorGray15</span>;
&nbsp;
          <span class="co1">## IB - set column widths without recursion</span>
          <span class="re0">$Table</span>.Columns.Item<span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>.Width <span class="sy0">=</span> <span class="nu0">100</span>;
          <span class="re0">$Table</span>.Columns.Item<span class="br0">&#40;</span><span class="nu0">2</span><span class="br0">&#41;</span>.Width <span class="sy0">=</span> <span class="nu0">100</span>;
          <span class="re0">$Table</span>.Columns.Item<span class="br0">&#40;</span><span class="nu0">3</span><span class="br0">&#41;</span>.Width <span class="sy0">=</span> <span class="nu0">100</span>;
          <span class="re0">$Table</span>.Columns.Item<span class="br0">&#40;</span><span class="nu0">4</span><span class="br0">&#41;</span>.Width <span class="sy0">=</span> <span class="nu0">150</span>;
          <span class="re0">$Table</span>.Rows.SetLeftIndent<span class="br0">&#40;</span><span class="re0">$Indent1TabStops</span><span class="sy0">,</span><span class="re0">$wdAdjustProportional</span><span class="br0">&#41;</span>
          <span class="re0">$Table</span>.AutoFitBehavior<span class="br0">&#40;</span><span class="re0">$wdAutoFitFixed</span><span class="br0">&#41;</span>
          FindWordDocumentEnd
          <span class="re0">$Table</span> <span class="sy0">=</span> <span class="re0">$Null</span>
          WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>           
&nbsp;
        <span class="br0">&#125;</span>
        <span class="kw3">else</span> <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">'There are no Windows Firewall policies configured.'</span>
        <span class="br0">&#125;</span>
&nbsp;
        <span class="co1">#####</span>
        <span class="co1">##### finished with Assets and Compliance, moving on to Software Library</span>
        <span class="co1">#####</span>
        <span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date):   Finished with Assets and Compliance.&quot;</span>
&nbsp;
&nbsp;
&nbsp;
<span class="co1">#endregion Assets and Compliance</span>
&nbsp;
<span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$Software</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        <span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date):   moving on to Software Library&quot;</span>
        WriteWordLine <span class="nu0">1</span> <span class="nu0">0</span> <span class="st0">'Software Library'</span>
&nbsp;
<span class="co1">##### Applications</span>
&nbsp;
        WriteWordLine <span class="nu0">2</span> <span class="nu0">0</span> <span class="st0">'Applications'</span>
        WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
        <span class="re0">$Applications</span> <span class="sy0">=</span> <span class="kw1">Get-WmiObject</span> <span class="kw5">-Class</span> sms_applicationlatest <span class="kw5">-Namespace</span> root\sms\site_<span class="re0">$SiteCode</span> <span class="kw5">-ComputerName</span> <span class="re0">$SMSProvider</span>
        <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$ListAllInformation</span><span class="br0">&#41;</span>
            <span class="br0">&#123;</span>
                <span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$Applications</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
                    WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">'The following Applications are configured in this site:'</span>
&nbsp;
&nbsp;
                    <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$App</span> <span class="kw3">in</span> <span class="re0">$Applications</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
                        <span class="kw1">Write-Verbose</span> <span class="st0">'Getting specific WMI instance for this App'</span>
                        <span class="br0">&#91;</span><span class="re3">wmi</span><span class="br0">&#93;</span><span class="re0">$App</span> <span class="sy0">=</span> <span class="re0">$App</span>.__PATH
                        <span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date):   Found App: $($App.LocalizedDisplayName)&quot;</span>
                        WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;$($App.LocalizedDisplayName)&quot;</span> <span class="sy0">-</span>boldface <span class="re0">$true</span>
                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Created by: $($App.CreatedBy)&quot;</span>
                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Date created: $($App.DateCreated)&quot;</span>
                        <span class="re0">$DTs</span> <span class="sy0">=</span> Get<span class="sy0">-</span>CMDeploymentType <span class="sy0">-</span>ApplicationName <span class="re0">$App</span>.LocalizedDisplayName
                        <span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$DTs</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
                            <span class="re0">$DTsHashArray</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#40;</span><span class="br0">&#41;</span>
&nbsp;
                            <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$DT</span> <span class="kw3">in</span> <span class="re0">$DTs</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
                                <span class="re0">$xmlDT</span> <span class="sy0">=</span> <span class="br0">&#91;</span><span class="re3">xml</span><span class="br0">&#93;</span><span class="re0">$DT</span>.SDMPackageXML
                                <span class="re0">$DTRow</span> <span class="sy0">=</span> <span class="sy0">@</span><span class="br0">&#123;</span><span class="st0">'Deployment Type Name'</span> <span class="sy0">=</span> <span class="re0">$DT</span>.LocalizedDisplayName; <span class="st0">'Technology'</span> <span class="sy0">=</span> <span class="re0">$DT</span>.Technology; <span class="st0">'Commandline'</span> <span class="sy0">=</span> <span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#40;</span><span class="re0">$DT</span>.Technology <span class="kw4">-like</span> <span class="st0">'AppV*'</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#123;</span> <span class="re0">$xmlDT</span>.AppMgmtDigest.DeploymentType.Installer.CustomData.InstallCommandLine <span class="br0">&#125;</span> <span class="br0">&#125;</span>
                                <span class="re0">$DTsHashArray</span> <span class="sy0">+=</span> <span class="re0">$DTRow</span>
                            <span class="br0">&#125;</span>
                            <span class="re0">$Table</span> <span class="sy0">=</span> AddWordTable <span class="sy0">-</span>Hashtable <span class="re0">$DTsHashArray</span> <span class="sy0">-</span>Columns <span class="st0">'Deployment Type Name'</span><span class="sy0">,</span> <span class="st0">'Technology'</span><span class="sy0">,</span> <span class="st0">'Commandline'</span> <span class="sy0">-</span>Headers <span class="st0">'Deployment Type Name'</span><span class="sy0">,</span> <span class="st0">'Technology'</span><span class="sy0">,</span> <span class="st0">'Commandline'</span> <span class="kw5">-Format</span> <span class="sy0">-</span><span class="nu0">155</span> <span class="sy0">-</span>AutoFit <span class="re0">$wdAutoFitContent</span>;
&nbsp;
                            <span class="co1">## Set first column format</span>
                            SetWordCellFormat <span class="sy0">-</span>Collection <span class="re0">$Table</span>.Rows.Item<span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>.Cells <span class="sy0">-</span>Bold <span class="kw5">-BackgroundColor</span> <span class="re0">$wdColorGray15</span>;
&nbsp;
                            FindWordDocumentEnd
                            <span class="re0">$Table</span> <span class="sy0">=</span> <span class="re0">$Null</span>
                            WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
                        <span class="br0">&#125;</span>
                        <span class="kw3">else</span> <span class="br0">&#123;</span>
                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">'There are no Deployment Types configured for this Application.'</span>
                        <span class="br0">&#125;</span>
                    <span class="br0">&#125;</span>
                <span class="br0">&#125;</span>
                <span class="kw3">else</span> <span class="br0">&#123;</span>
                    WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">'There are no Applications configured in this site.'</span>
                <span class="br0">&#125;</span>
            <span class="br0">&#125;</span>
        <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Applications</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">&quot;There are $($Applications.count) applications configured.&quot;</span>
        <span class="br0">&#125;</span>
        <span class="kw3">else</span> <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">'There are no Applications configured in this site.'</span>
        <span class="br0">&#125;</span>
<span class="co1">##### Packages</span>
&nbsp;
        WriteWordLine <span class="nu0">2</span> <span class="nu0">0</span> <span class="st0">'Packages'</span>
        WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
        <span class="re0">$Packages</span> <span class="sy0">=</span> Get<span class="sy0">-</span>CMPackage
        <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$ListAllInformation</span><span class="br0">&#41;</span>
            <span class="br0">&#123;</span>
                <span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$Packages</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
                    <span class="br0">&#123;</span>
                        WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">'The following Packages are configured in this site:'</span>
                        <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$Package</span> <span class="kw3">in</span> <span class="re0">$Packages</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
                            WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
                            WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;$($Package.Name)&quot;</span> <span class="sy0">-</span>boldface <span class="re0">$true</span>
                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Description: $($Package.Description)&quot;</span>
                            WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;PackageID: $($Package.PackageID)&quot;</span>
                            <span class="re0">$Programs</span> <span class="sy0">=</span> <span class="kw1">Get-WmiObject</span> <span class="kw5">-Class</span> SMS_Program <span class="kw5">-Namespace</span> root\sms\site_<span class="re0">$SiteCode</span> <span class="kw5">-ComputerName</span> <span class="re0">$SMSProvider</span> <span class="sy0">-</span><span class="kw3">Filter</span> <span class="st0">&quot;PackageID = '$($Package.PackageID)'&quot;</span>
                            <span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$Programs</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
                                <span class="br0">&#123;</span>
                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">'The Package has the following Programs configured:'</span>
                                    <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$Program</span> <span class="kw3">in</span> <span class="re0">$Programs</span><span class="br0">&#41;</span>
                                        <span class="br0">&#123;</span>
                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">&quot;Program Name: $($Program.ProgramName)&quot;</span> <span class="sy0">-</span>boldface <span class="re0">$true</span>
                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">&quot;Command Line: $($Program.CommandLine)&quot;</span>
                                            <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$Program</span>.ProgramFlags <span class="kw4">-band</span> 0x00000001<span class="br0">&#41;</span>
                                                <span class="br0">&#123;</span>
                                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">&quot;<span class="es0">`'</span>Allow this program to be installed from the Install Package task sequence without being deployed<span class="es0">`'</span> enabled.&quot;</span>
                                                <span class="br0">&#125;</span>
                                            <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$Program</span>.ProgramFlags <span class="kw4">-band</span> 0x00000002<span class="br0">&#41;</span>
                                                <span class="br0">&#123;</span>
                                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">&quot;<span class="es0">`'</span>The task sequence shows a custom progress user interface message.<span class="es0">`'</span> enabled.&quot;</span>
                                                <span class="br0">&#125;</span>
                                            <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$Program</span>.ProgramFlags <span class="kw4">-band</span> 0x00000010<span class="br0">&#41;</span>
                                                <span class="br0">&#123;</span>
                                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'This is a default program.'</span>
                                                <span class="br0">&#125;</span>
                                            <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$Program</span>.ProgramFlags <span class="kw4">-band</span> 0x00000020<span class="br0">&#41;</span>
                                                <span class="br0">&#123;</span>
                                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'Disables MOM alerts while the program runs.'</span>
                                                <span class="br0">&#125;</span>
                                            <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$Program</span>.ProgramFlags <span class="kw4">-band</span> 0x00000040<span class="br0">&#41;</span>
                                                <span class="br0">&#123;</span>
                                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'Generates MOM alert if the program fails.'</span>
                                                <span class="br0">&#125;</span>
                                            <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$Program</span>.ProgramFlags <span class="kw4">-band</span> 0x00000080<span class="br0">&#41;</span>
                                                <span class="br0">&#123;</span>
                                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">&quot;This program's immediate dependent should always be run.&quot;</span>
                                                <span class="br0">&#125;</span>
                                            <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$Program</span>.ProgramFlags <span class="kw4">-band</span> 0x00000100<span class="br0">&#41;</span>
                                                <span class="br0">&#123;</span>
                                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'A device program. The program is not offered to desktop clients.'</span>
                                                <span class="br0">&#125;</span>
                                            <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$Program</span>.ProgramFlags <span class="kw4">-band</span> 0x00000400<span class="br0">&#41;</span>
                                                <span class="br0">&#123;</span>
                                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'The countdown dialog is not displayed.'</span>
                                                <span class="br0">&#125;</span>
                                            <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$Program</span>.ProgramFlags <span class="kw4">-band</span> 0x00001000<span class="br0">&#41;</span>
                                                <span class="br0">&#123;</span>
                                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'The program is disabled.'</span>
                                                <span class="br0">&#125;</span>
                                            <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$Program</span>.ProgramFlags <span class="kw4">-band</span> 0x00002000<span class="br0">&#41;</span>
                                                <span class="br0">&#123;</span>
                                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'The program requires no user interaction.'</span>
                                                <span class="br0">&#125;</span>
                                            <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$Program</span>.ProgramFlags <span class="kw4">-band</span> 0x00004000<span class="br0">&#41;</span>
                                                <span class="br0">&#123;</span>
                                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'The program can run only when a user is logged on.'</span>
                                                <span class="br0">&#125;</span>
                                            <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$Program</span>.ProgramFlags <span class="kw4">-band</span> 0x00008000<span class="br0">&#41;</span>
                                                <span class="br0">&#123;</span>
                                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'The program must be run as the local Administrator account.'</span>
                                                <span class="br0">&#125;</span>
                                            <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$Program</span>.ProgramFlags <span class="kw4">-band</span> 0x00010000<span class="br0">&#41;</span>
                                                <span class="br0">&#123;</span>
                                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'The program must be run by every user for whom it is valid. Valid only for mandatory jobs.'</span>
                                                <span class="br0">&#125;</span>
                                            <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$Program</span>.ProgramFlags <span class="kw4">-band</span> 0x00020000<span class="br0">&#41;</span>
                                                <span class="br0">&#123;</span>
                                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'The program is run only when no user is logged on.'</span>
                                                <span class="br0">&#125;</span>
                                            <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$Program</span>.ProgramFlags <span class="kw4">-band</span> 0x00040000<span class="br0">&#41;</span>
                                                <span class="br0">&#123;</span>
                                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'The program will restart the computer.'</span>
                                                <span class="br0">&#125;</span>
                                            <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$Program</span>.ProgramFlags <span class="kw4">-band</span> 0x00080000<span class="br0">&#41;</span>
                                                <span class="br0">&#123;</span>
                                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'Configuration Manager restarts the computer when the program has finished running successfully.'</span>
                                                <span class="br0">&#125;</span>
                                            <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$Program</span>.ProgramFlags <span class="kw4">-band</span> 0x00100000<span class="br0">&#41;</span>
                                                <span class="br0">&#123;</span>
                                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'Use a UNC path (no drive letter) to access the distribution point.'</span>
                                                <span class="br0">&#125;</span>
                                            <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$Program</span>.ProgramFlags <span class="kw4">-band</span> 0x00200000<span class="br0">&#41;</span>
                                                <span class="br0">&#123;</span>
                                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'Persists the connection to the drive specified in the DriveLetter property. The USEUNCPATH bit flag must not be set.'</span>
                                                <span class="br0">&#125;</span>
                                            <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$Program</span>.ProgramFlags <span class="kw4">-band</span> 0x00400000<span class="br0">&#41;</span>
                                                <span class="br0">&#123;</span>
                                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'Run the program as a minimized window.'</span>
                                                <span class="br0">&#125;</span>
                                            <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$Program</span>.ProgramFlags <span class="kw4">-band</span> 0x00800000<span class="br0">&#41;</span>
                                                <span class="br0">&#123;</span>
                                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'Run the program as a maximized window.'</span>
                                                <span class="br0">&#125;</span>
                                            <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$Program</span>.ProgramFlags <span class="kw4">-band</span> 0x01000000<span class="br0">&#41;</span>
                                                <span class="br0">&#123;</span>
                                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'Hide the program window.'</span>
                                                <span class="br0">&#125;</span>
                                            <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$Program</span>.ProgramFlags <span class="kw4">-band</span> 0x02000000<span class="br0">&#41;</span>
                                                <span class="br0">&#123;</span>
                                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'Logoff user when program completes successfully.'</span>
                                                <span class="br0">&#125;</span>
                                            <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$Program</span>.ProgramFlags <span class="kw4">-band</span> 0x08000000<span class="br0">&#41;</span>
                                                <span class="br0">&#123;</span>
                                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'Override check for platform support.'</span>
                                                <span class="br0">&#125;</span>
                                            <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$Program</span>.ProgramFlags <span class="kw4">-band</span> 0x20000000<span class="br0">&#41;</span>
                                                <span class="br0">&#123;</span>
                                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'Run uninstall from the registry key when the advertisement expires.'</span>   
                                                <span class="br0">&#125;</span>   
                                        <span class="br0">&#125;</span>                             
                                <span class="br0">&#125;</span>
                            <span class="kw3">else</span>
                                <span class="br0">&#123;</span>
                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'The Package has no Programs configured.'</span>
                                <span class="br0">&#125;</span>                       
                        <span class="br0">&#125;</span>
                    <span class="br0">&#125;</span>
                <span class="kw3">else</span>
                    <span class="br0">&#123;</span>
                        WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">'There are no Packages configured in this site.'</span>
                    <span class="br0">&#125;</span>
            <span class="br0">&#125;</span>
        <span class="kw3">elseif</span> <span class="br0">&#40;</span><span class="re0">$Packages</span><span class="br0">&#41;</span>
            <span class="br0">&#123;</span>
                WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">&quot;There are $($Packages.count) packages configured.&quot;</span>
            <span class="br0">&#125;</span>
            <span class="kw3">else</span>
                <span class="br0">&#123;</span>
                    WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">'There are no packages configured.'</span>
                <span class="br0">&#125;</span>
<span class="co1">##### Driver Packages</span>
&nbsp;
    WriteWordLine <span class="nu0">2</span> <span class="nu0">0</span> <span class="st0">'Driver Packages'</span>
    WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
    <span class="re0">$DriverPackages</span> <span class="sy0">=</span> Get<span class="sy0">-</span>CMDriverPackage
    <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$ListAllInformation</span><span class="br0">&#41;</span>
        <span class="br0">&#123;</span>
            <span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$DriverPackages</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
                    <span class="br0">&#123;</span>
                        WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">'The following Driver Packages are configured in your site:'</span>
                        <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$DriverPackage</span> <span class="kw3">in</span> <span class="re0">$DriverPackages</span><span class="br0">&#41;</span>
                            <span class="br0">&#123;</span>
                                WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
                                WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Name: $($DriverPackage.Name)&quot;</span> <span class="sy0">-</span>boldface <span class="re0">$true</span>
                                <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$DriverPackage</span>.Description<span class="br0">&#41;</span>
                                    <span class="br0">&#123;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Description: $($DriverPackage.Description)&quot;</span>
                                    <span class="br0">&#125;</span>
                                WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;PackageID: $($DriverPackage.PackageID)&quot;</span>
                                WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Source path: $($DriverPackage.PkgSourcePath)&quot;</span>
                                WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'This package consists of the following Drivers:'</span>
                                <span class="re0">$Drivers</span> <span class="sy0">=</span> Get<span class="sy0">-</span>CMDriver <span class="sy0">-</span>DriverPackageId <span class="st0">&quot;$($DriverPackage.PackageID)&quot;</span>
                                <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$Driver</span> <span class="kw3">in</span> <span class="re0">$Drivers</span><span class="br0">&#41;</span>
                                    <span class="br0">&#123;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Driver Name: $($Driver.LocalizedDisplayName)&quot;</span> <span class="sy0">-</span>boldface <span class="re0">$true</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Manufacturer: $($Driver.DriverProvider)&quot;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Source path: $($Driver.ContentSourcePath)&quot;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;INF File: $($Driver.DriverINFFile)&quot;</span>
                                    <span class="br0">&#125;</span>
                                WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">''</span>
                            <span class="br0">&#125;</span>
                    <span class="br0">&#125;</span>
                <span class="kw3">else</span>
                    <span class="br0">&#123;</span>
                        WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">'There are no Driver Packages configured in this site.'</span>
                    <span class="br0">&#125;</span>
        <span class="br0">&#125;</span>
    <span class="kw3">else</span>
        <span class="br0">&#123;</span>
            <span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$DriverPackages</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
                <span class="br0">&#123;</span>
                    WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">&quot;There are $($DriverPackages.count) Driver Packages configured.&quot;</span>                    
                <span class="br0">&#125;</span>
            <span class="kw3">else</span>
                <span class="br0">&#123;</span>
                    WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">'There are no Driver Packages configured in this site.'</span>
                <span class="br0">&#125;</span>
        <span class="br0">&#125;</span>
<span class="co1">##### Operating System Installers</span>
&nbsp;
    WriteWordLine <span class="nu0">2</span> <span class="nu0">0</span> <span class="st0">'Operating System Installers'</span>
    WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
    <span class="re0">$OSInstallers</span> <span class="sy0">=</span> Get<span class="sy0">-</span>CMOperatingSystemInstaller
    <span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$OSImages</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
        <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">'The following OS Installers are imported into this environment:'</span>
            <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$OSInstaller</span> <span class="kw3">in</span> <span class="re0">$OSInstallers</span><span class="br0">&#41;</span>
                <span class="br0">&#123;</span>
                    WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Name: $($OSInstaller.Name)&quot;</span> <span class="sy0">-</span>boldface <span class="re0">$true</span>
                    <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$OSInstaller</span>.Description<span class="br0">&#41;</span>
                            <span class="br0">&#123;</span>
                                WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Description: $($OSInstaller.Description)&quot;</span>
                            <span class="br0">&#125;</span>
                    WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Package ID: $($OSInstaller.PackageID)&quot;</span>
                    WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Source Path: $($OSInstaller.PkgSourcePath)&quot;</span>
                <span class="br0">&#125;</span>
        <span class="br0">&#125;</span>
    <span class="kw3">else</span>
        <span class="br0">&#123;</span>
            WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">'There are no OS Installers imported into this environment.'</span>
        <span class="br0">&#125;</span>
&nbsp;
<span class="co1">####</span>
<span class="co1">####</span>
<span class="co1">#### Boot Images</span>
&nbsp;
WriteWordLine <span class="nu0">2</span> <span class="nu0">0</span> <span class="st0">'Boot Images'</span>
WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
<span class="re0">$BootImages</span> <span class="sy0">=</span> Get<span class="sy0">-</span>CMBootImage
<span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$BootImages</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">'The following Boot Images are imported into this environment:'</span>
        WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
        <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$BootImage</span> <span class="kw3">in</span> <span class="re0">$BootImages</span><span class="br0">&#41;</span>
            <span class="br0">&#123;</span>
                WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;$($BootImage.Name)&quot;</span> <span class="sy0">-</span>boldface <span class="re0">$true</span>
                <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$BootImage</span>.Description<span class="br0">&#41;</span>
                    <span class="br0">&#123;</span>
                        WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Description: $($BootImage.Description)&quot;</span>
                    <span class="br0">&#125;</span>
                WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Source Path: $($BootImage.PkgSourcePath)&quot;</span>
                WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Package ID: $($BootImage.PackageID)&quot;</span>
                WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Architecture: '</span> <span class="kw5">-nonewline</span>
                <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$BootImage</span>.Architecture<span class="br0">&#41;</span>
                    <span class="br0">&#123;</span>
                        <span class="nu0">0</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'x86'</span> <span class="br0">&#125;</span>
                        <span class="nu0">9</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'x64'</span> <span class="br0">&#125;</span>
                    <span class="br0">&#125;</span>
                <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$BootImage</span>.BackgroundBitmapPath<span class="br0">&#41;</span>
                    <span class="br0">&#123;</span>
                        WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Custom Background: $($BootImage.BackgroundBitmapPath)&quot;</span>
                    <span class="br0">&#125;</span>
                <span class="kw3">Switch</span> <span class="br0">&#40;</span><span class="re0">$BootImage</span>.EnableLabShell<span class="br0">&#41;</span>
                    <span class="br0">&#123;</span>
                        True <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Command line support is enabled'</span> <span class="br0">&#125;</span>
                        False <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'Command line support is not enabled'</span> <span class="br0">&#125;</span>
                    <span class="br0">&#125;</span>
                WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">'The following drivers are imported into this WinPE'</span>
                <span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$BootImage</span>.ReferencedDrivers<span class="br0">&#41;</span><span class="br0">&#41;</span>
                    <span class="br0">&#123;</span>
                        <span class="re0">$ImportedDriverIDs</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="re0">$BootImage</span>.ReferencedDrivers<span class="br0">&#41;</span>.ID <span class="sy0">|</span> <span class="kw1">Out-Null</span>
                        <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$ImportedDriverID</span> <span class="kw3">in</span> <span class="re0">$ImportedDriverIDs</span><span class="br0">&#41;</span>
                            <span class="br0">&#123;</span>
                                <span class="re0">$ImportedDriver</span> <span class="sy0">=</span> Get<span class="sy0">-</span>CMDriver <span class="kw5">-ID</span> <span class="re0">$ImportedDriverID</span>
                                WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Name: $($ImportedDriver.LocalizedDisplayName)&quot;</span> <span class="sy0">-</span>boldface <span class="re0">$true</span>
                                WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Inf File: $($ImportedDriver.DriverINFFile)&quot;</span>
                                WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;Driver Class: $($ImportedDriver.DriverClass)&quot;</span>
                                WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
                            <span class="br0">&#125;</span>
                    <span class="br0">&#125;</span>
                <span class="kw3">else</span>
                    <span class="br0">&#123;</span>
                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">'There are no drivers imported into the Boot Image.'</span>
                    <span class="br0">&#125;</span>
            <span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$BootImage</span>.OptionalComponents<span class="br0">&#41;</span><span class="br0">&#41;</span>
                <span class="br0">&#123;</span>
                    <span class="re0">$Component</span> <span class="sy0">=</span> <span class="re0">$Null</span>
                    WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">'The following Optional Components are added to this Boot Image:'</span>
                    <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$Component</span> <span class="kw3">in</span> <span class="re0">$BootImage</span>.OptionalComponents<span class="br0">&#41;</span>
                        <span class="br0">&#123;</span>
                            <span class="kw3">switch</span> <span class="br0">&#40;</span><span class="re0">$Component</span><span class="br0">&#41;</span>
                                <span class="br0">&#123;</span>
                                    <span class="br0">&#123;</span><span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'1'</span><span class="br0">&#41;</span> <span class="kw4">-or</span> <span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'27'</span><span class="br0">&#41;</span><span class="br0">&#125;</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'WinPE-DismCmdlets'</span> <span class="br0">&#125;</span>
                                    <span class="br0">&#123;</span><span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'2'</span><span class="br0">&#41;</span> <span class="kw4">-or</span> <span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'28'</span><span class="br0">&#41;</span><span class="br0">&#125;</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'WinPE-Dot3Svc'</span> <span class="br0">&#125;</span>
                                    <span class="br0">&#123;</span><span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'3'</span><span class="br0">&#41;</span> <span class="kw4">-or</span> <span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'29'</span><span class="br0">&#41;</span><span class="br0">&#125;</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'WinPE-EnhancedStorage'</span> <span class="br0">&#125;</span>
                                    <span class="br0">&#123;</span><span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'4'</span><span class="br0">&#41;</span> <span class="kw4">-or</span> <span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'30'</span><span class="br0">&#41;</span><span class="br0">&#125;</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'WinPE-FMAPI'</span> <span class="br0">&#125;</span>
                                    <span class="br0">&#123;</span><span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'5'</span><span class="br0">&#41;</span> <span class="kw4">-or</span> <span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'31'</span><span class="br0">&#41;</span><span class="br0">&#125;</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'WinPE-FontSupport-JA-JP'</span> <span class="br0">&#125;</span>
                                    <span class="br0">&#123;</span><span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'6'</span><span class="br0">&#41;</span> <span class="kw4">-or</span> <span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'32'</span><span class="br0">&#41;</span><span class="br0">&#125;</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'WinPE-FontSupport-KO-KR'</span> <span class="br0">&#125;</span>
                                    <span class="br0">&#123;</span><span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'7'</span><span class="br0">&#41;</span> <span class="kw4">-or</span> <span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'33'</span><span class="br0">&#41;</span><span class="br0">&#125;</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'WinPE-FontSupport-ZH-CN'</span> <span class="br0">&#125;</span>
                                    <span class="br0">&#123;</span><span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'8'</span><span class="br0">&#41;</span> <span class="kw4">-or</span> <span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'34'</span><span class="br0">&#41;</span><span class="br0">&#125;</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'WinPE-FontSupport-ZH-HK'</span> <span class="br0">&#125;</span>
                                    <span class="br0">&#123;</span><span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'9'</span><span class="br0">&#41;</span> <span class="kw4">-or</span> <span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'35'</span><span class="br0">&#41;</span><span class="br0">&#125;</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'WinPE-FontSupport-ZH-TW'</span> <span class="br0">&#125;</span>
                                    <span class="br0">&#123;</span><span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'10'</span><span class="br0">&#41;</span> <span class="kw4">-or</span> <span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'36'</span><span class="br0">&#41;</span><span class="br0">&#125;</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'WinPE-HTA'</span> <span class="br0">&#125;</span>
                                    <span class="br0">&#123;</span><span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'11'</span><span class="br0">&#41;</span> <span class="kw4">-or</span> <span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'37'</span><span class="br0">&#41;</span><span class="br0">&#125;</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'WinPE-StorageWMI'</span> <span class="br0">&#125;</span>
                                    <span class="br0">&#123;</span><span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'12'</span><span class="br0">&#41;</span> <span class="kw4">-or</span> <span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'38'</span><span class="br0">&#41;</span><span class="br0">&#125;</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'WinPE-LegacySetup'</span> <span class="br0">&#125;</span>
                                    <span class="br0">&#123;</span><span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'13'</span><span class="br0">&#41;</span> <span class="kw4">-or</span> <span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'39'</span><span class="br0">&#41;</span><span class="br0">&#125;</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'WinPE-MDAC'</span> <span class="br0">&#125;</span>
                                    <span class="br0">&#123;</span><span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'14'</span><span class="br0">&#41;</span> <span class="kw4">-or</span> <span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'40'</span><span class="br0">&#41;</span><span class="br0">&#125;</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'WinPE-NetFx4'</span> <span class="br0">&#125;</span>
                                    <span class="br0">&#123;</span><span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'15'</span><span class="br0">&#41;</span> <span class="kw4">-or</span> <span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'41'</span><span class="br0">&#41;</span><span class="br0">&#125;</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'WinPE-PowerShell3'</span> <span class="br0">&#125;</span>
                                    <span class="br0">&#123;</span><span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'16'</span><span class="br0">&#41;</span> <span class="kw4">-or</span> <span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'42'</span><span class="br0">&#41;</span><span class="br0">&#125;</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'WinPE-PPPoE'</span> <span class="br0">&#125;</span>
                                    <span class="br0">&#123;</span><span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'17'</span><span class="br0">&#41;</span> <span class="kw4">-or</span> <span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'43'</span><span class="br0">&#41;</span><span class="br0">&#125;</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'WinPE-RNDIS'</span> <span class="br0">&#125;</span>
                                    <span class="br0">&#123;</span><span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'18'</span><span class="br0">&#41;</span> <span class="kw4">-or</span> <span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'44'</span><span class="br0">&#41;</span><span class="br0">&#125;</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'WinPE-Scripting'</span> <span class="br0">&#125;</span>
                                    <span class="br0">&#123;</span><span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'19'</span><span class="br0">&#41;</span> <span class="kw4">-or</span> <span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'45'</span><span class="br0">&#41;</span><span class="br0">&#125;</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'WinPE-SecureStartup'</span> <span class="br0">&#125;</span>
                                    <span class="br0">&#123;</span><span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'20'</span><span class="br0">&#41;</span> <span class="kw4">-or</span> <span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'46'</span><span class="br0">&#41;</span><span class="br0">&#125;</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'WinPE-Setup'</span> <span class="br0">&#125;</span>
                                    <span class="br0">&#123;</span><span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'21'</span><span class="br0">&#41;</span> <span class="kw4">-or</span> <span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'47'</span><span class="br0">&#41;</span><span class="br0">&#125;</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'WinPE-Setup-Client'</span> <span class="br0">&#125;</span>
                                    <span class="br0">&#123;</span><span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'22'</span><span class="br0">&#41;</span> <span class="kw4">-or</span> <span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'48'</span><span class="br0">&#41;</span><span class="br0">&#125;</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'WinPE-Setup-Server'</span> <span class="br0">&#125;</span>
                                    <span class="co1">#{($_ -eq &quot;23&quot;) -or ($_ -eq &quot;49&quot;)} { WriteWordLine 0 4 &quot;Not applicable&quot; }</span>
                                    <span class="br0">&#123;</span><span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'24'</span><span class="br0">&#41;</span> <span class="kw4">-or</span> <span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'50'</span><span class="br0">&#41;</span><span class="br0">&#125;</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'WinPE-WDS-Tools'</span> <span class="br0">&#125;</span>
                                    <span class="br0">&#123;</span><span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'25'</span><span class="br0">&#41;</span> <span class="kw4">-or</span> <span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'51'</span><span class="br0">&#41;</span><span class="br0">&#125;</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'WinPE-WinReCfg'</span> <span class="br0">&#125;</span>
                                    <span class="br0">&#123;</span><span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'26'</span><span class="br0">&#41;</span> <span class="kw4">-or</span> <span class="br0">&#40;</span><a href="about:blank"><span class="kw6">$_</span></a> <span class="kw4">-eq</span> <span class="st0">'52'</span><span class="br0">&#41;</span><span class="br0">&#125;</span> <span class="br0">&#123;</span> WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'WinPE-WMI'</span> <span class="br0">&#125;</span>
                                <span class="br0">&#125;</span> 
                            <span class="re0">$Component</span> <span class="sy0">=</span> <span class="re0">$Null</span>    
                        <span class="br0">&#125;</span>
                    <span class="br0">&#125;</span>
                WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
&nbsp;
            <span class="br0">&#125;</span>
    <span class="br0">&#125;</span>
<span class="kw3">else</span>
    <span class="br0">&#123;</span>
        WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">'There are no Boot Images present in this environment.'</span>
    <span class="br0">&#125;</span>
&nbsp;
<span class="co1">####</span>
<span class="co1">####</span>
<span class="co1">#### Task Sequences</span>
<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date):   Enumerating Task Sequences&quot;</span>
WriteWordLine <span class="nu0">2</span> <span class="nu0">0</span> <span class="st0">'Task Sequences'</span>
WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
&nbsp;
<span class="re0">$TaskSequences</span> <span class="sy0">=</span> Get<span class="sy0">-</span>CMTaskSequence
<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date):   working on $($TaskSequences.count) Task Sequences&quot;</span>
<span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$ListAllInformation</span><span class="br0">&#41;</span>
    <span class="br0">&#123;</span>
        <span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$TaskSequences</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
            <span class="br0">&#123;</span>
                <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$TaskSequence</span> <span class="kw3">in</span> <span class="re0">$TaskSequences</span><span class="br0">&#41;</span>
                    <span class="br0">&#123;</span>
                        WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">&quot;Task Sequence name: $($TaskSequence.Name)&quot;</span> <span class="sy0">-</span>boldface <span class="re0">$true</span>
                        WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">&quot;Package ID: $($TaskSequence.PackageID)&quot;</span>
                        <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$TaskSequence</span>.BootImageID<span class="br0">&#41;</span>
                            <span class="br0">&#123;</span>
                                WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;Boot Image referenced in this Task Sequence: $((Get-CMBootImage -Id $TaskSequence.BootImageID -ErrorAction SilentlyContinue ).Name)&quot;</span>
                            <span class="br0">&#125;</span>
&nbsp;
                        <span class="re0">$Sequence</span> <span class="sy0">=</span> <span class="re0">$Null</span>
                        <span class="br0">&#91;</span><span class="re3">xml</span><span class="br0">&#93;</span><span class="re0">$Sequence</span> <span class="sy0">=</span> <span class="re0">$TaskSequence</span>.Sequence
                        try
                            <span class="br0">&#123;</span>
                                <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$Group</span> <span class="kw3">in</span> <span class="re0">$Sequence</span>.sequence.<span class="kw2">group</span><span class="br0">&#41;</span>
                                    <span class="br0">&#123;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">&quot;Group name: $($Group.Name)&quot;</span> <span class="sy0">-</span>boldface <span class="re0">$true</span>
                                        <span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$Group</span>.Description<span class="br0">&#41;</span><span class="br0">&#41;</span>
                                            <span class="br0">&#123;</span>
                                                WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">&quot;Description: $($Group.Description)&quot;</span>
                                            <span class="br0">&#125;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">'This Group has the following steps configured.'</span>
                                        <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$Step</span> <span class="kw3">in</span> <span class="re0">$Group</span>.Step<span class="br0">&#41;</span>
                                            <span class="br0">&#123;</span>
                                                WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;$($Step.Name)&quot;</span> <span class="sy0">-</span>boldface <span class="re0">$true</span>
                                                <span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$Step</span>.Description<span class="br0">&#41;</span><span class="br0">&#41;</span>
                                                    <span class="br0">&#123;</span>
                                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">&quot;$($Step.Description)&quot;</span>
                                                    <span class="br0">&#125;</span>
                                                WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">&quot;$($Step.Action)&quot;</span>
                                                try 
                                                    <span class="br0">&#123;</span>
                                                        <span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$Step</span>.disable<span class="br0">&#41;</span><span class="br0">&#41;</span>
                                                                <span class="br0">&#123;</span>
                                                                    WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'This step is disabled.'</span>
                                                                <span class="br0">&#125;</span>
                                                    <span class="br0">&#125;</span>   
                                                catch <span class="br0">&#91;</span>System.Management.Automation.PropertyNotFoundException<span class="br0">&#93;</span> 
                                                    <span class="br0">&#123;</span>
                                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'This step is enabled'</span>
                                                    <span class="br0">&#125;</span>
                                                WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
                                            <span class="br0">&#125;</span>
&nbsp;
                                    <span class="br0">&#125;</span>
                            <span class="br0">&#125;</span>
                        catch <span class="br0">&#91;</span>System.Management.Automation.PropertyNotFoundException<span class="br0">&#93;</span>
                            <span class="br0">&#123;</span>
                                WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
                            <span class="br0">&#125;</span>
                        try 
                            <span class="br0">&#123;</span>
                                <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$Step</span> <span class="kw3">in</span> <span class="re0">$Sequence</span>.sequence.step<span class="br0">&#41;</span>
                                    <span class="br0">&#123;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">3</span> <span class="st0">&quot;$($Step.Name)&quot;</span> <span class="sy0">-</span>boldface <span class="re0">$true</span>
                                        <span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$Step</span>.Description<span class="br0">&#41;</span><span class="br0">&#41;</span>
                                            <span class="br0">&#123;</span>
                                                WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">&quot;$($Step.Description)&quot;</span>
                                            <span class="br0">&#125;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">&quot;$($Step.Action)&quot;</span>
                                        try 
                                            <span class="br0">&#123;</span>
                                                <span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$Step</span>.disable<span class="br0">&#41;</span><span class="br0">&#41;</span>
                                                        <span class="br0">&#123;</span>
                                                            WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'This step is disabled.'</span>
                                                        <span class="br0">&#125;</span>
                                            <span class="br0">&#125;</span>   
                                        catch <span class="br0">&#91;</span>System.Management.Automation.PropertyNotFoundException<span class="br0">&#93;</span> 
                                            <span class="br0">&#123;</span>
                                                WriteWordLine <span class="nu0">0</span> <span class="nu0">4</span> <span class="st0">'This step is enabled'</span>
                                            <span class="br0">&#125;</span>
                                        WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
                                    <span class="br0">&#125;</span>
                            <span class="br0">&#125;</span>
                        catch <span class="br0">&#91;</span>System.Management.Automation.PropertyNotFoundException<span class="br0">&#93;</span>
                            <span class="br0">&#123;</span>
                                WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
                            <span class="br0">&#125;</span>
                        <span class="co1">#&gt;</span>
                        WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">''</span>
                        WriteWordLine <span class="nu0">0</span> <span class="nu0">0</span> <span class="st0">'----------------------------------------------'</span>
                    <span class="br0">&#125;</span>
            <span class="br0">&#125;</span>
        <span class="kw3">else</span>
            <span class="br0">&#123;</span>
                WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">'There are no Task Sequences present in this environment.'</span>
            <span class="br0">&#125;</span>
    <span class="br0">&#125;</span>
<span class="kw3">else</span>
    <span class="br0">&#123;</span>
        <span class="kw3">if</span> <span class="br0">&#40;</span><span class="kw4">-not</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::IsNullOrEmpty<span class="br0">&#40;</span><span class="re0">$TaskSequences</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
            <span class="br0">&#123;</span>
                WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">'The following Task Sequences are configured:'</span>
                <span class="kw3">foreach</span> <span class="br0">&#40;</span><span class="re0">$TaskSequence</span> <span class="kw3">in</span> <span class="re0">$TaskSequences</span><span class="br0">&#41;</span>
                    <span class="br0">&#123;</span>
                        WriteWordLine <span class="nu0">0</span> <span class="nu0">2</span> <span class="st0">&quot;$($TaskSequence.Name)&quot;</span>
                    <span class="br0">&#125;</span>
            <span class="br0">&#125;</span>
        <span class="kw3">else</span>
            <span class="br0">&#123;</span>
                WriteWordLine <span class="nu0">0</span> <span class="nu0">1</span> <span class="st0">'There are no Task Sequences present in this environment.'</span>
            <span class="br0">&#125;</span>
    <span class="br0">&#125;</span>
&nbsp;
<span class="br0">&#125;</span> <span class="co1">#End Software</span>
&nbsp;
<span class="co1">#endregion Site Configuration report</span>
&nbsp;
<span class="kw1">Set-Location</span> <span class="kw5">-Path</span> <span class="re0">$LocationBeforeExecution</span>
<span class="re0">$Script</span>:ScriptInformation <span class="sy0">=</span> <span class="re0">$Null</span>
&nbsp;
<span class="co1">###REPLACE BEFORE THIS SECTION WITH YOUR SCRIPT###</span>
<span class="co1">#endregion</span>
&nbsp;
<span class="co1">###REPLACE BEFORE THIS SECTION WITH YOUR SCRIPT###</span>
<span class="co1">#endregion</span>
&nbsp;
<span class="co1">#region finish script</span>
<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Finishing up document&quot;</span>
<span class="co1">#end of document processing</span>
&nbsp;
<span class="co1">###Change the two lines below for your script###</span>
<span class="re0">$AbstractTitle</span> <span class="sy0">=</span> <span class="st0">&quot;Template Script Report&quot;</span>
<span class="re0">$SubjectTitle</span> <span class="sy0">=</span> <span class="st0">&quot;Sample Template Script Report&quot;</span>
&nbsp;
UpdateDocumentProperties <span class="re0">$AbstractTitle</span> <span class="re0">$SubjectTitle</span>
&nbsp;
ProcessDocumentOutput
&nbsp;
<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Script has completed&quot;</span>
<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): &quot;</span>
&nbsp;
<span class="co1">#http://poshtips.com/measuring-elapsed-time-in-powershell/</span>
<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Script started: $($Script:StartTime)&quot;</span>
<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Script ended: $(Get-Date)&quot;</span>
<span class="re0">$runtime</span> <span class="sy0">=</span> $<span class="br0">&#40;</span><span class="kw1">Get-Date</span><span class="br0">&#41;</span> <span class="sy0">-</span> <span class="re0">$Script</span>:StartTime
<span class="re0">$Str</span> <span class="sy0">=</span> <span class="br0">&#91;</span><span class="re3">string</span><span class="br0">&#93;</span>::format<span class="br0">&#40;</span><span class="st0">&quot;{0} days, {1} hours, {2} minutes, {3}.{4} seconds&quot;</span><span class="sy0">,</span> `
	<span class="re0">$runtime</span>.Days<span class="sy0">,</span> `
	<span class="re0">$runtime</span>.Hours<span class="sy0">,</span> `
	<span class="re0">$runtime</span>.Minutes<span class="sy0">,</span> `
	<span class="re0">$runtime</span>.Seconds<span class="sy0">,</span>
	<span class="re0">$runtime</span>.Milliseconds<span class="br0">&#41;</span>
<span class="kw1">Write-Verbose</span> <span class="st0">&quot;$(Get-Date): Elapsed time: $($Str)&quot;</span>
<span class="re0">$runtime</span> <span class="sy0">=</span> <span class="re0">$Null</span>
<span class="re0">$Str</span> <span class="sy0">=</span> <span class="re0">$Null</span>
<a href="about:blank"><span class="kw6">$ErrorActionPreference</span></a> <span class="sy0">=</span> <span class="re0">$SaveEAPreference</span>
<span class="co1">#endregion</span>