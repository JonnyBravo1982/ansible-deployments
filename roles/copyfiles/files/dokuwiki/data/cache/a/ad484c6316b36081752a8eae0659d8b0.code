<span class="re0">$SATAControllerMode</span> <span class="sy0">=</span> <span class="br0">&#40;</span><span class="kw2">gwmi</span> <span class="kw5">-class</span> Lenovo_BiosSetting <span class="kw5">-namespace</span> root\wmi <span class="sy0">|</span> <span class="kw1">Where-Object</span>  <span class="br0">&#123;</span><a href="about:blank"><span class="kw6">$_</span></a>.CurrentSetting.split<span class="br0">&#40;</span><span class="st0">&quot;,&quot;</span><span class="sy0">,</span><span class="br0">&#91;</span>StringSplitOptions<span class="br0">&#93;</span>::RemoveEmptyEntries<span class="br0">&#41;</span> <span class="kw4">-eq</span>   <span class="st0">&quot;SATAControllerMode&quot;</span><span class="br0">&#125;</span><span class="br0">&#41;</span>.CurrentSetting <span class="co1">#| Format-List CurrentSetting</span>
  <span class="kw3">if</span> <span class="br0">&#40;</span><span class="re0">$SATAControllerMode</span> <span class="kw4">-like</span> <span class="st0">&quot;SATAControllerMode,AHCI&quot;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
   <span class="br0">&#40;</span><span class="kw2">gwmi</span> <span class="kw5">-class</span> Lenovo_SetBiosSetting <span class="kw5">-namespace</span> root\wmi<span class="br0">&#41;</span>.SetBiosSetting<span class="br0">&#40;</span><span class="st0">&quot;SATAControllerMode,Compatibility,VSmdXPC,ascii,us;&quot;</span><span class="br0">&#41;</span>
   <span class="br0">&#40;</span><span class="kw2">gwmi</span> <span class="kw5">-class</span> Lenovo_SaveBiosSettings <span class="kw5">-namespace</span> root\wmi<span class="br0">&#41;</span>.SaveBiosSettings<span class="br0">&#40;</span><span class="st0">&quot;VSmdXPC,ascii,us&quot;</span><span class="br0">&#41;</span>
   <span class="br0">&#40;</span><span class="kw2">gwmi</span> <span class="kw5">-class</span> Lenovo_SaveBiosSettings <span class="kw5">-namespace</span> root\wmi<span class="br0">&#41;</span>.SaveBiosSettings
  <span class="br0">&#125;</span>